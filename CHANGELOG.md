### Changelog

All notable changes to this project will be documented in this file. Dates are displayed in UTC.

Generated by [`auto-changelog`](https://github.com/CookPete/auto-changelog).

#### [v2.7.0](https://github.com/DEFRA/water-abstraction-service/compare/v2.2.0...v2.7.0)

> 17 August 2021

- Water 3177 - Copying Digitise data to core database [`#1495`](https://github.com/DEFRA/water-abstraction-service/pull/1495)
- bugfix-water-3295 - creating credits for licences that has been removed from the batch [`#1497`](https://github.com/DEFRA/water-abstraction-service/pull/1497)
- Adds migration that makes NALD invoices unrebillable [`#1498`](https://github.com/DEFRA/water-abstraction-service/pull/1498)
- WATER-3300 [`#1496`](https://github.com/DEFRA/water-abstraction-service/pull/1496)
- WATER-3245 - alter re-billing logic [`#1494`](https://github.com/DEFRA/water-abstraction-service/pull/1494)
- Ensures credits are stored as negatives in the database. [`#1492`](https://github.com/DEFRA/water-abstraction-service/pull/1492)
- Adds a test gauging station + teardown routines [`#1491`](https://github.com/DEFRA/water-abstraction-service/pull/1491)
- Bugfix - water - 3276 - incorrect historic transactions [`#1490`](https://github.com/DEFRA/water-abstraction-service/pull/1490)
- Regression test data/water 3225 [`#1472`](https://github.com/DEFRA/water-abstraction-service/pull/1472)
- Bug/water 3285 [`#1487`](https://github.com/DEFRA/water-abstraction-service/pull/1487)
- Flips CM credit notes to being negative, to bring CM inline with NALD [`#1486`](https://github.com/DEFRA/water-abstraction-service/pull/1486)
- Change supp years variable from 6 to 5 [`#1481`](https://github.com/DEFRA/water-abstraction-service/pull/1481)
- Adds migration script to prevent &lt;0 values [`#1483`](https://github.com/DEFRA/water-abstraction-service/pull/1483)
- BUGFIX - WATER 3278 - 2PT duplicate charges [`#1470`](https://github.com/DEFRA/water-abstraction-service/pull/1470)
- Allow meter readings for returns to start with 0 [`#1475`](https://github.com/DEFRA/water-abstraction-service/pull/1475)
- Fix charging bugs jul 21 [`#1468`](https://github.com/DEFRA/water-abstraction-service/pull/1468)
- Update config.js [`#1469`](https://github.com/DEFRA/water-abstraction-service/pull/1469)
- WATER-3232 - Fixtures loader extended and due and completed returns data added [`#1467`](https://github.com/DEFRA/water-abstraction-service/pull/1467)
- updated indentation [`#1466`](https://github.com/DEFRA/water-abstraction-service/pull/1466)
-  Test data for water-3232 [`#1465`](https://github.com/DEFRA/water-abstraction-service/pull/1465)
- Additional field added for WATER-3117 [`#1464`](https://github.com/DEFRA/water-abstraction-service/pull/1464)
- Test data for water-3218 [`#1463`](https://github.com/DEFRA/water-abstraction-service/pull/1463)
- Bump ws from 7.4.5 to 7.5.1 [`#1462`](https://github.com/DEFRA/water-abstraction-service/pull/1462)
- Feat/water 3206 rebilling cm integration 2 [`#1446`](https://github.com/DEFRA/water-abstraction-service/pull/1446)
- Bugfix/water 3113 [`#1460`](https://github.com/DEFRA/water-abstraction-service/pull/1460)
- Minor tweak following QA identifying that previous implementation was… [`#1461`](https://github.com/DEFRA/water-abstraction-service/pull/1461)
- Adds endpoints for fetching licence version purpose conditions data [`#1447`](https://github.com/DEFRA/water-abstraction-service/pull/1447)
- Remove scheduler [`#1459`](https://github.com/DEFRA/water-abstraction-service/pull/1459)
- Updates Charging Go live default date + query for creating new charge… [`#1456`](https://github.com/DEFRA/water-abstraction-service/pull/1456)
- Feat/water 3172 backend licence linkage [`#1449`](https://github.com/DEFRA/water-abstraction-service/pull/1449)
- Adds the gauging-stations findAll route and method [`#1455`](https://github.com/DEFRA/water-abstraction-service/pull/1455)
- Adds an endpoint for removing licenceGaugingStation records [`#1457`](https://github.com/DEFRA/water-abstraction-service/pull/1457)
- Update gauging-station-service.js [`#1449`](https://github.com/DEFRA/water-abstraction-service/pull/1449)
- WIP [`9d1a249`](https://github.com/DEFRA/water-abstraction-service/commit/9d1a2499dc74820fb42ae0e6e4eda81e23a26ea5)
- WIP [`8f52015`](https://github.com/DEFRA/water-abstraction-service/commit/8f52015bd3300866377dfd4689d2826193157e86)
- WIP [`bdf9b5a`](https://github.com/DEFRA/water-abstraction-service/commit/bdf9b5adf1db792165568ebd91f001094d828553)
- feat/water-3177 [`5cbb8d5`](https://github.com/DEFRA/water-abstraction-service/commit/5cbb8d5a7a8d3e08bd847ad9d21ecd0963e90a38)
- feat/water-3245 [`2b08671`](https://github.com/DEFRA/water-abstraction-service/commit/2b08671abdb292f667ea98f2097f4a77ff02c0ee)
- WIP [`c1c2ae9`](https://github.com/DEFRA/water-abstraction-service/commit/c1c2ae9e403ecb099a6336dfbb8ffd47a8601163)
- WIP [`92009b7`](https://github.com/DEFRA/water-abstraction-service/commit/92009b73742bcd3df5072ddbcd7a0a68b0ea7254)
- WIP [`ff77765`](https://github.com/DEFRA/water-abstraction-service/commit/ff77765a161706abc13564d4bf43cc4f329f80ef)
- feat/water-3245-new-rebilling-logic [`2e102d7`](https://github.com/DEFRA/water-abstraction-service/commit/2e102d791d464bcd1b14a2cb959e1ea410067272)
- bugfix/water-3276 [`8a9f9d4`](https://github.com/DEFRA/water-abstraction-service/commit/8a9f9d43b516193b5889fb0d8d5ef3f253bec959)
- Added a test [`62b7b81`](https://github.com/DEFRA/water-abstraction-service/commit/62b7b8159cf0942c3bd9a62d8740c47c34ee2bce)
- General cleanse. [`280167a`](https://github.com/DEFRA/water-abstraction-service/commit/280167a3f817b3b6b1e44cb940b030ff058f2824)
- Fix for supplementary billing issue [`747e148`](https://github.com/DEFRA/water-abstraction-service/commit/747e148e6e827b1b49d40afb41515518c351a5ba)
- bugfix/water-3278 [`4f507cd`](https://github.com/DEFRA/water-abstraction-service/commit/4f507cd2b7a738452d9c1c2323ba01cc31c82aee)
- Tiny tweaks [`9ca2017`](https://github.com/DEFRA/water-abstraction-service/commit/9ca201728c33acaa44f87172379c3f821cbaceda)
- Adds Redis to ci [`869aa56`](https://github.com/DEFRA/water-abstraction-service/commit/869aa56257f750f3930a7543c163aa77f462ecab)
- teardown process updated [`938ea61`](https://github.com/DEFRA/water-abstraction-service/commit/938ea610a9bb8892e656799e67fe2ddaa1141532)
- Update licence-agreements.js [`d9e6b54`](https://github.com/DEFRA/water-abstraction-service/commit/d9e6b544b5f64a75b16ee92d233cdf8245626b3a)
- Update incorrect query for deleting agreements. [`0c57a15`](https://github.com/DEFRA/water-abstraction-service/commit/0c57a155ec84592c2b75d6609c81c3349609baf6)
- Tweaks [`2465b81`](https://github.com/DEFRA/water-abstraction-service/commit/2465b813cea2a0dce31a6e0ce78e37d8848d327e)
- bugfix/water-3278 [`41750b1`](https://github.com/DEFRA/water-abstraction-service/commit/41750b1aa9a451b60be098bd4cc4bdd2df6ac443)
- Update broken test [`051b7a5`](https://github.com/DEFRA/water-abstraction-service/commit/051b7a5367990bdd9613ac5ccea5504da9e5e498)
- Update ci.yml [`97f771f`](https://github.com/DEFRA/water-abstraction-service/commit/97f771f7cd1b6b3d81c160c642ecbc099a41896f)
- Update ci.yml [`cfa011e`](https://github.com/DEFRA/water-abstraction-service/commit/cfa011e42762452199230392feb04926b44b4106)
- Time limit mapping was missing [`fc07dae`](https://github.com/DEFRA/water-abstraction-service/commit/fc07dae924abe3021d18d1493aaf7f525b656216)
- Update batch-service.js [`179a558`](https://github.com/DEFRA/water-abstraction-service/commit/179a55807c5cc6a8afb1ba8afbe4da5d1fa5a8d7)
- Update licence-agreements.js [`1dab9b3`](https://github.com/DEFRA/water-abstraction-service/commit/1dab9b37009d46d6e87dd0b84a0c35b2a5bc8347)
- Update batches.js [`4031653`](https://github.com/DEFRA/water-abstraction-service/commit/4031653c669ffe854f0cedf52dbce1b4a0f5d12c)
- Code smells [`999f194`](https://github.com/DEFRA/water-abstraction-service/commit/999f19490b336674850c575bb577ff377d517260)
- Update ci.yml [`e10ebde`](https://github.com/DEFRA/water-abstraction-service/commit/e10ebdebd2e098904eb9b221143a7bdd4713f6d3)
- Update invoice.js [`098c349`](https://github.com/DEFRA/water-abstraction-service/commit/098c3495ff3946b17fd2f422493ee2031405d6af)
- New licence agreements teardown query [`6b8395b`](https://github.com/DEFRA/water-abstraction-service/commit/6b8395b8d5b8b517d16a5bd330b0dd0f203fbec5)
- bugfix/water-3295 [`5db33a2`](https://github.com/DEFRA/water-abstraction-service/commit/5db33a27fe9189f857ed796a88cba32a7ec770fb)
- Update sync-licence-version-purpose-conditions-from-digitise.js [`8f4b509`](https://github.com/DEFRA/water-abstraction-service/commit/8f4b509e04b6a70a690e35dde943b6ed4a0800a1)
- Update batch.js [`ffc3b5c`](https://github.com/DEFRA/water-abstraction-service/commit/ffc3b5c3c2610ff2b9c7deeef3fb0dd1ce25eb25)
- bugfix/water-3276 [`4cef91b`](https://github.com/DEFRA/water-abstraction-service/commit/4cef91b84d2fd35adba07669ab86b9d21cbed7aa)
- bugfix/water-3276 [`a84ac53`](https://github.com/DEFRA/water-abstraction-service/commit/a84ac53178c14cd237cdd576c54d1419574616ef)
- bugfix/joi-fix-returns-schema [`bfa64b4`](https://github.com/DEFRA/water-abstraction-service/commit/bfa64b4229daf88394780479da43948c4d2f877d)
- Update tear-down.js [`762e467`](https://github.com/DEFRA/water-abstraction-service/commit/762e467b7f4e54c723b74e81f7f9894a85f06640)
- Update ci.yml [`1d4ca18`](https://github.com/DEFRA/water-abstraction-service/commit/1d4ca1829d7b7ac15bcd873a07a1054e1b2c010a)
- Remove --bail [`9055515`](https://github.com/DEFRA/water-abstraction-service/commit/90555154a220f255b18fdf6869e84a60e70a59a9)
- bugfix/water-3278 [`099ec50`](https://github.com/DEFRA/water-abstraction-service/commit/099ec50d2743e41bf25380ddc1233639dff4f7f5)
- feat/water-3245 [`3413102`](https://github.com/DEFRA/water-abstraction-service/commit/3413102ab6c9cc61ca39f345600867ea8f02f95f)
- Update batches.js [`7322b08`](https://github.com/DEFRA/water-abstraction-service/commit/7322b08c9b30abd9af5858263822629e7d6efeac)
- Trigger code climate [`f922f17`](https://github.com/DEFRA/water-abstraction-service/commit/f922f17de248157b0bc2a9fb6c6d1d32d43f2aed)
- Saving WIP [`3917835`](https://github.com/DEFRA/water-abstraction-service/commit/3917835e19ff013c4973074a7248497ff5168ada)
- Lmao I feel sorry for whomever's going to have to review this pull request [`6c40316`](https://github.com/DEFRA/water-abstraction-service/commit/6c4031620b334d9adbc4516c084cc76394a63287)
- Fixing broken tests & removes unused variables [`7bcf64f`](https://github.com/DEFRA/water-abstraction-service/commit/7bcf64f886236e0af43c758eadb97316ae873cf2)
- Bugfixes, fix tests [`1e63bf9`](https://github.com/DEFRA/water-abstraction-service/commit/1e63bf9857c400780b2d4c8d31adcf7d56544082)
- WIP [`c72ecf2`](https://github.com/DEFRA/water-abstraction-service/commit/c72ecf2b17fb69aa844f78c539c85abc0e74f6f9)
- feat/water-3232 [`d42e09d`](https://github.com/DEFRA/water-abstraction-service/commit/d42e09dedef4559b1774401e516fe52a0647f618)
- Provisions necessary files and config object items [`edf94fa`](https://github.com/DEFRA/water-abstraction-service/commit/edf94fa62a49cdf2e3f84ca2a44d9d0558b72347)
- feat/water-3232 [`60d73d6`](https://github.com/DEFRA/water-abstraction-service/commit/60d73d6982ef4c661d530ea0ef9b618609410766)
- Updates query so that it fetches abstraction periods from linked conditions [`4c26fc9`](https://github.com/DEFRA/water-abstraction-service/commit/4c26fc93f3d34db3e9a9c6cf5f9c3174bdd33944)
- WIP [`5dee944`](https://github.com/DEFRA/water-abstraction-service/commit/5dee94405a368b43aae69b3474ece86d85e4524d)
- Additional tests [`f587979`](https://github.com/DEFRA/water-abstraction-service/commit/f5879794696f57cb11ad5753dbf356c71c9a9798)
- Additional tests [`36d4023`](https://github.com/DEFRA/water-abstraction-service/commit/36d4023cb99eb4190bbef0f53de939477b0c1bee)
- Adds tests for the two new methods [`6b11013`](https://github.com/DEFRA/water-abstraction-service/commit/6b110138546b2709243f6a735ac713263561e795)
- Tweaks following peer review. [`b764108`](https://github.com/DEFRA/water-abstraction-service/commit/b7641087193e54a1c734ebbd9b8e1c07f46b8d23)
- Additional tests [`fd57b1f`](https://github.com/DEFRA/water-abstraction-service/commit/fd57b1fbf5d04e022a44ff53ce31127d69843299)
- Updates Charging Go live default date + query for creating new charge version workflows [`0fe34eb`](https://github.com/DEFRA/water-abstraction-service/commit/0fe34ebd541a7999b36e7050eb78b628b5e9ccf9)
- Backend api for linkage view gaugingstations by licenceid [`1774bc9`](https://github.com/DEFRA/water-abstraction-service/commit/1774bc9796e5a4e8d79ee6f8d7332b0589e82ede)
- Data fixture changes to support WATER-3218 [`95088ae`](https://github.com/DEFRA/water-abstraction-service/commit/95088aeda954d36aedb815e67c65defc583e44a1)
- Additional tests [`cbfd93f`](https://github.com/DEFRA/water-abstraction-service/commit/cbfd93f44c7628356888c0bbf96ef23872106316)
- WIP [`dcfdff9`](https://github.com/DEFRA/water-abstraction-service/commit/dcfdff98d15ecd2e59cab64ca35d9a290f13cd07)
- Bug fixes, omit re-bills from supplementary [`5229fcb`](https://github.com/DEFRA/water-abstraction-service/commit/5229fcbde8f5b6124a49300cd991b3d99e038c5d)
- FIx code smells [`db0be2c`](https://github.com/DEFRA/water-abstraction-service/commit/db0be2c823902eef268f7944ab594a42b45aa5b7)
- Review tweaks and comments [`4a31c53`](https://github.com/DEFRA/water-abstraction-service/commit/4a31c53f6cf27408b598fd782a6b319741da06e5)
- Saving WIP [`8517888`](https://github.com/DEFRA/water-abstraction-service/commit/8517888503eee3bb6167004b9c59bcfda89815bf)
- Minor tweak to test fixtures [`795936d`](https://github.com/DEFRA/water-abstraction-service/commit/795936db31de8d7ba293cd24c976234144aaadc9)
- Fix code smell [`c0f5080`](https://github.com/DEFRA/water-abstraction-service/commit/c0f5080dc0d0c77732ae0e1e113985300007add7)
- Fix broken tests [`3dda522`](https://github.com/DEFRA/water-abstraction-service/commit/3dda5225582f8c14d0984c5ce33d360a9ed75f1b)
- Tweaks required to make WATER-3247 work with the production release timeframe [`9ce3712`](https://github.com/DEFRA/water-abstraction-service/commit/9ce371207e2ca79d036c1567c7df17c4c27f3e17)
- Putting the FUN back in "function" [`2c0aeba`](https://github.com/DEFRA/water-abstraction-service/commit/2c0aebac52e65fc348f33c4280a2810f49cfcf36)
- fix indentation [`974ee78`](https://github.com/DEFRA/water-abstraction-service/commit/974ee78fecb163f0a8bb9afd2ef332ad0f059df9)
- Minor tweak following QA identifying that previous implementation was hard-deleting records [`9d449f3`](https://github.com/DEFRA/water-abstraction-service/commit/9d449f376b6237b55fd7a4a881301b21da3a1fcb)
- Add Joi 17 support for manual address entry. [`368caa5`](https://github.com/DEFRA/water-abstraction-service/commit/368caa5d2b718eac914bc140d7ff3c825d466c5c)
- Fix lint errors [`f891b67`](https://github.com/DEFRA/water-abstraction-service/commit/f891b6711845583de560b20495a4114e06ffde4c)
- feat/water-3232 [`5e7ba39`](https://github.com/DEFRA/water-abstraction-service/commit/5e7ba39f257347a4a56d85e1021d1bcf87200323)
- updated the code from external user to secondaryExternal user [`c1c66d3`](https://github.com/DEFRA/water-abstraction-service/commit/c1c66d3b6edfcdf1c9b41cacf75ea4e7f5415882)
- Fix bug where deleting batch with 0 billing_batch_charge_version_years caused error [`8685de6`](https://github.com/DEFRA/water-abstraction-service/commit/8685de6220adf083bdc10815e95d63d998d50641)
- Update gauging-stations.js [`d823cde`](https://github.com/DEFRA/water-abstraction-service/commit/d823cde84b028d8e8086a3b54683137ba4979e5f)
- Add licence Id to query [`28a161d`](https://github.com/DEFRA/water-abstraction-service/commit/28a161d42952cf776849dccd78b2856f2a529c8b)
- Update licence-gauging-stations.js [`43ca2a4`](https://github.com/DEFRA/water-abstraction-service/commit/43ca2a47f67a165096e8c2b1b1709c6101a9ed52)
- Trigger CI [`436cd5a`](https://github.com/DEFRA/water-abstraction-service/commit/436cd5ad9894ea8ce9d572e309085e933621fddf)
- Update gauging-stations.js [`0b1b985`](https://github.com/DEFRA/water-abstraction-service/commit/0b1b985e4420b6ef0e0095b14522658a545c1500)
- Removes unused variable [`6d005e1`](https://github.com/DEFRA/water-abstraction-service/commit/6d005e179cfd876056d98830b5deb4f676c0ff57)
- merge develop into feat/water-3172-backend-licence-linkage [`4a8ff29`](https://github.com/DEFRA/water-abstraction-service/commit/4a8ff2932cd66e72896e78980b904c2849ee2051)
- merge develop into feat/water-3172-backend-licence-linkage [`103b6be`](https://github.com/DEFRA/water-abstraction-service/commit/103b6beb402a878d9f471bce6680e529e6a0413d)

#### [v2.2.0](https://github.com/DEFRA/water-abstraction-service/compare/v2.1.5...v2.2.0)

> 25 June 2021

- Feat/water 3256 nps psc charging permissons [`#1454`](https://github.com/DEFRA/water-abstraction-service/pull/1454)
- WATER - 3169 - Billing contact needed in UI for 2PT review [`#1445`](https://github.com/DEFRA/water-abstraction-service/pull/1445)
- Update charge-elements.js [`#1453`](https://github.com/DEFRA/water-abstraction-service/pull/1453)
- Return not found from licence summary if document header not found [`#1451`](https://github.com/DEFRA/water-abstraction-service/pull/1451)
- Add job handler to delete errored CM batch [`#1450`](https://github.com/DEFRA/water-abstraction-service/pull/1450)
- Adds new endpoint for posting a new linkage [`#1444`](https://github.com/DEFRA/water-abstraction-service/pull/1444)
- Re-billing implementation [`3283693`](https://github.com/DEFRA/water-abstraction-service/commit/3283693affc8588ad99415562f5b62c698272d82)
- Initial work on re-billing [`29d8d2f`](https://github.com/DEFRA/water-abstraction-service/commit/29d8d2f2c609dd37c552fefb18c1a8700808826d)
- MIgrations [`85082c4`](https://github.com/DEFRA/water-abstraction-service/commit/85082c4ecc396fb4ce9ae9c07f1a0b902b2d8a73)
- Fix generation of batches when 0 transactions except rebilling [`a16f7b0`](https://github.com/DEFRA/water-abstraction-service/commit/a16f7b0d96e54721c3d85686fa6ef8296e781236)
- feat/water-3169 [`05121b8`](https://github.com/DEFRA/water-abstraction-service/commit/05121b8bcc2c4bd5e5d9cfb74d7ff644a5ee2c19)
- Adds the gauging-stations findAll route and method [`4200a1c`](https://github.com/DEFRA/water-abstraction-service/commit/4200a1c24b942df5b9fc44993178efbdd2973656)
- Validation tweak following peer review suggestion [`777169b`](https://github.com/DEFRA/water-abstraction-service/commit/777169b6dc2640d88195a3adc337b720120bdddb)
- Resolves some merge conflicts [`57a56a6`](https://github.com/DEFRA/water-abstraction-service/commit/57a56a6c4af4d7d76aaf8e22d6f8d6371ad4fb5e)
- Tweak permissions [`9748eae`](https://github.com/DEFRA/water-abstraction-service/commit/9748eae1ff16cb9c25179087a804b6437e23e995)
- Adds a test [`42e022a`](https://github.com/DEFRA/water-abstraction-service/commit/42e022a20fbaf09bd2bb9a774b95d911379e105e)
- Fix tests [`28a2683`](https://github.com/DEFRA/water-abstraction-service/commit/28a2683747971ffa505ea355431c9488b21facf9)
- Update mapper [`f7ef3c5`](https://github.com/DEFRA/water-abstraction-service/commit/f7ef3c50041faec88e510c7a892796197751f67e)
- Fixes a dodgy-looking mapper [`62475e2`](https://github.com/DEFRA/water-abstraction-service/commit/62475e26b8c8c0ee27f13a169e3db442023d0439)
- Fixes a dodgy-looking mapper [`ab8479a`](https://github.com/DEFRA/water-abstraction-service/commit/ab8479a3a1ed41903d895f48c750653112491385)
- Update mapper [`b9bd0cb`](https://github.com/DEFRA/water-abstraction-service/commit/b9bd0cb654dfb7759939b8b7ff2117020b46faa3)
- Update routes.js [`4b9c7d2`](https://github.com/DEFRA/water-abstraction-service/commit/4b9c7d2abb145c3c2e0ca6d65a3fcfd7a0269aad)
- FIx test [`cc6819c`](https://github.com/DEFRA/water-abstraction-service/commit/cc6819c6f1bb00c4368e60aa62db1a6557c0ae85)
- Update licence-version-purpose-conditions.js [`7bb9645`](https://github.com/DEFRA/water-abstraction-service/commit/7bb96451a498f4202a4bfc0e77fcf7e94f195369)
- feat/water-3169 [`9754cff`](https://github.com/DEFRA/water-abstraction-service/commit/9754cff3dd9289e5ffb4e56797de34b87262ee8b)

#### [v2.1.5](https://github.com/DEFRA/water-abstraction-service/compare/v2.0.0...v2.1.5)

> 21 June 2021

- 2PT1 test data fix [`#1443`](https://github.com/DEFRA/water-abstraction-service/pull/1443)
- WATER-3109: a new table for gauging station links [`#1401`](https://github.com/DEFRA/water-abstraction-service/pull/1401)
- Adds route and controller + associated tests [`#1397`](https://github.com/DEFRA/water-abstraction-service/pull/1397)
- Feat/water 3147 backend endpoint for station restrictions and licences [`#1431`](https://github.com/DEFRA/water-abstraction-service/pull/1431)
- Release/charging [`#1442`](https://github.com/DEFRA/water-abstraction-service/pull/1442)
- Update Bull MQ [`#1440`](https://github.com/DEFRA/water-abstraction-service/pull/1440)
- Update Bull MQ [`#1439`](https://github.com/DEFRA/water-abstraction-service/pull/1439)
- Fix unique constraint on financial agreement types table [`#1436`](https://github.com/DEFRA/water-abstraction-service/pull/1436)
- Fix unique constraint on financial agreement code [`#1435`](https://github.com/DEFRA/water-abstraction-service/pull/1435)
- Feat/water 3105 [`#1433`](https://github.com/DEFRA/water-abstraction-service/pull/1433)
- Water 3105 - delete re-billed invoices [`#1432`](https://github.com/DEFRA/water-abstraction-service/pull/1432)
- Adds enpoints sans-tests [`457db92`](https://github.com/DEFRA/water-abstraction-service/commit/457db92006fc65a43a037f77ca3293e24feade49)
- Adds a new test fixture for bulk returns [`cec6c1b`](https://github.com/DEFRA/water-abstraction-service/commit/cec6c1b689dcfdeed0b5ca2c3e4ce00b8686af90)
- Adds a few tests [`b94fba5`](https://github.com/DEFRA/water-abstraction-service/commit/b94fba5aaa89ea963976cccd5b93af30865b07fb)
- Fixes a dodgy service method + Adds test [`2478f37`](https://github.com/DEFRA/water-abstraction-service/commit/2478f37adf53949c26581f34d25c95cd9878aa0c)
- Saving WIP [`bdd21ff`](https://github.com/DEFRA/water-abstraction-service/commit/bdd21ff4716dbb82ef4db5f28d474469992c91b4)
- Further tweakage following discussion with James regarding the abstractionPeriod object [`d191ce6`](https://github.com/DEFRA/water-abstraction-service/commit/d191ce62fa28f02c56e88d50e6749ad5088e1aaa)
- Minor fixes to mapper + broken test [`73bbf72`](https://github.com/DEFRA/water-abstraction-service/commit/73bbf72c96b3ab3167930673ea8fd09b17360bfb)
- Makes a date field nullable [`d643684`](https://github.com/DEFRA/water-abstraction-service/commit/d6436849cf4698283eea2cac938272cb2df44053)
- backend for licence-gauging station UI linkage [`f303fbd`](https://github.com/DEFRA/water-abstraction-service/commit/f303fbd318561be420eb0ee0a3893317fb49bdbe)
- feat/water-3169 [`92650f4`](https://github.com/DEFRA/water-abstraction-service/commit/92650f489b517661df604c211039bb2227c1f381)
- feat/water-3169 [`a15d56f`](https://github.com/DEFRA/water-abstraction-service/commit/a15d56f8db5d21666a3ed9bbd8c5e491ad8bddd2)
- feat/water-3169 [`260633e`](https://github.com/DEFRA/water-abstraction-service/commit/260633e8df334ba6c14447bda8de20c357c240de)
- feat/water-3169 [`32b7e4c`](https://github.com/DEFRA/water-abstraction-service/commit/32b7e4cf3dc223c2ff6a7403af10e0b5c46f22d7)
- feat/water-3169 [`b94ce6f`](https://github.com/DEFRA/water-abstraction-service/commit/b94ce6f8cad5b08039f694188d3b9056d0a49810)
- sql findGaugingStationWithLinkedLicences with explicit column names [`50df890`](https://github.com/DEFRA/water-abstraction-service/commit/50df890290200afe12e02cc1f96f33332597b46b)
- Flatten abstraction period object and correct variable name mismatch in controller [`5c9be4f`](https://github.com/DEFRA/water-abstraction-service/commit/5c9be4f8aaeca1325317f1ccfa2a92b474477b05)
- feat/water-3169 [`81d278e`](https://github.com/DEFRA/water-abstraction-service/commit/81d278ea18c351b000c193c8c39978e0bfc2f8e8)
- feat/water-3169 [`44c760a`](https://github.com/DEFRA/water-abstraction-service/commit/44c760a8308e04d296d7ed28852700f6aeef13f3)
- feat/water-3169 [`084553d`](https://github.com/DEFRA/water-abstraction-service/commit/084553da8c95394a5c8c5237f3f53c6abc1d27b2)
- feat/water-3169 [`8551830`](https://github.com/DEFRA/water-abstraction-service/commit/85518301b8d2e5517da7347ff154aa747ac6e79b)
- Changes to the validation so that you get a 404 if you provide an invalid payload or gauging station Id [`b3f0b41`](https://github.com/DEFRA/water-abstraction-service/commit/b3f0b4155ef6058d5218cf96c1c16d5936b9c339)
- Update licence-version-purpose-conditions.js [`1228d83`](https://github.com/DEFRA/water-abstraction-service/commit/1228d837ba239de5e65e428e398c6a7af328a063)
- Fix a broken test [`86f75a3`](https://github.com/DEFRA/water-abstraction-service/commit/86f75a35b92397986cacd07be71639b07d6a12dc)
- Removing code smells [`e2bb1a2`](https://github.com/DEFRA/water-abstraction-service/commit/e2bb1a26dee76d4fa480b294d1ec5ffedea6cd0f)
- Further tweaks following peer review [`57c0b2f`](https://github.com/DEFRA/water-abstraction-service/commit/57c0b2ff74e6c54500583ec9bd92ce75cd445315)
- Update index.js [`98671f8`](https://github.com/DEFRA/water-abstraction-service/commit/98671f8b96a826991317aef45e1d14722d6cabaa)
- Validation changed following peer review [`b203f87`](https://github.com/DEFRA/water-abstraction-service/commit/b203f87ea660b4e73af16b753a3196b2961b37bc)
- feat/water-3169 [`6402f73`](https://github.com/DEFRA/water-abstraction-service/commit/6402f73d3ea302d2cfb9cdb9e74c9b033538762f)
- PRODUCTION BUG Check that data exists when composing search response [`203c5ae`](https://github.com/DEFRA/water-abstraction-service/commit/203c5ae9a3577244e39cad2455db974b1bc6e439)
- feat/water-3196 [`5f79165`](https://github.com/DEFRA/water-abstraction-service/commit/5f79165f9f929b130c5ce05151a0085d6c3f2638)
- feat/water-3196 [`ff06e85`](https://github.com/DEFRA/water-abstraction-service/commit/ff06e852c8e06a4ee27533bc99825dab44da6481)
- Allow null for licenceVersionPurposeConditionId payload item [`6a590ac`](https://github.com/DEFRA/water-abstraction-service/commit/6a590ac6e4b41390a9902361ec356f8127e938ac)
- Update licence-version-purpose-conditions.js [`160325b`](https://github.com/DEFRA/water-abstraction-service/commit/160325b6204f22849302bf54f1945bbf037e0322)
- Fixes a broken test [`36a1f8b`](https://github.com/DEFRA/water-abstraction-service/commit/36a1f8bc6e9034e9ec16a4ee5628028e16b68100)
- Fixed a minor error [`f64e1cd`](https://github.com/DEFRA/water-abstraction-service/commit/f64e1cde2d97a42b0bc2df385ecaa3b79f32529a)
- feat/water-3169 [`9530536`](https://github.com/DEFRA/water-abstraction-service/commit/95305364304fb124b87aeee665ffa7b9e86a769f)
- feat/water-3169 [`848a05f`](https://github.com/DEFRA/water-abstraction-service/commit/848a05f024d8169825aa7dd1f8919b5561a3601a)
- sql findGaugingStationWithLinkedLicences simplified and merged [`b338a57`](https://github.com/DEFRA/water-abstraction-service/commit/b338a57caa1e27723a5cc87fc391152f6bd742fc)
- Create endpoint and tests for gauging station restrictions/licences [`746813d`](https://github.com/DEFRA/water-abstraction-service/commit/746813d03d20ac2d80db51ddbd46cf93bce6907c)
- Adds new endpoint for posting a new linkage [`5da6c63`](https://github.com/DEFRA/water-abstraction-service/commit/5da6c6350cf638a25b4678b7beb9290394fb9adc)
- Deduplicating routes in accidental merge conflict [`d097f41`](https://github.com/DEFRA/water-abstraction-service/commit/d097f41f087a132d8377d2d954d4641f981a77ec)
- Removes a code smell and increases coverage [`d079cf3`](https://github.com/DEFRA/water-abstraction-service/commit/d079cf3262a79a9fb6e07f901a2851eee8987e77)
- code refactoring and extended sql query [`3db187b`](https://github.com/DEFRA/water-abstraction-service/commit/3db187bfbbd58f6721f849c7b8054fef2d9824fd)
- code refactoring and extended sql query [`f51bf9c`](https://github.com/DEFRA/water-abstraction-service/commit/f51bf9c4ea92425b7b9fbab483db163ce83d462d)
- fix linting issues and amend tests [`25821e8`](https://github.com/DEFRA/water-abstraction-service/commit/25821e8009b4b4407939f5f4b9860e68daf06b72)
- fix linting issues and amend tests [`5c87d99`](https://github.com/DEFRA/water-abstraction-service/commit/5c87d99f6acc69f505c761a263b4f88fb41912c3)
- feat/water-3105 [`fc3482d`](https://github.com/DEFRA/water-abstraction-service/commit/fc3482d3ab258fae2d1d6488c37f71b3c95463d3)
- feat/water-3105 [`4c334a5`](https://github.com/DEFRA/water-abstraction-service/commit/4c334a5673aaf8c104711e8428d27c75eaafd35b)
- feat/water-3169 [`6ed6e05`](https://github.com/DEFRA/water-abstraction-service/commit/6ed6e059e9bcc193b01ec0f0989b022508d0de91)
- Restoring Axel's query [`d130660`](https://github.com/DEFRA/water-abstraction-service/commit/d130660134b5990cd98f86252fb7201211a95a88)
- Update gauging-stations.js [`94c2bdb`](https://github.com/DEFRA/water-abstraction-service/commit/94c2bdb9382fe015daf31f1746e5cb30e3df363a)
- amend sql query and name api endpoint [`8e76750`](https://github.com/DEFRA/water-abstraction-service/commit/8e76750708bb0834ac98a73c6bcf97caf97f9638)
- Updated query for gauging station restrictions/licences [`9bbae5e`](https://github.com/DEFRA/water-abstraction-service/commit/9bbae5e3fc2aa608edf2f3719fe3bb70dd134cac)
- remove superfluous comments [`12e78d0`](https://github.com/DEFRA/water-abstraction-service/commit/12e78d0d90efb4649bc85c72fcbbeb0da3c07690)
- fix code smell [`73ae3db`](https://github.com/DEFRA/water-abstraction-service/commit/73ae3db6ac3805c9efaccaf686a7af614f2d6f65)
- fix code smell [`d83c37d`](https://github.com/DEFRA/water-abstraction-service/commit/d83c37d0612ccc94fed36444502cdb24a16800d6)
- feat/water-3105 [`09e91db`](https://github.com/DEFRA/water-abstraction-service/commit/09e91db96b92b2d996b0c1ecbd25fb6f7c28f494)
- feat/water-3105 [`6771379`](https://github.com/DEFRA/water-abstraction-service/commit/67713795b49e9d9d4338cf9ce3d8640af759caae)
- Adds auth check [`8f58ba1`](https://github.com/DEFRA/water-abstraction-service/commit/8f58ba1b6991d97b96cd46dc08697fd2ee31fe8c)
- fix code smell [`ab87aeb`](https://github.com/DEFRA/water-abstraction-service/commit/ab87aeb01cf5aea58aaf6addb8df85c0dc6c9e49)
- Removed some oopsies [`d1dcb1e`](https://github.com/DEFRA/water-abstraction-service/commit/d1dcb1e18b85812c0d23015936e90ad2dea1e896)
- feat/water-3169 [`53d18c1`](https://github.com/DEFRA/water-abstraction-service/commit/53d18c1b26adfc4c6fc46b8c7fe46a3c4aab9adf)
- bugfix/yaml-test-data-fix [`2ffbb3d`](https://github.com/DEFRA/water-abstraction-service/commit/2ffbb3d39be409ce28236a685ce80e72c466935c)
- spaces at the end of line removed [`2ec9055`](https://github.com/DEFRA/water-abstraction-service/commit/2ec90556651f01c03c4b513f95deed70e8a8074e)
- remove superfluous comments [`6669652`](https://github.com/DEFRA/water-abstraction-service/commit/6669652c3cade30374ffdab19f23adface73f17d)
- feat/water-3105 [`093cd9d`](https://github.com/DEFRA/water-abstraction-service/commit/093cd9dbccfdfaab0bb3065aee08a14b2ac76ab9)
- fix code smell [`e2bf4f9`](https://github.com/DEFRA/water-abstraction-service/commit/e2bf4f9b9cda77a6dad04644c1aa770d864a4a11)
- feat/water-3105 [`33bc6ea`](https://github.com/DEFRA/water-abstraction-service/commit/33bc6eaabd1917b15dac3794495beb199852454e)
- fix code smell line length issue [`0baae41`](https://github.com/DEFRA/water-abstraction-service/commit/0baae41da37be56f64e84fe74fda7aecfa8ef452)
- skip test requiring new table water.gauging_station_condition [`4e1ebf8`](https://github.com/DEFRA/water-abstraction-service/commit/4e1ebf87c4619cc19ad212f784af5c03ec8ced23)
- fix code smell line length issue [`64fb7c0`](https://github.com/DEFRA/water-abstraction-service/commit/64fb7c0e296a118fb4e3dc639fe850cd99d10fdf)
- skip test requiring new table water.gauging_station_condition [`087b99c`](https://github.com/DEFRA/water-abstraction-service/commit/087b99cdfa7af37ea69f7a532c2bec5fcdfceabc)
- fear/water-3105 [`11413d4`](https://github.com/DEFRA/water-abstraction-service/commit/11413d4e604fbe064eeae6b5431250f7e268d678)
- feat/water-3105 [`3265cde`](https://github.com/DEFRA/water-abstraction-service/commit/3265cde2b7d538e4fbfadf15a814153f4f9d1d6b)
- feat/water-3105 [`d4b780e`](https://github.com/DEFRA/water-abstraction-service/commit/d4b780e34827bdd2663f78bd16434fa7b6c8c79f)

### [v2.0.0](https://github.com/DEFRA/water-abstraction-service/compare/v1.76.0...v2.0.0)

> 7 June 2021

- Fetch due_date when getting returns by format ID [`#1429`](https://github.com/DEFRA/water-abstraction-service/pull/1429)
- Fix issue on licence summary tab caused by events with empty string status [`#1427`](https://github.com/DEFRA/water-abstraction-service/pull/1427)
- Ensure min charge transactions have correct status [`#1428`](https://github.com/DEFRA/water-abstraction-service/pull/1428)
- Release/wrls sprint 47 [`#1426`](https://github.com/DEFRA/water-abstraction-service/pull/1426)
- WATER - 3105 Water service process to safely delete rebilling invoices [`#1425`](https://github.com/DEFRA/water-abstraction-service/pull/1425)
- Feat/water 3207 tpt transaction description [`#1420`](https://github.com/DEFRA/water-abstraction-service/pull/1420)
- Tweak TPT transaction descriptions [`#1419`](https://github.com/DEFRA/water-abstraction-service/pull/1419)
- Create endpoint and tests for gauging station restrictions/licences [`324e1a9`](https://github.com/DEFRA/water-abstraction-service/commit/324e1a9f8d7919b861c1bd372f87fc7029cad8b0)
- feat/water-3105 [`5eb7b5c`](https://github.com/DEFRA/water-abstraction-service/commit/5eb7b5c7a92cf4ad0a65e9293f037ad6955a4b0e)
- feat/water-3105 [`9cef455`](https://github.com/DEFRA/water-abstraction-service/commit/9cef45581afeda7a0069f041925fc95bba9148c1)
- Updated query for gauging station restrictions/licences [`2858127`](https://github.com/DEFRA/water-abstraction-service/commit/2858127ef3798e5ad35c14e5c9a39d5e3ee33f4f)
- Billing account search should tolerate lowercase input [`afe3fa3`](https://github.com/DEFRA/water-abstraction-service/commit/afe3fa356d77d939d9903205b17aa3ecd0bde1c2)
- feat/water-3105 [`8954bee`](https://github.com/DEFRA/water-abstraction-service/commit/8954bee97523738a5534c046da504dc6cdb4f713)
- Fix code smell [`dc361d7`](https://github.com/DEFRA/water-abstraction-service/commit/dc361d7f39e58a16154bbcef46f717d3e72c8bcd)

#### [v1.76.0](https://github.com/DEFRA/water-abstraction-service/compare/v1.74.0...v1.76.0)

> 27 May 2021

- Add isSection127AgreementEnabled flag to charge element mapper [`#1418`](https://github.com/DEFRA/water-abstraction-service/pull/1418)
- Adds search functionality for billing accounts [`#1417`](https://github.com/DEFRA/water-abstraction-service/pull/1417)
- Modify logic for which charge versions appear in TPT bill run [`#1416`](https://github.com/DEFRA/water-abstraction-service/pull/1416)
- Make charge element isSection127AgreementEnabled flag default to false [`#1408`](https://github.com/DEFRA/water-abstraction-service/pull/1408)
- Emails NALD service mailbox instead of queueing entity changes for se… [`#1415`](https://github.com/DEFRA/water-abstraction-service/pull/1415)
- Tweak query to get charge versions in bill run [`#1414`](https://github.com/DEFRA/water-abstraction-service/pull/1414)
- Tweak query to get charge versions in bill run [`#1414`](https://github.com/DEFRA/water-abstraction-service/pull/1414)
- WATER-3191 - licence links broken in internal returns flows [`#1410`](https://github.com/DEFRA/water-abstraction-service/pull/1410)
- Bugfix/water 3185 tltd agreement single day [`#1413`](https://github.com/DEFRA/water-abstraction-service/pull/1413)
- Add agreements history processor test cases [`#1412`](https://github.com/DEFRA/water-abstraction-service/pull/1412)
- Feat/water 3081 informing CM when there has been a NALD linked entities change [`#1374`](https://github.com/DEFRA/water-abstraction-service/pull/1374)
- Initial work to support licence summary page by licence ID [`#1399`](https://github.com/DEFRA/water-abstraction-service/pull/1399)
- Feat/water 3136 purpose conditions [`#1402`](https://github.com/DEFRA/water-abstraction-service/pull/1402)
- Test data/add 2pt1 test fixtures [`#1407`](https://github.com/DEFRA/water-abstraction-service/pull/1407)
- Release/wrls sprint 46 [`#1406`](https://github.com/DEFRA/water-abstraction-service/pull/1406)
- Adds missing migration [`#1405`](https://github.com/DEFRA/water-abstraction-service/pull/1405)
- Adds missing migration [`#1403`](https://github.com/DEFRA/water-abstraction-service/pull/1403)
- Data 3048 [`#1400`](https://github.com/DEFRA/water-abstraction-service/pull/1400)
- Remove gauging stations api [`#1394`](https://github.com/DEFRA/water-abstraction-service/pull/1394)
- Water 3110/gauging stations table updates [`#1395`](https://github.com/DEFRA/water-abstraction-service/pull/1395)
- Adds gauging stations to global search [`#1368`](https://github.com/DEFRA/water-abstraction-service/pull/1368)
- Test data for test automation of annual billing run  [`#1396`](https://github.com/DEFRA/water-abstraction-service/pull/1396)
- WIP [`cd0398a`](https://github.com/DEFRA/water-abstraction-service/commit/cd0398add77f57240e58396e82c2af432fc453ba)
- Unit tests [`6523726`](https://github.com/DEFRA/water-abstraction-service/commit/6523726025778c3c1facce44b9d4fe6cd565688a)
- Made some changes off the back of peer review [`faeb54e`](https://github.com/DEFRA/water-abstraction-service/commit/faeb54e587ce9dbae0b05df657a044077632f86a)
- Replicates the functions that were removed by removing the Postgres connector [`99a22bd`](https://github.com/DEFRA/water-abstraction-service/commit/99a22bdfa26483c30211cdde3f6d83230ac31313)
- feat/water-3136 [`e9f3970`](https://github.com/DEFRA/water-abstraction-service/commit/e9f397069410cfc890beb9e0656fd6e61590ff15)
- Adds route and controller + associated tests [`893a110`](https://github.com/DEFRA/water-abstraction-service/commit/893a1101b77886eed0b27195061760e58085a879)
- WIP [`1c4005d`](https://github.com/DEFRA/water-abstraction-service/commit/1c4005d2238222a89e4e4c29e7b49ff1cc1c1ac8)
- Resolving code smells [`23e9726`](https://github.com/DEFRA/water-abstraction-service/commit/23e97260078d01b5188b8d82f7c0bab63394650f)
- Reinstating a constraint that I unhelpfully removed a couple of days ago, thinking it was a duplicate! [`d3137ac`](https://github.com/DEFRA/water-abstraction-service/commit/d3137ac75d5e1a5bb3dc4f85d80fdb66aa7a844a)
- Drops duplicate constraint on financial agreement types [`a2d63f4`](https://github.com/DEFRA/water-abstraction-service/commit/a2d63f42d559a40fe1253a4e4d5c2826faea0e83)
- WIP [`a85203d`](https://github.com/DEFRA/water-abstraction-service/commit/a85203d01adc84330d16965ec72707bcf93e43da)
- updated sets.json [`fc7b2f8`](https://github.com/DEFRA/water-abstraction-service/commit/fc7b2f84fe5781d255e3e04e03daf1abaf4af38e)
- Update sets.json [`512910d`](https://github.com/DEFRA/water-abstraction-service/commit/512910dd1b46e8162f1fe16184035d08b4d5dec3)
- Adds a new fixture set for Srujan's automation suite [`44d87ec`](https://github.com/DEFRA/water-abstraction-service/commit/44d87ec821f805f0a6f1362eca77c86ecace1d5c)
- Modifies the 2PT1 setup routine [`19b1013`](https://github.com/DEFRA/water-abstraction-service/commit/19b10133196966b3ffafedd78204a81aca8a95df)
- Emails NALD service mailbox instead of queueing entity changes for sending to SOP via CM [`f80225e`](https://github.com/DEFRA/water-abstraction-service/commit/f80225e59e10b1162a76659d94adb063cfbebbfb)
- Breaking long lines [`21ae78a`](https://github.com/DEFRA/water-abstraction-service/commit/21ae78a72762d16d451321f6e41179298fc7350d)
- feat/water-3136 [`d09c2a7`](https://github.com/DEFRA/water-abstraction-service/commit/d09c2a7e1eb5fd1fa13cb0a5dee3b36359faecc7)
- Increase test coverage [`61dea1d`](https://github.com/DEFRA/water-abstraction-service/commit/61dea1d90d261cbede9df1a549352eb4c04797e1)
- Fuller coverage [`bb9b625`](https://github.com/DEFRA/water-abstraction-service/commit/bb9b625b07c268798e5822f5f320533b77602b54)
- Change order of migration scripts [`418db82`](https://github.com/DEFRA/water-abstraction-service/commit/418db824172ce23eb57434695ca69385197de7e2)
- Fixing a couple of PR observations [`4fdd677`](https://github.com/DEFRA/water-abstraction-service/commit/4fdd677942252a6a4506421ac6a76abd8d2374bc)
- Update tests [`846109d`](https://github.com/DEFRA/water-abstraction-service/commit/846109d163368cf7dbe72a028ba34183f65ed6c6)
- Fixes a broken test [`e911a5e`](https://github.com/DEFRA/water-abstraction-service/commit/e911a5ea1d54dce9f57f11de3026d0091469d5e8)
- Patches the 2PT data set up as requested by Hari [`ba88af5`](https://github.com/DEFRA/water-abstraction-service/commit/ba88af56f0fc2e2abfd4687cda257dcd1c1f95b5)
- feat/water-3136 [`c884982`](https://github.com/DEFRA/water-abstraction-service/commit/c8849828518658c2abb4e7ef2b314afb13d97de7)
- Update 2PT1.yaml [`efeceeb`](https://github.com/DEFRA/water-abstraction-service/commit/efeceeb8f2b684d461ac955d73e55da1a8a36b88)
- Fixing a broken test [`5c2e0b0`](https://github.com/DEFRA/water-abstraction-service/commit/5c2e0b02bfd8c2bba14f9304f723b68b34aba6bc)
- Fix typos [`481f572`](https://github.com/DEFRA/water-abstraction-service/commit/481f572870490dcc8f87be6079dfad48f5bbe7ff)
- feat/water-3136 [`86209da`](https://github.com/DEFRA/water-abstraction-service/commit/86209da09bfcd6052b6084183988b62ec74e6774)
- Adds missing variable to Github actions [`af1caea`](https://github.com/DEFRA/water-abstraction-service/commit/af1caea23b0f034da35062ad36f59571997a50e8)
- Fix test [`33fd6c7`](https://github.com/DEFRA/water-abstraction-service/commit/33fd6c77cf6faa5a52eff38a3a80e8135c821e22)
- Update 20210222191936-charge-version-workflows-licence-version-consraint-up.sql [`548f044`](https://github.com/DEFRA/water-abstraction-service/commit/548f0440a39484105c96c71c4572591366b089fd)
- Update 20210517102220-create-licence-gauging-stations-table-up.sql [`d32ced9`](https://github.com/DEFRA/water-abstraction-service/commit/d32ced930a91344374e9b99df7986647f4a127b3)
- Update check-for-updated-invoice-accounts.js [`a59f156`](https://github.com/DEFRA/water-abstraction-service/commit/a59f15648e62880faab3c4254a3b9ba2d34e2bcc)
- Fix broken test [`e0e3801`](https://github.com/DEFRA/water-abstraction-service/commit/e0e3801ee427a6cfd75407d3303fc8790bdb00db)
- WIP [`95a9509`](https://github.com/DEFRA/water-abstraction-service/commit/95a950910b22a1e3a59b2ee532ba8df9eb2dbc37)
- Minor correction in the reporting controller [`5a13909`](https://github.com/DEFRA/water-abstraction-service/commit/5a13909c641df962aabf774191c0bbd42e56660b)
- Update config.js [`1ef50cf`](https://github.com/DEFRA/water-abstraction-service/commit/1ef50cf00982f9ad47f5c2aebbdcf6449f6320ca)
- Removing a minor code smell [`a61855a`](https://github.com/DEFRA/water-abstraction-service/commit/a61855a3ad7da8b8ca60368bf099287a7b208fb9)
- Removing an oopsie that was accidentally committed [`aea128a`](https://github.com/DEFRA/water-abstraction-service/commit/aea128a514a47b77282b929ee3c97a64aa3b6c25)
- Update 2PT1.yaml [`70117bd`](https://github.com/DEFRA/water-abstraction-service/commit/70117bd3f3cc257ec71e8f2820f264b3e228a3bf)
- Update 20210518102220-create-licence-gauging-stations-table.js [`d108e07`](https://github.com/DEFRA/water-abstraction-service/commit/d108e071be606cf86d01854dcfa341174919b88d)

#### [v1.74.0](https://github.com/DEFRA/water-abstraction-service/compare/v1.73.0...v1.74.0)

> 11 May 2021

- Revert "Fixes issue where returns not received not flagged as error" [`#1393`](https://github.com/DEFRA/water-abstraction-service/pull/1393)
- Removes licence agreement purposes uses table.  [`#1392`](https://github.com/DEFRA/water-abstraction-service/pull/1392)
- Removes River levels [`#1384`](https://github.com/DEFRA/water-abstraction-service/pull/1384)
- Set full billable volume only when season matches [`#1390`](https://github.com/DEFRA/water-abstraction-service/pull/1390)
- Include charge period in billing volume endpoint response [`#1389`](https://github.com/DEFRA/water-abstraction-service/pull/1389)
- Fixes issue where returns not received not flagged as error [`#1388`](https://github.com/DEFRA/water-abstraction-service/pull/1388)
- Water-3041 - New route to proxy notify calls via the water service [`#1386`](https://github.com/DEFRA/water-abstraction-service/pull/1386)
- Release/wrls sprint 45 [`#1385`](https://github.com/DEFRA/water-abstraction-service/pull/1385)
- Feat/water 3157 licence agreement purpose uses [`#1375`](https://github.com/DEFRA/water-abstraction-service/pull/1375)
- Allow TPT returns grace period to be configured with env var [`#1377`](https://github.com/DEFRA/water-abstraction-service/pull/1377)
- Allow returns grace period to be set via .env variable [`#1376`](https://github.com/DEFRA/water-abstraction-service/pull/1376)
- UAT bug fix - send/approve batch WATER 3142 [`#1373`](https://github.com/DEFRA/water-abstraction-service/pull/1373)
- Move empty batch detection to end of CM refresh [`#1372`](https://github.com/DEFRA/water-abstraction-service/pull/1372)
- Feat/water 3090 rebilling [`#1360`](https://github.com/DEFRA/water-abstraction-service/pull/1360)
- Set domain and port separately in tunnel module [`#1369`](https://github.com/DEFRA/water-abstraction-service/pull/1369)
- Replace request module with got in CM API connector [`#1367`](https://github.com/DEFRA/water-abstraction-service/pull/1367)
- 1.73.0 [`#1366`](https://github.com/DEFRA/water-abstraction-service/pull/1366)
- FIx broken tests, update hapi lab version to fix globals issue [`24b86e2`](https://github.com/DEFRA/water-abstraction-service/commit/24b86e271e2e895670a976fec24a7ed6d90b2b47)
- Got implementation working locally [`6d6928b`](https://github.com/DEFRA/water-abstraction-service/commit/6d6928b75f32ac3a7e7829d85a3d8307fc54c9e0)
-  Tidy up got implementation, remove legacy code [`b318a32`](https://github.com/DEFRA/water-abstraction-service/commit/b318a323a4ae48d4babb75f0551de560f6a2bb90)
- WIP [`77ab216`](https://github.com/DEFRA/water-abstraction-service/commit/77ab216151a662f86f02e03c7a9753180d96d4c5)
- Additional tests [`ee46c41`](https://github.com/DEFRA/water-abstraction-service/commit/ee46c416277f3b577733250199f86fc4ca00f0f6)
- feat/water-3142 [`155740d`](https://github.com/DEFRA/water-abstraction-service/commit/155740d13674c889e1330f97f6f6d736ed14c378)
- Add tests [`b97f04a`](https://github.com/DEFRA/water-abstraction-service/commit/b97f04a1814c9656deed98954110d7408cf5a16c)
- Adds job test [`b7cd3af`](https://github.com/DEFRA/water-abstraction-service/commit/b7cd3afcd4eb0dfb585ff6c029f429b5cd129ea0)
- Add re-billing job [`a2b7ec0`](https://github.com/DEFRA/water-abstraction-service/commit/a2b7ec011f1675aaaa75b45fb63e6d318317b183)
- Additional tests [`bdcbe98`](https://github.com/DEFRA/water-abstraction-service/commit/bdcbe980cd071f98b281e0fa92d379e2438098fc)
- Adds gauging stations to global search [`b1dda0f`](https://github.com/DEFRA/water-abstraction-service/commit/b1dda0f66d41f314ec79d42f270215d9e7df50e1)
- WIP [`8b66db0`](https://github.com/DEFRA/water-abstraction-service/commit/8b66db0f8badd2c38a485f8c2b6513a41d3a60a9)
- Fix tests [`646fb02`](https://github.com/DEFRA/water-abstraction-service/commit/646fb0293119ed2871dbc2037161389fccc9868b)
- Additional tests [`f65baac`](https://github.com/DEFRA/water-abstraction-service/commit/f65baaca87e4eeacc87f8814b65ddda3e1dce29f)
- Fix code smells, add tests for AccessTokenManager [`71128fa`](https://github.com/DEFRA/water-abstraction-service/commit/71128fac1aa1b4cbecd55951d1006964a6895581)
- Fix test file naming [`39ee3c7`](https://github.com/DEFRA/water-abstraction-service/commit/39ee3c769236ebbea7b1c7a4f006c4b563d27f34)
- Add licence agreement purposes [`1eb9758`](https://github.com/DEFRA/water-abstraction-service/commit/1eb9758203217299603d9d29c955ac38436d40a6)
- Adds migration scripts [`bd185c8`](https://github.com/DEFRA/water-abstraction-service/commit/bd185c8314b9a8edc8c9bf9bfcf8d4c7efe8d861)
- Adds a join column to allow purpose uses to be linked to a licence agreement [`0a032c4`](https://github.com/DEFRA/water-abstraction-service/commit/0a032c4542fca83d8124e10d66e2d97ae4661aa7)
- Additional tests [`ba0f687`](https://github.com/DEFRA/water-abstraction-service/commit/ba0f6876c70152a83d9396c14b5fcd98b3c723a6)
- Add re-billing migration [`98e5a37`](https://github.com/DEFRA/water-abstraction-service/commit/98e5a37865526b7a0baddede53c195256cfa2de8)
- Add new fields to Invoice model.  Prevent flagging for rebilling on rebilling invoices [`b844079`](https://github.com/DEFRA/water-abstraction-service/commit/b844079a50bd3708bbe9562595721eabcf7cd446)
- Reset rebilling flags when bill run sent [`af2c3a8`](https://github.com/DEFRA/water-abstraction-service/commit/af2c3a8260cf98a053f1a3ceb19327daee25eef6)
- bugfix/water-3041 [`a99e0ba`](https://github.com/DEFRA/water-abstraction-service/commit/a99e0ba25081205cfd1214716d3b00d0b8e94a31)
- bugfix/water-3041 [`13b7a3b`](https://github.com/DEFRA/water-abstraction-service/commit/13b7a3b34f054b2ad654a03b2582b2a3361d7823)
- Tweak logic to allow winter/all year 2021 TPT batch to be processed in service [`9666a65`](https://github.com/DEFRA/water-abstraction-service/commit/9666a65179d65ed2e99f6c0a63fb40dabdc1ef14)
- Included linked bills in invoice response [`c15e888`](https://github.com/DEFRA/water-abstraction-service/commit/c15e8886dbef098aae4784e95a5dde080571118e)
- Revert "Tweak logic to allow winter/all year 2021 TPT batch to be processed in service" [`490351e`](https://github.com/DEFRA/water-abstraction-service/commit/490351e81386a231fda97ebe09cdbfdc63b973d5)
- Move redis max listener count to config [`80709fb`](https://github.com/DEFRA/water-abstraction-service/commit/80709fbe39f26fc6c24244ecb7e903c702cb65c6)
- Add repo method to find linked invoices [`d3243d4`](https://github.com/DEFRA/water-abstraction-service/commit/d3243d42504261d242fb62d44da2de7cba10a070)
- Allows the returns grace period to be customised for testing via env variable [`3cce8ce`](https://github.com/DEFRA/water-abstraction-service/commit/3cce8cead678d6183da8a0b4dfd3dda4146a55a5)
- Additional tests [`bad0f8a`](https://github.com/DEFRA/water-abstraction-service/commit/bad0f8a114d6838c20930f2177dc2c322f13fd79)
- Add linkedInvoices array to Invoice model [`8128c42`](https://github.com/DEFRA/water-abstraction-service/commit/8128c425a95190edcaa1d8f81eda459b2dd056a0)
- Fix code smell and test [`2846f7b`](https://github.com/DEFRA/water-abstraction-service/commit/2846f7bb8f354441139cc6fc61fd5202f21c77c1)
- feat/water-3142 [`425a4ea`](https://github.com/DEFRA/water-abstraction-service/commit/425a4ea3ff78a2986b4b6c4933d8f72dd4cc1d19)
- Update .env.example [`3953012`](https://github.com/DEFRA/water-abstraction-service/commit/3953012eef2b24d04148179095d25e86a5f336c7)
- Removes unused variable [`58969c4`](https://github.com/DEFRA/water-abstraction-service/commit/58969c4929ab579963b72e7cf021f0ce396ee59f)
- Remove unused variables [`0a0dc96`](https://github.com/DEFRA/water-abstraction-service/commit/0a0dc966f3063efb6ca2584e7722bfa9ac1e348e)
- bugfix/water-3041 [`6d96947`](https://github.com/DEFRA/water-abstraction-service/commit/6d96947daa669c704b9a067e3035b993e05d5305)
- Fix linter error [`62db37a`](https://github.com/DEFRA/water-abstraction-service/commit/62db37a354847d2f9cb85be56124048a3ab80e35)
- Removing a semi colon accidentally created in resolving a merge conflict [`7d53b7a`](https://github.com/DEFRA/water-abstraction-service/commit/7d53b7a409ffaee334a52d335f56df0695091022)
- feat/water-3142 [`71a2ac5`](https://github.com/DEFRA/water-abstraction-service/commit/71a2ac52ccd20c60530c4db847b4ac6e460c1cb0)
- Increase Redis listener count [`980ce2f`](https://github.com/DEFRA/water-abstraction-service/commit/980ce2f971407284bcd8f2416f76b3fa0071320d)
- Removes a code smell [`ce0918e`](https://github.com/DEFRA/water-abstraction-service/commit/ce0918ec1761313f1e0b87f82462780d9cc0af5d)
- Removes TEST Licence Versions in the teardown routine [`228709c`](https://github.com/DEFRA/water-abstraction-service/commit/228709cb44d6745c49c65ca548029e184a88cc3c)

#### [v1.73.0](https://github.com/DEFRA/water-abstraction-service/compare/v1.72.1...v1.73.0)

> 27 April 2021

- Bugfix - factors overridden field added to charge elements test data [`#1362`](https://github.com/DEFRA/water-abstraction-service/pull/1362)
- Feat/water 2864 [`#1353`](https://github.com/DEFRA/water-abstraction-service/pull/1353)
- Skip request to CM unless transaction in "candidate" status.   [`#1364`](https://github.com/DEFRA/water-abstraction-service/pull/1364)
- Update helpers [`#1363`](https://github.com/DEFRA/water-abstraction-service/pull/1363)
- Feat/water 3011 return kpis [`#1358`](https://github.com/DEFRA/water-abstraction-service/pull/1358)
- Release/wrls sprint 44 patch 1 [`#1359`](https://github.com/DEFRA/water-abstraction-service/pull/1359)
- Update cm-refresh-service.js [`#1356`](https://github.com/DEFRA/water-abstraction-service/pull/1356)
- Return additional factor fields for transactions csv [`#1357`](https://github.com/DEFRA/water-abstraction-service/pull/1357)
- Fixes pagination not implemented on invoice account invoices endpoint [`#1355`](https://github.com/DEFRA/water-abstraction-service/pull/1355)
- Adds file streaming by using the got module [`7eae66a`](https://github.com/DEFRA/water-abstraction-service/commit/7eae66a90af74b3da28e49785fb4cefa4872627e)
- Fix tests [`be98f8a`](https://github.com/DEFRA/water-abstraction-service/commit/be98f8a19ac02e26feaf86fb24c302f7564a347c)
- Skip request to CM unless transaction in "candidate" status.  Remove 409 handling [`a2b77ac`](https://github.com/DEFRA/water-abstraction-service/commit/a2b77ac607ebe4d9b9f958453fcbafd4d1c9ac34)
- Re-write returns events query [`da851af`](https://github.com/DEFRA/water-abstraction-service/commit/da851af121a755f6406e17a1efdd3e5497ddb97d)
- Use new return cycle reports for KPIs [`93928ec`](https://github.com/DEFRA/water-abstraction-service/commit/93928ecb179077c725d8b33007500078a52449a8)
- Remove commented code [`6b15245`](https://github.com/DEFRA/water-abstraction-service/commit/6b152455251d98cccfbfae9f3add866ef32eb3a6)
- Removes function that is no longer useful for fetching a signed URL [`fe0324c`](https://github.com/DEFRA/water-abstraction-service/commit/fe0324c41bb0767c70f4ce5e96b2b3a74b050e37)
- Changes following Peer Review 2 [`3ee7c6c`](https://github.com/DEFRA/water-abstraction-service/commit/3ee7c6cb3a3bad86743d8d9ec7a65fb4632676a8)
- bugfiix/charge-element-test-data-fix [`1da03a0`](https://github.com/DEFRA/water-abstraction-service/commit/1da03a0ea9c99502b24f5b7892fc1734e7527bad)
- bugfiix/charge-element-test-data-fix [`6e35263`](https://github.com/DEFRA/water-abstraction-service/commit/6e3526399e8f56aa7ecbb97bcf23af8ee2b1f1d5)
- bugfiix/charge-element-test-data-fix [`a371fba`](https://github.com/DEFRA/water-abstraction-service/commit/a371fbaa178a51618621da5b4cfa42f4b91f7b47)
- bugfiix/charge-element-test-data-fix [`4148850`](https://github.com/DEFRA/water-abstraction-service/commit/41488505e955ddc067a5a03c329ecf61e63b18eb)
- bugfiix/charge-element-test-data-fix [`75815bb`](https://github.com/DEFRA/water-abstraction-service/commit/75815bbb35dfcf2c0771a6b69b15c7b55c05fa16)
- Include current month in totals [`d030e32`](https://github.com/DEFRA/water-abstraction-service/commit/d030e32dacfaee8671ca46b445a180599f9ef3ca)
- Tweak mappers [`707781e`](https://github.com/DEFRA/water-abstraction-service/commit/707781ebcaa28b8fafca8bde46892e939924c1c0)
- Update reporting port to 8010 [`73b28f7`](https://github.com/DEFRA/water-abstraction-service/commit/73b28f73c7ca2d18b42d8ea69b20aa9326b1f8c9)
- Re-run CI [`c039c65`](https://github.com/DEFRA/water-abstraction-service/commit/c039c655d7260406169b1894ac3fc6dea9e50a9a)
- Tweak API response naming [`cf2f8f7`](https://github.com/DEFRA/water-abstraction-service/commit/cf2f8f79beb1ced83159381d940b01d3c7a0de1e)

#### [v1.72.1](https://github.com/DEFRA/water-abstraction-service/compare/v1.71.0...v1.72.1)

> 14 April 2021

- Bugfix/water 3126 zero billable day transactions [`#1354`](https://github.com/DEFRA/water-abstraction-service/pull/1354)
- Feat: Auth and Billable days set to 0 for TPT supplementary transactions [`#1349`](https://github.com/DEFRA/water-abstraction-service/pull/1349)
- bugfix - Charge element model annual quantity set to not nullable [`#1352`](https://github.com/DEFRA/water-abstraction-service/pull/1352)
- Do TPT matching tasks in series to prevent flooding DB/returns service [`#1350`](https://github.com/DEFRA/water-abstraction-service/pull/1350)
- Water-3070 Charge version workflow tweaks [`#1339`](https://github.com/DEFRA/water-abstraction-service/pull/1339)
- Feat: Endpoint for flagging invoices for rebilling [`#1347`](https://github.com/DEFRA/water-abstraction-service/pull/1347)
- Release/wrls sprint 43 [`#1345`](https://github.com/DEFRA/water-abstraction-service/pull/1345)
- 1.71.0 [`#1346`](https://github.com/DEFRA/water-abstraction-service/pull/1346)
- Update transaction.js [`#1344`](https://github.com/DEFRA/water-abstraction-service/pull/1344)
- Feat: Flag invoice for re-billing [`0a27bb4`](https://github.com/DEFRA/water-abstraction-service/commit/0a27bb45f2b38aa60db5d48498f509dc795ea81c)
- Add failing test cases [`9fc1c44`](https://github.com/DEFRA/water-abstraction-service/commit/9fc1c44db1532b8b9e29bda88519d7c8a9bb2abe)
- Reporting changes to fetch report from stream [`4c17fa1`](https://github.com/DEFRA/water-abstraction-service/commit/4c17fa120809ee69a48a9ee2a913bbee280ce9b1)
- feat/water-3070 [`ea37f38`](https://github.com/DEFRA/water-abstraction-service/commit/ea37f38dd85f600626bbd2e7d32913dd5e4294b9)
- Makes isFlaggedForRebilling required for PATCH invoice endpoint [`fc10215`](https://github.com/DEFRA/water-abstraction-service/commit/fc10215cbe7ccef72d8c38ef80d16d22e10e5bac)
- Update mappers.js [`470e5b9`](https://github.com/DEFRA/water-abstraction-service/commit/470e5b9726c4824cf96f73e3874a1002c6f80a3d)
- Update test file with valid report name [`7cd1154`](https://github.com/DEFRA/water-abstraction-service/commit/7cd115476277a0c12ffaad7a5e6fbc67cbb67735)
- Fixes SonarCloud issues [`3123ab0`](https://github.com/DEFRA/water-abstraction-service/commit/3123ab0801fd8644d58744294753bee45d7556c3)
- Filter standard/compensation charges with 0 billable days in charge processor [`6764033`](https://github.com/DEFRA/water-abstraction-service/commit/67640333f0aba422d0a0c0ac01ca4c87a83a0e77)
- Minor code smell [`f81f06b`](https://github.com/DEFRA/water-abstraction-service/commit/f81f06b3c04e320c080d29910840712958fb314c)
- Update controller.js [`1d7ce0d`](https://github.com/DEFRA/water-abstraction-service/commit/1d7ce0d0dc1780d8649c3934c9a2182e40954459)
- bugfix/ce-annual-qty [`cf04a13`](https://github.com/DEFRA/water-abstraction-service/commit/cf04a134f6ad965074f19f5ef2acb34b93206bc7)
- Fixes linter error [`ef04f0c`](https://github.com/DEFRA/water-abstraction-service/commit/ef04f0c82122d02e34ce7e72882f4796d9538c22)

#### [v1.71.0](https://github.com/DEFRA/water-abstraction-service/compare/v1.70.0...v1.71.0)

> 1 April 2021

- Bugfix/min charge cm transactions [`#1343`](https://github.com/DEFRA/water-abstraction-service/pull/1343)
- Feat/water 3092 bull graceful shutdown [`#1342`](https://github.com/DEFRA/water-abstraction-service/pull/1342)
- Feat: Get invoices for a billing account  [`#1340`](https://github.com/DEFRA/water-abstraction-service/pull/1340)
- Bugfix/water 3097 nald tpt supplementary [`#1338`](https://github.com/DEFRA/water-abstraction-service/pull/1338)
- Removes a circular reference preventing integration test tear down from working [`#1337`](https://github.com/DEFRA/water-abstraction-service/pull/1337)
- Feat: Stores isFactorsOverridden flag when creating new charge element [`#1335`](https://github.com/DEFRA/water-abstraction-service/pull/1335)
- Fix issue with invoice net total validation/mapping [`#1336`](https://github.com/DEFRA/water-abstraction-service/pull/1336)
- Fix: Updates Bills tab [`#1329`](https://github.com/DEFRA/water-abstraction-service/pull/1329)
- Scaling back following discussion with Alan/James [`#1333`](https://github.com/DEFRA/water-abstraction-service/pull/1333)
- Feat/water 3038 [`#1331`](https://github.com/DEFRA/water-abstraction-service/pull/1331)
- Revert "Set is_two_part_tariff to true for 390 - anti-frost storage" [`#1332`](https://github.com/DEFRA/water-abstraction-service/pull/1332)
- Feat/water 2989 return cycles report [`#1328`](https://github.com/DEFRA/water-abstraction-service/pull/1328)
- Add migration to set is_two_part_tariff to true for 390 - anti-frost storage purpose use [`#1330`](https://github.com/DEFRA/water-abstraction-service/pull/1330)
- Hotfix/water 2242 [`#1327`](https://github.com/DEFRA/water-abstraction-service/pull/1327)
- Stop using `match` service in EA address facade [`#1324`](https://github.com/DEFRA/water-abstraction-service/pull/1324)
- Bugfix 1 of many for CMV2 migration [`#1326`](https://github.com/DEFRA/water-abstraction-service/pull/1326)
- Changes needed to migrate to using v2 of the Charging Module [`#1325`](https://github.com/DEFRA/water-abstraction-service/pull/1325)
- Water - 3020 - external returns regression tests [`#1323`](https://github.com/DEFRA/water-abstraction-service/pull/1323)
- Feat: Adds non-chargeable reason for licence revoked a month after annual billing [`#1314`](https://github.com/DEFRA/water-abstraction-service/pull/1314)
- Fix issue where test regions not torn down in acceptance test endpoint [`#1322`](https://github.com/DEFRA/water-abstraction-service/pull/1322)
- Fixes issues with integration tests due to recent changes [`#1321`](https://github.com/DEFRA/water-abstraction-service/pull/1321)
- Release/wrls sprint 41 [`#1320`](https://github.com/DEFRA/water-abstraction-service/pull/1320)
- Fix issue with TPT transactions in supplementary [`#1319`](https://github.com/DEFRA/water-abstraction-service/pull/1319)
- Fix issue with TPT transactions in supplementary [`#1312`](https://github.com/DEFRA/water-abstraction-service/pull/1312)
- bugfix -- water-3001 patch charge version workflow if it exists [`#1315`](https://github.com/DEFRA/water-abstraction-service/pull/1315)
- Duplicating Stephan's changes into develop branch [`#1318`](https://github.com/DEFRA/water-abstraction-service/pull/1318)
- Fix: Makes approving billing volumes not required [`#1313`](https://github.com/DEFRA/water-abstraction-service/pull/1313)
- Bugfix/water 3001 duplicate charge version workflows [`#1311`](https://github.com/DEFRA/water-abstraction-service/pull/1311)
- Feat/water 2242 notifications endpoint [`#1306`](https://github.com/DEFRA/water-abstraction-service/pull/1306)
- Bugfix for water-3001 duplicate charge version workflow jobs [`#1307`](https://github.com/DEFRA/water-abstraction-service/pull/1307)
- Feat: Prioritise unsupported source in tpt matching [`#1308`](https://github.com/DEFRA/water-abstraction-service/pull/1308)
- Adds env variable option for nald switchover date [`#1304`](https://github.com/DEFRA/water-abstraction-service/pull/1304)
- Feat/water 3002 delete charge info workflows [`#1305`](https://github.com/DEFRA/water-abstraction-service/pull/1305)
- Feat: Delete charge info workflows [`#1302`](https://github.com/DEFRA/water-abstraction-service/pull/1302)
- Ensure deleted charge version workflows accounted for in supplementary billing [`#1303`](https://github.com/DEFRA/water-abstraction-service/pull/1303)
- Reorganises billing route and controller files [`8b55f9b`](https://github.com/DEFRA/water-abstraction-service/commit/8b55f9b21adbebb36a337be1f4434bc90e2b03ec)
- Fix 3056 TPT supplementary issue in release branch [`d10b5d8`](https://github.com/DEFRA/water-abstraction-service/commit/d10b5d80366e77ca17c6bed9fecdd299c885ae93)
- Fix annual integration tests AB1 and AB2 [`13efe21`](https://github.com/DEFRA/water-abstraction-service/commit/13efe213cd811a4806413abef7c7f656b80f5a81)
- Simplify charge version service, ensure that each transaction type is only inserted once per charge version/type/fin year/season [`6141112`](https://github.com/DEFRA/water-abstraction-service/commit/61411123248a4ac9ce78ae218cf06a6e7d710fd6)
- bugfix/water-3001 [`986cd00`](https://github.com/DEFRA/water-abstraction-service/commit/986cd0064377385a276809232a1853d4b9ce7682)
- Fix notify and barebones test data setup [`90e0d49`](https://github.com/DEFRA/water-abstraction-service/commit/90e0d49fe3e94259e29557f5a554d52b0e531bad)
- Adds test data to enable regression tests on charge version workflows. [`9bf1aec`](https://github.com/DEFRA/water-abstraction-service/commit/9bf1aec52b9f331ed92dc28a5465030d4e3b2e8d)
- WIP [`900b6d8`](https://github.com/DEFRA/water-abstraction-service/commit/900b6d8f701b04e63cd15e2ea433a1cb59c0ce93)
- Fix code smell, additional test case [`827b1ab`](https://github.com/DEFRA/water-abstraction-service/commit/827b1ab988d0659156b7c483b13d8ac8b8fe6946)
- Extend the model and mappers [`94f4ec4`](https://github.com/DEFRA/water-abstraction-service/commit/94f4ec40dece989ddb339ad2613e7226595bfaad)
- Cache invoice external ID [`3672c07`](https://github.com/DEFRA/water-abstraction-service/commit/3672c077b0c23896addf4a74b38bfdb63d2d48f6)
- feat/water-3020 [`a1aba3f`](https://github.com/DEFRA/water-abstraction-service/commit/a1aba3fa4c415690b311836d782255b92d029e63)
- Restores broken transaction tests in the form of commented code as James requested. Ignore the code smell please [`dea3751`](https://github.com/DEFRA/water-abstraction-service/commit/dea3751dafc4b9f294c4cad40172a0e92739839f)
- Removes unnecessary migration as suggested by James [`44c7b24`](https://github.com/DEFRA/water-abstraction-service/commit/44c7b24f3fa676118651084a22eac0d12b9c7571)
- Removes defunct tests [`7abf2df`](https://github.com/DEFRA/water-abstraction-service/commit/7abf2dfbafbcfaf074e092f895bed4da2b8b8eda)
- Changes to map CM v2 data shape to WRLS expectations [`94ed9fe`](https://github.com/DEFRA/water-abstraction-service/commit/94ed9fe3ece79334033f967f7c9bb51229706a20)
- Adds hard delete when a charge version is created from a workflow [`25216f1`](https://github.com/DEFRA/water-abstraction-service/commit/25216f1ae5f631fe90011ddc07860f18424b1c20)
- feat/water-3070 [`c3c8de6`](https://github.com/DEFRA/water-abstraction-service/commit/c3c8de63d3e49f52209298ecc442c299baa006b6)
- Add `generating` as a valid batch status to support CMv2 [`6820c18`](https://github.com/DEFRA/water-abstraction-service/commit/6820c188d9f1e9527302ca3422ecc75f25b15f5e)
- Updates route definitions to match new Hapi version requirements [`22af63e`](https://github.com/DEFRA/water-abstraction-service/commit/22af63eaade85ae45cb63d17b577caa07f0f6d98)
- Removes redudant licence methods. Tweaks charge version workflow methods to work with new model set up. [`41ca64c`](https://github.com/DEFRA/water-abstraction-service/commit/41ca64c8fce253d5cbbf37a34eceb88e384d95eb)
- Migration [`4d6a4bf`](https://github.com/DEFRA/water-abstraction-service/commit/4d6a4bf6e0dc0ef73eedfca86b46f45f13632daf)
- Fixes *some* of the broken tests [`cf9795f`](https://github.com/DEFRA/water-abstraction-service/commit/cf9795fd2e4817edc17549db35e7efae101083e5)
- Removes transactions from integration test pack as endpoint is not available in CMv2 (yet?) [`0f43ea0`](https://github.com/DEFRA/water-abstraction-service/commit/0f43ea07a46e42a54a327c960ddaa09867f0b00b)
- Revert "Add migration to set is_two_part_tariff to true for 390 - anti-frost storage purpose use (#1330)" [`e652e7b`](https://github.com/DEFRA/water-abstraction-service/commit/e652e7b9b1c6a38df905250fc98c4082a04649ca)
- Add graceful shutdown of Bull MQ jobs [`664ffda`](https://github.com/DEFRA/water-abstraction-service/commit/664ffda4a4337513e9f6b6e2c62717eb06bd69ac)
- bugfix/water-3001 [`460c061`](https://github.com/DEFRA/water-abstraction-service/commit/460c0616f094a00e09d2ad9a6110440e5e4f2a69)
- feat/water-3070 [`3b8556a`](https://github.com/DEFRA/water-abstraction-service/commit/3b8556af24b8f8c27ddd7d48f7cf2b6e297570bc)
- Fix supplementary tests [`3a6d7bd`](https://github.com/DEFRA/water-abstraction-service/commit/3a6d7bd4ce7b4853d44b6a581eacc76e7e880ead)
- Adds migrations to add rebilling flag to water.billing_invoices [`1c76ad3`](https://github.com/DEFRA/water-abstraction-service/commit/1c76ad33f41e4db317fc114c6b86f20d806bc87c)
- feat/,water-3070 [`3f86bd3`](https://github.com/DEFRA/water-abstraction-service/commit/3f86bd3cb0e1b26d776e68c044d7f5e9a150a9b7)
- Moves batch related test files [`979b2c4`](https://github.com/DEFRA/water-abstraction-service/commit/979b2c45abe2ef1e1d7a07e2ea5a741104226c2f)
- Fix broken tests [`23fa7e3`](https://github.com/DEFRA/water-abstraction-service/commit/23fa7e33433c2ece5d4cf42d90688d0f3cbb2601)
- Removes unused endpoints [`8fe53c1`](https://github.com/DEFRA/water-abstraction-service/commit/8fe53c1d5cffc71f3ec7e3673244ae5dcecfb34e)
- Add tests [`9e92d31`](https://github.com/DEFRA/water-abstraction-service/commit/9e92d3188f84ac9e2fdfda7d87f90a0409854c07)
- Removed unnecessary mapper code as suggested by James [`9db6923`](https://github.com/DEFRA/water-abstraction-service/commit/9db69235a6be544cd6349d99141dac2517e19a05)
- WIP [`d87cef9`](https://github.com/DEFRA/water-abstraction-service/commit/d87cef9bf55703cb1fc07fbf59e015bc95315d73)
- Fix integration test suite [`257b6ea`](https://github.com/DEFRA/water-abstraction-service/commit/257b6eaedcb3f1f53418aa099e13e1451d330575)
- Adds isFlaggedForRebilling flag to invoice model and mapper [`f3c0ea4`](https://github.com/DEFRA/water-abstraction-service/commit/f3c0ea4ecea208186b9d0076d234ae4a93e92211)
- bugfix/water-3001 [`47f3b1a`](https://github.com/DEFRA/water-abstraction-service/commit/47f3b1a1e6fe8a4718cd249fff7ccf205ce4f62c)
- Adds missing [new] parameters to the test file [`6656ddf`](https://github.com/DEFRA/water-abstraction-service/commit/6656ddff119da48264152394bb948ebfbffb63a4)
- Assess batch readiness using new states (Pending instead of sent) [`4834b40`](https://github.com/DEFRA/water-abstraction-service/commit/4834b40dbd67d1f0e779982fe11422d535bef523)
- Ensure scheduled notifications are deleted in tear down phase relating to test events [`65f170a`](https://github.com/DEFRA/water-abstraction-service/commit/65f170aae616924afc5d21b79333b99bdd1be371)
- Revert "Merge branch 'develop' into bugfix/water-3001-duplicate-charge-version-workflows" [`4057db5`](https://github.com/DEFRA/water-abstraction-service/commit/4057db51904e892043614ca612d468d73ed618b3)
- Reducing repition by deconstructing cmTransaction.calculation.WRLSChargingResponse as suggested by James [`b8a283f`](https://github.com/DEFRA/water-abstraction-service/commit/b8a283f55012b2caf6a438388a66ac45d2847e95)
- Fix tests/lint [`fd48e47`](https://github.com/DEFRA/water-abstraction-service/commit/fd48e47f8439a4ee73fd763ab18088e7e8eef84e)
- Changed names of validators as advised by Stephan in peer review [`9a32002`](https://github.com/DEFRA/water-abstraction-service/commit/9a32002657067d0e9c4ad5a7766f419e0a9f00e7)
- Broken tests [`cf1112a`](https://github.com/DEFRA/water-abstraction-service/commit/cf1112a19a30452dff94ebd69483939dc9b36f84)
- Update 20210322162609-add-generating-to-batch-status-enum-up.sql [`f01c216`](https://github.com/DEFRA/water-abstraction-service/commit/f01c2169bcb2cd7c631687343c7b8764be76479a)
- feat/water-3070 [`7663fda`](https://github.com/DEFRA/water-abstraction-service/commit/7663fda812d132e4ba0c9a98bd39a372ee7e9b68)
- FIx issue with charge version workflow fixtures [`e9138cc`](https://github.com/DEFRA/water-abstraction-service/commit/e9138ccc733d066310b899c19951f4c7ae56ff73)
- Ping /generate endpoint after adding transactions [`130f1f3`](https://github.com/DEFRA/water-abstraction-service/commit/130f1f3e1679f0e07c5a0fd32bbe0f0a6fdc40eb)
- Fix broken test relating to credit sign [`5fd7559`](https://github.com/DEFRA/water-abstraction-service/commit/5fd75595a96924effb745afb3425e789d059da0d)
- Correct minor typo [`ee0422c`](https://github.com/DEFRA/water-abstraction-service/commit/ee0422c66f170a20f9687ffac1055480019b5675)
- Removes unwanted status types as requested by James [`694263c`](https://github.com/DEFRA/water-abstraction-service/commit/694263c9ff457a27c709be225aee80523eb587f9)
- Testing a theory of sorts [`2c970fc`](https://github.com/DEFRA/water-abstraction-service/commit/2c970fc2d2c002728c1fefe92ca093aa02a312aa)
- WIP [`ab977af`](https://github.com/DEFRA/water-abstraction-service/commit/ab977af6b91308f45fd5a8a6eb4904ae94b91ea6)
- Linting [`ccbb74d`](https://github.com/DEFRA/water-abstraction-service/commit/ccbb74de1fbf023c38df3968bdbf206386cb71d2)
- Removed 'generating' and changed test to look for a status of 'sent' as advised by James in peer review [`6275098`](https://github.com/DEFRA/water-abstraction-service/commit/62750981bbbbfa52f643d7bae4f3fcf01ee8cd0d)
- Removing three code smells [`be8866a`](https://github.com/DEFRA/water-abstraction-service/commit/be8866ad4a354d70da8cffea94a504bf7f1118ed)
- bugfix/water3001-patch-workflow-if-exist [`7c080c7`](https://github.com/DEFRA/water-abstraction-service/commit/7c080c7b5ccae0a3785dc6107395ff31c98d690a)
- /send [`ccea327`](https://github.com/DEFRA/water-abstraction-service/commit/ccea327aa0259fa90fbe9df7799daa296d7c11fd)
- Fixes broken tests due to variable name change [`287bc62`](https://github.com/DEFRA/water-abstraction-service/commit/287bc62e68b6e9cd01e2279cf330967ce2d9ed43)
- feat/water-3070 [`bda93fc`](https://github.com/DEFRA/water-abstraction-service/commit/bda93fcc29818e0094b7f24e1c7228e03e850901)
- Revert "Fixes recent change in CM API" [`3682e1c`](https://github.com/DEFRA/water-abstraction-service/commit/3682e1ce10eef7402a3315b2ba2c8715bdc587dc)
- Call invoices in series to reduce CMv2 load [`81e36d2`](https://github.com/DEFRA/water-abstraction-service/commit/81e36d2b5e4405c451628d4b26250bd60dd1fdb5)
- Fixes recent change in CM API [`07e8b9c`](https://github.com/DEFRA/water-abstraction-service/commit/07e8b9c3642d57e4e072a0d7f49c1cc6e25f5963)
- Fix lint issue [`a108520`](https://github.com/DEFRA/water-abstraction-service/commit/a1085205f493f1f771fc7be2b572f8690040ebc3)
- Remove outdated endpoint [`6d1e9a0`](https://github.com/DEFRA/water-abstraction-service/commit/6d1e9a06adbb37771a8c50e05c7d2e3d0fe424bb)
- Fix minor code smells [`fef7be4`](https://github.com/DEFRA/water-abstraction-service/commit/fef7be40cb0ffffdf4e99b1989841931b587bd07)
- Change delete bill run endpoint [`17024c4`](https://github.com/DEFRA/water-abstraction-service/commit/17024c4f36dafd1f4a52fadd976c1ed9c90fb458)
- Remove comment [`3054d68`](https://github.com/DEFRA/water-abstraction-service/commit/3054d68526d4eabc7f90f2c98d892bfb1497d67a)
- bugfix/water-3001 [`c388e00`](https://github.com/DEFRA/water-abstraction-service/commit/c388e003d27315271dd0855fb064444bb934db1b)
- bugfix/water-3001 [`acb84e3`](https://github.com/DEFRA/water-abstraction-service/commit/acb84e3482942ed2ef1d6324808646e8b4110c6d)
- Credit note polarity change as CM v2 returns positive credit notes [`8a513a0`](https://github.com/DEFRA/water-abstraction-service/commit/8a513a0f011371c0e2d640d0c090b6070f341943)
- Update transaction.js [`8869005`](https://github.com/DEFRA/water-abstraction-service/commit/8869005149e137e526eaef265fb3ce97c2637b55)
- Bugfix 1 of 23849729384 [`54d8f99`](https://github.com/DEFRA/water-abstraction-service/commit/54d8f9929675ed4503e059962976c1b5cf4322fa)
- Linter: Unused import [`21af7ff`](https://github.com/DEFRA/water-abstraction-service/commit/21af7ff048294e6eb590da2ecc95c3bef426ccaf)
- Revert "Adds env variable option for nald switchover date (#1304)" [`c169090`](https://github.com/DEFRA/water-abstraction-service/commit/c16909044fc99c152f3c878daf764a17ab1b49f6)
- bugfix/water-3001 [`8c92bf9`](https://github.com/DEFRA/water-abstraction-service/commit/8c92bf978b326bfe1e71e54e35ec1229fca6698e)
- Adjust expiry to 45 seconds as requested by Kaushal [`192784c`](https://github.com/DEFRA/water-abstraction-service/commit/192784cabdf6c4a94a27e6d6569db658a1c99c4f)
- Removes console logs [`156c15d`](https://github.com/DEFRA/water-abstraction-service/commit/156c15dfdb51fb0acb34f560fe2e797be7a757e3)
- Removed an accidental console.log [`6cfcdbd`](https://github.com/DEFRA/water-abstraction-service/commit/6cfcdbdf57f31184fcd8d4985be0787ec7c0469d)
- Pings the approve endpoint [`55498e6`](https://github.com/DEFRA/water-abstraction-service/commit/55498e6abc36d23cac391304fd9c20b258bc88e1)

#### [v1.70.0](https://github.com/DEFRA/water-abstraction-service/compare/v1.61.0...v1.70.0)

> 3 March 2021

- Fix supplementary billing to cope with imported NALD transactions [`#1298`](https://github.com/DEFRA/water-abstraction-service/pull/1298)
- Add batch source property [`#1301`](https://github.com/DEFRA/water-abstraction-service/pull/1301)
- Feat/water-3001 Cron job for adding charge version workflows [`#1299`](https://github.com/DEFRA/water-abstraction-service/pull/1299)
- Add missing await in CM refresh service [`#1300`](https://github.com/DEFRA/water-abstraction-service/pull/1300)
- Stricter return line date validation for CSV upload [`#1296`](https://github.com/DEFRA/water-abstraction-service/pull/1296)
- Feat/water 3021 test data setup endpoint [`#1295`](https://github.com/DEFRA/water-abstraction-service/pull/1295)
- Feat/water 3016 persist transactions [`#1293`](https://github.com/DEFRA/water-abstraction-service/pull/1293)
- Adds new minimum charge rule [`#1294`](https://github.com/DEFRA/water-abstraction-service/pull/1294)
- Fix unit conversion issue converting licence purpose to charge element [`#1297`](https://github.com/DEFRA/water-abstraction-service/pull/1297)
- Returns requirements data added to acceptance tests data setup [`#1282`](https://github.com/DEFRA/water-abstraction-service/pull/1282)
- Bugfix/water 2998 supplementary after tpt billing volume bug [`#1292`](https://github.com/DEFRA/water-abstraction-service/pull/1292)
- Bugfix: Billing volumes volume rounding error [`#1291`](https://github.com/DEFRA/water-abstraction-service/pull/1291)
- Feat: Batch data download endpoint [`#1290`](https://github.com/DEFRA/water-abstraction-service/pull/1290)
- Feat/water 2861 notify callbacks [`#1286`](https://github.com/DEFRA/water-abstraction-service/pull/1286)
- Fix issue with billing invoice constraints [`#1285`](https://github.com/DEFRA/water-abstraction-service/pull/1285)
- Fixes constraint when upserting billing invoice [`#1284`](https://github.com/DEFRA/water-abstraction-service/pull/1284)
- Fix: Call CM multiple times for paginated transaction results [`#1283`](https://github.com/DEFRA/water-abstraction-service/pull/1283)
- Add additional columns/constraints for import of bill run headers  [`#1281`](https://github.com/DEFRA/water-abstraction-service/pull/1281)
- New supplementary billing process to cope with imported NALD transactions [`21343ef`](https://github.com/DEFRA/water-abstraction-service/commit/21343ef2624a2504928fa152557856c606024647)
- Fix broken tests/lint errors [`75044df`](https://github.com/DEFRA/water-abstraction-service/commit/75044df2a327d62a94df1283ca89e33933a855a2)
- Split supplementary processing so that the core processing is a pure function and management of the data in the DB is a separate service [`b25fbbd`](https://github.com/DEFRA/water-abstraction-service/commit/b25fbbd80230b7c7dcc858cf18cab04e2a3cecea)
- Additional tests.  Remove min charge flag from supplementary grouping key for NALD transactions [`1cddd53`](https://github.com/DEFRA/water-abstraction-service/commit/1cddd5329760b8f08508681d8b50494869f3d715)
- feat/water-2941 [`0912254`](https://github.com/DEFRA/water-abstraction-service/commit/091225441c1a56d167c40753c53f847dc3166586)
- Add tests for supplementary processor [`93aae34`](https://github.com/DEFRA/water-abstraction-service/commit/93aae34f07b47477273d1b27796b7988e9e7f9b6)
- Creates new batch download data route [`ef422ab`](https://github.com/DEFRA/water-abstraction-service/commit/ef422ab362a451d7f1f486ffdba020619b701bf2)
- feat/water-2941 [`9a1e15d`](https://github.com/DEFRA/water-abstraction-service/commit/9a1e15dc345793cc1ab38a4f988565d90e4958ea)
- Reduces CM transaction calls [`54e1e16`](https://github.com/DEFRA/water-abstraction-service/commit/54e1e167e9fd90122f13375586853a09099050b8)
- Fix issues with incorrect charge period dates by reversing previous transactions rather than editing transactions from current batch [`8f549b5`](https://github.com/DEFRA/water-abstraction-service/commit/8f549b58178294c8c47c71acc30a655c87be65c6)
- Updates charge module decorators to handle cm Transactions [`4d335c6`](https://github.com/DEFRA/water-abstraction-service/commit/4d335c6ea3cacbf2622f97a56fc367f30bc735b6)
- Adds nald switch over date and applies it when creating transactions [`f501a7b`](https://github.com/DEFRA/water-abstraction-service/commit/f501a7bdc03b2efc88b06004f8345bf46adcc20c)
- Review comments [`4067cd4`](https://github.com/DEFRA/water-abstraction-service/commit/4067cd4df20e9361b2602b210644faee2dab8c37)
- Additional tests [`63ba363`](https://github.com/DEFRA/water-abstraction-service/commit/63ba36345292a561a5036a4170f0234d6321bc4e)
- Remove code to create hashed transaction keys [`0ee89e2`](https://github.com/DEFRA/water-abstraction-service/commit/0ee89e23b91b590fc01ba9805bb5c88235e1d9ad)
- Skip TPT matching where approved billing volumes exist for CV/fin year/season [`6339c1c`](https://github.com/DEFRA/water-abstraction-service/commit/6339c1c4d210c02520219a6e8cbefb2564ad9c1f)
- feat-water-2941 [`51344e4`](https://github.com/DEFRA/water-abstraction-service/commit/51344e4eeb62c5e3534c363a786d3a98ef2e2444)
- Update ScheduledNotification model to pass notify_id as notifyId [`5feeb9c`](https://github.com/DEFRA/water-abstraction-service/commit/5feeb9c8a212fe31d0ea0304565d8b8089b3305b)
- Changes to acceptance endpoint to set up a fake notification [`be757c5`](https://github.com/DEFRA/water-abstraction-service/commit/be757c5878637427141e44531fc52b49117f09ff)
- Updates minimum charge criteria. [`362c1a2`](https://github.com/DEFRA/water-abstraction-service/commit/362c1a20647d1f9688b815c921a74fbdd89440d9)
- Fix code smells [`88a25a4`](https://github.com/DEFRA/water-abstraction-service/commit/88a25a4d6a90a0c64e9109cf854da3ce5a811b13)
- Update tests to include UUID-formatted IDs [`033018a`](https://github.com/DEFRA/water-abstraction-service/commit/033018aff798a696cad8e4913daa7c4fd4028fbd)
- Additional tests [`1d8cdf2`](https://github.com/DEFRA/water-abstraction-service/commit/1d8cdf28f45d101a751850b9402bb9ccf5905698)
- Add charge version id to charge element [`3f67f59`](https://github.com/DEFRA/water-abstraction-service/commit/3f67f59f004bd199df12c88dd86979824f9ddd2a)
- Bug fixes [`77046f6`](https://github.com/DEFRA/water-abstraction-service/commit/77046f6b7c8acf4de68e6fd4d01ec1df2323a0b1)
- feat/water-2941 [`c7fe18b`](https://github.com/DEFRA/water-abstraction-service/commit/c7fe18b54a3c5cba4926214dcdf939052d6a1ce8)
- Increase code coverage [`a300fd8`](https://github.com/DEFRA/water-abstraction-service/commit/a300fd8cde57e4c5b20ccaaa1ed90a612e8a5009)
- Increase code coverage [`3ce4489`](https://github.com/DEFRA/water-abstraction-service/commit/3ce448927fe35d2954cd83697505e3ae71682f25)
- Pass URL to frontend [`c5c69cb`](https://github.com/DEFRA/water-abstraction-service/commit/c5c69cb596cb9782f8b885a0473ac994c06acba2)
- Initial changes to generate a bill run + update customer record [`1cc8032`](https://github.com/DEFRA/water-abstraction-service/commit/1cc8032b0d193fe47c5230e38ec3e3660590a06a)
- Update test to match latest change [`4bed3e3`](https://github.com/DEFRA/water-abstraction-service/commit/4bed3e35ea4f17f890fd9c69a423d06224705c2f)
- Fix broken test [`66e132f`](https://github.com/DEFRA/water-abstraction-service/commit/66e132fe4465b6aef63d6f5a2eff21d82fcae3b4)
- Updates batch status to sent after invoice numbers are persisted [`2cbb0d9`](https://github.com/DEFRA/water-abstraction-service/commit/2cbb0d9fb71f74fb58439474c76fbcf669e47da4)
- feat/water-2941 [`688b56d`](https://github.com/DEFRA/water-abstraction-service/commit/688b56dedd92a042e26584708e21037ae29d249a)
- feat/water-2941 [`5040083`](https://github.com/DEFRA/water-abstraction-service/commit/504008344ae232236e2fbc65791e607e3ab6fa80)
- Update Tests [`bee1809`](https://github.com/DEFRA/water-abstraction-service/commit/bee180913c9f21a8bfa74259c4ada8ae9e5aebf9)
- Fixes SonarCloud issues [`1f792fa`](https://github.com/DEFRA/water-abstraction-service/commit/1f792fafe33ec9d991e8b3435938e86dc3dfa5ab)
- Sets batch status to processing on approval [`a545093`](https://github.com/DEFRA/water-abstraction-service/commit/a545093a4818b7e6ca1cd06930fde977f9c06d05)
- Fix code smell [`77d26ae`](https://github.com/DEFRA/water-abstraction-service/commit/77d26aeb72e7d71409005b828f9fa49f556a0e8c)
- Fixes SonarCloud issues [`05639b8`](https://github.com/DEFRA/water-abstraction-service/commit/05639b842cd56b8b204adef0c60c9a6c4c745909)
- Linter [`2789383`](https://github.com/DEFRA/water-abstraction-service/commit/2789383af824bb8f98c461a623928dcaddf3722c)
- Tweak required to skip row if billing volumes array is blanked [`9546740`](https://github.com/DEFRA/water-abstraction-service/commit/95467401896f3a433c1438ff3d7eae08c1a410d3)
- Fix migration [`f95fbfb`](https://github.com/DEFRA/water-abstraction-service/commit/f95fbfb754d8e5360a774b53632c86d3d1bdbe4a)
- Work around for CMv2 being unable to deal with DB row clash [`554daef`](https://github.com/DEFRA/water-abstraction-service/commit/554daef098e5c2aadfd3dff81ce9e505bbf7bb0d)
- Update bill-runs.js [`4e84c61`](https://github.com/DEFRA/water-abstraction-service/commit/4e84c617b6669e72e84f89c3993e04a4213058ba)
- Fixes linter error [`be8ff0a`](https://github.com/DEFRA/water-abstraction-service/commit/be8ff0ac50516d3314df3a390555c24c22001f33)
- rebase [`346a822`](https://github.com/DEFRA/water-abstraction-service/commit/346a822c605af8ed42ba5ad010b7099b9d16300b)
- feat/water-2941 [`a2f3676`](https://github.com/DEFRA/water-abstraction-service/commit/a2f367678344a6a0b6f16bee27eaa77c6da12c1b)
- Developer error! 🤦🏽‍♂️ [`d05a9ec`](https://github.com/DEFRA/water-abstraction-service/commit/d05a9ec83f73b368902701c409f027f9076cd6d2)
- Remove a console log that I accidentally left in [`ea58f73`](https://github.com/DEFRA/water-abstraction-service/commit/ea58f73b80ef1ada6b0a468f051fac6e36748c3d)

#### [v1.61.0](https://github.com/DEFRA/water-abstraction-service/compare/v1.60.0...v1.61.0)

> 4 February 2021

- Split invoice account creation / address into 2 separate endpoints [`#1275`](https://github.com/DEFRA/water-abstraction-service/pull/1275)
- Create migrations for billing batches table for NALD import [`#1280`](https://github.com/DEFRA/water-abstraction-service/pull/1280)
- Fix slow query fetching licences without charge versions [`#1279`](https://github.com/DEFRA/water-abstraction-service/pull/1279)
- Config.js tweak [`#1278`](https://github.com/DEFRA/water-abstraction-service/pull/1278)
- Tweak billing Bull MQ jobs to return less data and remove on complete… [`#1277`](https://github.com/DEFRA/water-abstraction-service/pull/1277)
- Feat/water 2746 TPT integration test (FORK) [`#1266`](https://github.com/DEFRA/water-abstraction-service/pull/1266)
- Release/charging sprint 39 [`#1276`](https://github.com/DEFRA/water-abstraction-service/pull/1276)
- Feat/water 2903 bills tab [`#1273`](https://github.com/DEFRA/water-abstraction-service/pull/1273)
- Bugfix: Marking billing volumes are errored not required. [`#1274`](https://github.com/DEFRA/water-abstraction-service/pull/1274)
- Feat/billing routes use scope [`#1272`](https://github.com/DEFRA/water-abstraction-service/pull/1272)
- Feat: Removes start date when finding licences without charge info [`#1271`](https://github.com/DEFRA/water-abstraction-service/pull/1271)
- feat/water-2941 [`a530c6a`](https://github.com/DEFRA/water-abstraction-service/commit/a530c6a8db29c328d169d1db5dff94433aa9a98b)
- feat/water-2941 [`8726e87`](https://github.com/DEFRA/water-abstraction-service/commit/8726e8757440acd2bb1a22da0e068d1890438153)
- Added Tests [`063b150`](https://github.com/DEFRA/water-abstraction-service/commit/063b150e394cbf7c3760da4ac15209a1056493cb)
- feat/water-2941 [`2559223`](https://github.com/DEFRA/water-abstraction-service/commit/25592235586a5ac895dbd5116fc08b03cfefca74)
- feat/water-2941 [`13c22f5`](https://github.com/DEFRA/water-abstraction-service/commit/13c22f567bdd9b54cdba9dfb4f67a6cdf8fb41d5)
- Added unit tests [`365ad42`](https://github.com/DEFRA/water-abstraction-service/commit/365ad428dfa27e21951a91da0b819a112c6b8627)
- Tweak billing Bull MQ jobs to return less data and remove on complete/fail [`595f9a8`](https://github.com/DEFRA/water-abstraction-service/commit/595f9a8bc29de0e3790e099b941266fc97996cc9)
- Fix tests [`ca22edc`](https://github.com/DEFRA/water-abstraction-service/commit/ca22edc8ade1c31945f656044ccf5ef7d57709c6)
- Update Bull [`bfc3382`](https://github.com/DEFRA/water-abstraction-service/commit/bfc33824ab050c83fe8f40fc5c8b6cc8146571ae)
- Febreezing [`917c18c`](https://github.com/DEFRA/water-abstraction-service/commit/917c18c760238c6ada5cb62f422db1b4ecc39ccd)
- Modify endpoint to use mappers [`fb4cc1c`](https://github.com/DEFRA/water-abstraction-service/commit/fb4cc1cef71e875d28d0d4cdfc0e9e352a3971ee)
- Tweak following PR [`3b2ebcd`](https://github.com/DEFRA/water-abstraction-service/commit/3b2ebcd98f92ca66de25b638b4fa99cb81ef5971)
- Plots invoice and batch objects in response, to avoid changing mapper files [`8f38888`](https://github.com/DEFRA/water-abstraction-service/commit/8f3888851853c1a6c60fedcca2b0d984d9f3102d)
- Update invoices.js [`3a597a7`](https://github.com/DEFRA/water-abstraction-service/commit/3a597a747a3b5d957d5a7e991c10dd950fad54e8)
- feat/water-2941 [`1319765`](https://github.com/DEFRA/water-abstraction-service/commit/13197653849ee18531e656e6b39a742e38a1e39e)
- feat/water-2941 [`032cb3c`](https://github.com/DEFRA/water-abstraction-service/commit/032cb3cd6982900d0a82c3adb24c086a2a4cde92)
- feat/water-2941 [`238de0e`](https://github.com/DEFRA/water-abstraction-service/commit/238de0e6c53c1dd780a4e25e72483171e43d77c3)
- test [`a7f2a00`](https://github.com/DEFRA/water-abstraction-service/commit/a7f2a00317d42c0a5fad9a8ae4852c0b9c8fbc65)
- Added config change as discussed with James [`133024e`](https://github.com/DEFRA/water-abstraction-service/commit/133024e078fcf1a5b244445f298fb9144e9ee2eb)
- Revert "Renaming two vars to remove a code smell" [`a4abcba`](https://github.com/DEFRA/water-abstraction-service/commit/a4abcba8e583c21f7ae622ad4a46154a43d77e1b)
- Renaming two vars to remove a code smell [`309e7c0`](https://github.com/DEFRA/water-abstraction-service/commit/309e7c0bf01142c97e8fce7e70d159a32ff21a0b)
- Adjust removeOnFail and fix code smell [`ef6874d`](https://github.com/DEFRA/water-abstraction-service/commit/ef6874d863c539bdd419ecbc93372f9df355b0ff)
- Code smell fix [`77ed0a8`](https://github.com/DEFRA/water-abstraction-service/commit/77ed0a8e8aef58c5e31ed186a7614f0c00b071e7)
- Remove unused relation from test [`9166d41`](https://github.com/DEFRA/water-abstraction-service/commit/9166d4184eea10d447ea114c22b77bb9ad191201)
- Remove unused relation [`6e652fa`](https://github.com/DEFRA/water-abstraction-service/commit/6e652fabee422deb4edc442b7d71754b14da868a)
- Update controller.js [`72a7307`](https://github.com/DEFRA/water-abstraction-service/commit/72a7307faa0e4e12725e63332f85aaac93989ca5)
- Removes unused const [`f816d7f`](https://github.com/DEFRA/water-abstraction-service/commit/f816d7fe33a729432b50bfea3590cdff2a5d2e33)
- Update invoice-licence.js [`e9b057b`](https://github.com/DEFRA/water-abstraction-service/commit/e9b057b7551b9f31b4dd8d6bf4ccc7d004ff750a)

#### [v1.60.0](https://github.com/DEFRA/water-abstraction-service/compare/v1.59.0...v1.60.0)

> 20 January 2021

- Feat: Bulk Upload Y/N fields accept Yes/No [`#1269`](https://github.com/DEFRA/water-abstraction-service/pull/1269)
- Feat: Store invoice numbers and totals when batch is sent [`#1262`](https://github.com/DEFRA/water-abstraction-service/pull/1262)
- Set authentication credentials in request.auth.credentials [`#1270`](https://github.com/DEFRA/water-abstraction-service/pull/1270)
- Feat/water 2964 company invoice accounts [`#1267`](https://github.com/DEFRA/water-abstraction-service/pull/1267)
- Fixes issue with KPI tests [`#1268`](https://github.com/DEFRA/water-abstraction-service/pull/1268)
- Release/charging sprint 38 [`#1265`](https://github.com/DEFRA/water-abstraction-service/pull/1265)
- Update create-charge.js [`#1263`](https://github.com/DEFRA/water-abstraction-service/pull/1263)
- Update create-charge.js [`#1264`](https://github.com/DEFRA/water-abstraction-service/pull/1264)
- Modify authentication to use internal calling user or decoded JWT token and set in request.auth.credentials [`efeb8ef`](https://github.com/DEFRA/water-abstraction-service/commit/efeb8ef092b4d702cc948e86adbd88652fe95892)
- Tests [`2c6fe06`](https://github.com/DEFRA/water-abstraction-service/commit/2c6fe06dc5c024e75d0f9fbf6abeaf9b4a2747cc)
- WIP [`10b688d`](https://github.com/DEFRA/water-abstraction-service/commit/10b688db44e1197db4cab58051ca8c5e3f6bb0ad)
- Adds getSignedURL S3 method + Updates failing tests with current year [`4e1393b`](https://github.com/DEFRA/water-abstraction-service/commit/4e1393b04904c9cad4d24ffe2a4ea68e92d7b223)
- Feat: Removes start date for finding licences without charge info [`6e9a5ec`](https://github.com/DEFRA/water-abstraction-service/commit/6e9a5ecf0b34830a831c03c5fa59de03a3ff91de)
- Adds trim to Y/N values in csv validator [`1e1500f`](https://github.com/DEFRA/water-abstraction-service/commit/1e1500f9f6256ffd55ce6718ab0e31649f1096d6)
- Remove unnecessary semicolon [`b5d071d`](https://github.com/DEFRA/water-abstraction-service/commit/b5d071dc548bb4ed7f86bf879b6d325d9c8c80f7)

#### [v1.59.0](https://github.com/DEFRA/water-abstraction-service/compare/v1.56.0...v1.59.0)

> 6 January 2021

- Fix: Updates contact schema validation [`#1261`](https://github.com/DEFRA/water-abstraction-service/pull/1261)
- Use shared knex query mapper from helpers [`#1260`](https://github.com/DEFRA/water-abstraction-service/pull/1260)
- Send unique transaction ID to CM - WATER 2945 [`#1257`](https://github.com/DEFRA/water-abstraction-service/pull/1257)
- Update regression pack to use acceptance-test set up endpoint [`#1258`](https://github.com/DEFRA/water-abstraction-service/pull/1258)
- Reconfig [`#1254`](https://github.com/DEFRA/water-abstraction-service/pull/1254)
- Change NODE_ENV `test` to `qa` [`#1259`](https://github.com/DEFRA/water-abstraction-service/pull/1259)
- Removes unused queries [`#1251`](https://github.com/DEFRA/water-abstraction-service/pull/1251)
- Feat/water 2932 get companies house company [`#1247`](https://github.com/DEFRA/water-abstraction-service/pull/1247)
- Bug/water-2967 [`#1249`](https://github.com/DEFRA/water-abstraction-service/pull/1249)
- Bugfix - KPI reporting - returns by month query fixed [`#1250`](https://github.com/DEFRA/water-abstraction-service/pull/1250)
- Feat: Exclude licences with charge version workflow in progress from bill runs [`#1228`](https://github.com/DEFRA/water-abstraction-service/pull/1228)
- Adds missing address sources [`#1248`](https://github.com/DEFRA/water-abstraction-service/pull/1248)
- Feat: Proxy creating address in CRM [`#1242`](https://github.com/DEFRA/water-abstraction-service/pull/1242)
- If CM is running on localhost, bypass the Cognito Auth process [`#1246`](https://github.com/DEFRA/water-abstraction-service/pull/1246)
- Feat: Proxy CRM to create contact entity [`#1244`](https://github.com/DEFRA/water-abstraction-service/pull/1244)
- Update PG and knex in the Service module [`#1241`](https://github.com/DEFRA/water-abstraction-service/pull/1241)
-  Bugfix: Limit billing volumes to 6 decimal places [`#1238`](https://github.com/DEFRA/water-abstraction-service/pull/1238)
- Bugfix: Makes licence purpose annual quantity nullable [`#1239`](https://github.com/DEFRA/water-abstraction-service/pull/1239)
- Bugfix/water 2942 common address validation [`#1236`](https://github.com/DEFRA/water-abstraction-service/pull/1236)
- Bugfix: Allow transaction external id to be null [`#1237`](https://github.com/DEFRA/water-abstraction-service/pull/1237)
- Feat/water 2523 update customer details in the charge module [`#1232`](https://github.com/DEFRA/water-abstraction-service/pull/1232)
- Feat: Updates minimum charge transactions with charge data  [`#1235`](https://github.com/DEFRA/water-abstraction-service/pull/1235)
- Feat/bull mq test [`#1233`](https://github.com/DEFRA/water-abstraction-service/pull/1233)
- Uses single knex connection/pool for all DB queries [`#1234`](https://github.com/DEFRA/water-abstraction-service/pull/1234)
- Adds is_enabled_for_new_charge_versions flag to water.change_reasons [`#1231`](https://github.com/DEFRA/water-abstraction-service/pull/1231)
- Foreign key and constraint added to charge versions table for licence id [`#1230`](https://github.com/DEFRA/water-abstraction-service/pull/1230)
- Feat/Edit charge versions - licence id added to charge versions [`#1207`](https://github.com/DEFRA/water-abstraction-service/pull/1207)
- Bump aws-sdk from 2.791.0 to 2.792.0 [`#1227`](https://github.com/DEFRA/water-abstraction-service/pull/1227)
- Fixes issues relating to "NALD gaps" in charge version history [`#1226`](https://github.com/DEFRA/water-abstraction-service/pull/1226)
- Bump aws-sdk from 2.739.0 to 2.791.0 [`#1225`](https://github.com/DEFRA/water-abstraction-service/pull/1225)
- Add new CI [`#1224`](https://github.com/DEFRA/water-abstraction-service/pull/1224)
- Adds API endpoint in non-prod to delete all billing data [`#1221`](https://github.com/DEFRA/water-abstraction-service/pull/1221)
- Removes unused Two Part Tariff matching files [`6c8b199`](https://github.com/DEFRA/water-abstraction-service/commit/6c8b19998f0bc655807649d72896fa2b83d5ede2)
- feat/water-2945 [`31c934e`](https://github.com/DEFRA/water-abstraction-service/commit/31c934e42d2f612f97dd77d9da10f0b2065b7909)
- WIP [`4f9bdc2`](https://github.com/DEFRA/water-abstraction-service/commit/4f9bdc2fb21ec515f88d40356feca45d1a7cccf5)
- Update package-lock.json [`7b8ee1c`](https://github.com/DEFRA/water-abstraction-service/commit/7b8ee1cb2cd8618b0e0da41d42e336d7f741f06d)
- feat/water-2806 [`4400088`](https://github.com/DEFRA/water-abstraction-service/commit/44000881224ddf99c3f2e3407c35fab95a1e8f2d)
- WIP [`02e5041`](https://github.com/DEFRA/water-abstraction-service/commit/02e5041f9d64c49194a2f2339b2fd3a9fe1cdb12)
- Makes changes based on review comments [`e883760`](https://github.com/DEFRA/water-abstraction-service/commit/e8837606d99128f11d710ae2383d1620cdd092a9)
- Removes duplicate address service [`e525b27`](https://github.com/DEFRA/water-abstraction-service/commit/e525b273c45b89414305b181cae63de23f40cd9d)
- Fix broken tests for acceptance endpoints [`3e5219b`](https://github.com/DEFRA/water-abstraction-service/commit/3e5219b24271240e8ddfff4f6956041b56e18e5b)
- Bugfix: Limit billing volumes to 6 decimal places [`9ba5b0b`](https://github.com/DEFRA/water-abstraction-service/commit/9ba5b0b1f72fe1a39ed8e3016abab9f358b6dbab)
- Fix broken tests [`0b12d8c`](https://github.com/DEFRA/water-abstraction-service/commit/0b12d8cc122bb9ede4395a70756e5462947228e2)
- WIP [`005ea82`](https://github.com/DEFRA/water-abstraction-service/commit/005ea82daa4a032f419a60275ff870db33e546de)
- Maps payload to model and uses shared address service. [`f5408b3`](https://github.com/DEFRA/water-abstraction-service/commit/f5408b3f342144a49ee757955dce2d13fea3ed2a)
- feat/water-2945 [`016676b`](https://github.com/DEFRA/water-abstraction-service/commit/016676bbb0b53d89851d61b7c7b8f765a5cca0f1)
- Update licences service to correct method for flagging licence for supplementary billing [`ad810e6`](https://github.com/DEFRA/water-abstraction-service/commit/ad810e68fdad7e258f59bbdd6d0ba3f3c649ba45)
- Just tidying [`bf7c429`](https://github.com/DEFRA/water-abstraction-service/commit/bf7c429d158ec989d43f5c233494241513099126)
- Adds test to prehandler [`b9a8ba0`](https://github.com/DEFRA/water-abstraction-service/commit/b9a8ba0236b7157a8fc405f257ae18f4fb4b84b4)
- Update licences.js [`ff3f0b2`](https://github.com/DEFRA/water-abstraction-service/commit/ff3f0b2ce6e0257ca3a9073f9ddabdf65757ca7c)
- bug/kpi-reporting [`aecb2ce`](https://github.com/DEFRA/water-abstraction-service/commit/aecb2ceffda3821d84197c549c85a88f86d15618)
- Update README.MD [`96661d2`](https://github.com/DEFRA/water-abstraction-service/commit/96661d203d613e0b8b39fa5a0c84b5edfce2acd8)
- Lintage [`df9914e`](https://github.com/DEFRA/water-abstraction-service/commit/df9914eaa2481ff3fbd9acee0702158a9a9f07bd)
- Update 20171201101821-water-up.sql [`2075d85`](https://github.com/DEFRA/water-abstraction-service/commit/2075d853e66429205840a15b9328c950286c732c)
- Update package.json [`daeb1a1`](https://github.com/DEFRA/water-abstraction-service/commit/daeb1a1a083d8235536cb70ad8ae47c560a699e1)
- Update 20171201101821-water-up.sql [`fd8e9ae`](https://github.com/DEFRA/water-abstraction-service/commit/fd8e9ae783d7650441485cf206dd848070beb06f)
- Update config.js [`3d50344`](https://github.com/DEFRA/water-abstraction-service/commit/3d503447e8b5338b9487f2c0a040268779db3bea)
- Update config.js [`c74a14f`](https://github.com/DEFRA/water-abstraction-service/commit/c74a14fe1dd918b35a9d09d7d7b01f85136e705b)
- Update ecosystem.config.json [`7b6a716`](https://github.com/DEFRA/water-abstraction-service/commit/7b6a716351a665c3f60a9debcdf16bf4484f81c3)
- Increase job check interval [`0df8321`](https://github.com/DEFRA/water-abstraction-service/commit/0df8321c9afd951b5e8898f3506c5054550b9342)
- bug/kpi-reporting [`bfdd45f`](https://github.com/DEFRA/water-abstraction-service/commit/bfdd45ffa1e7e4ff2da49dbbe5afebd81ad46789)
- Update config.js [`7452f3d`](https://github.com/DEFRA/water-abstraction-service/commit/7452f3de5953a8b5dd19d6290891ad3fdb295ff3)
- Added check for test mode, to prevent tests from failing due to locally calculated JWT [`0c50102`](https://github.com/DEFRA/water-abstraction-service/commit/0c50102b70e373bbd7665aa674c8f6c7d75898eb)
- Fixes SonarCloud code smell [`c10a7df`](https://github.com/DEFRA/water-abstraction-service/commit/c10a7df1c1083be5cb494f702bc5bc270bfc6220)
- feat/water-2806 [`42e5075`](https://github.com/DEFRA/water-abstraction-service/commit/42e507552673d79baf0e02bbf2a8eff638d194aa)
- Update documents.js [`731b5d4`](https://github.com/DEFRA/water-abstraction-service/commit/731b5d411ed865ad79f18c0b4c0d04622bbdee40)
- Fixes linter error [`89323ed`](https://github.com/DEFRA/water-abstraction-service/commit/89323ed8eb4cc2f70277964fd908910310f96f27)
- Update knex.js [`254f2ec`](https://github.com/DEFRA/water-abstraction-service/commit/254f2ecbc5b0f8fd0e175f700547330b665b0d0d)
- Update knex.js [`8081355`](https://github.com/DEFRA/water-abstraction-service/commit/808135503589db74a246e2c6641d53ba3f781575)
- Update ci.yml [`fe3a776`](https://github.com/DEFRA/water-abstraction-service/commit/fe3a776398d08a98bf4027fdee4902581d062b40)

#### [v1.56.0](https://github.com/DEFRA/water-abstraction-service/compare/v1.54.0...v1.56.0)

> 11 November 2020

- Feat: User can only run 1 annual or TPT bill run per region, FY and season [`#1219`](https://github.com/DEFRA/water-abstraction-service/pull/1219)
- Feat: ensure that customers are not billed twice [`#1210`](https://github.com/DEFRA/water-abstraction-service/pull/1210)
- Round billing volumes to 6dp not 3dp [`#1216`](https://github.com/DEFRA/water-abstraction-service/pull/1216)
- Handle 4xx errors in charge module [`#1214`](https://github.com/DEFRA/water-abstraction-service/pull/1214)
- Travis has finished running but the API callback has failed. https://travis-ci.org/github/DEFRA/water-abstraction-service/builds/741351841  [`#1205`](https://github.com/DEFRA/water-abstraction-service/pull/1205)
- Fixes issue in paper forms flow for returns with "null" values in abs period [`#1212`](https://github.com/DEFRA/water-abstraction-service/pull/1212)
- Fixes issue in paper forms flow for returns with "null" values in abs period [`#1211`](https://github.com/DEFRA/water-abstraction-service/pull/1211)
- Make paper forms batch notification send immediately. [`#1204`](https://github.com/DEFRA/water-abstraction-service/pull/1204)
- Feat/water 2885 charge version workflows [`#1201`](https://github.com/DEFRA/water-abstraction-service/pull/1201)
- Fix: Updates the use of Boom.unauthorized [`#1200`](https://github.com/DEFRA/water-abstraction-service/pull/1200)
- Feat/Water - 2793 -- supplementary bill run data for acceptance tests [`#1197`](https://github.com/DEFRA/water-abstraction-service/pull/1197)
- Bugfix/companies house api proxy failure [`#1196`](https://github.com/DEFRA/water-abstraction-service/pull/1196)
- Add licenceNumber property to CRM v2 document model [`#1192`](https://github.com/DEFRA/water-abstraction-service/pull/1192)
- Bugfix/charge version workflow scopes [`#1194`](https://github.com/DEFRA/water-abstraction-service/pull/1194)
- Hotfix/migrations failing 19 10 2020 [`#1191`](https://github.com/DEFRA/water-abstraction-service/pull/1191)
- Feat: Get licences without charge versions [`#1189`](https://github.com/DEFRA/water-abstraction-service/pull/1189)
- Bugfix/refactor role enum in models [`#1186`](https://github.com/DEFRA/water-abstraction-service/pull/1186)
- Add legacyId to returnRequirement model and mapper [`#1185`](https://github.com/DEFRA/water-abstraction-service/pull/1185)
- Feat: Integrate Charge Information Flow [`#1184`](https://github.com/DEFRA/water-abstraction-service/pull/1184)
- Fix tests [`9e8094e`](https://github.com/DEFRA/water-abstraction-service/commit/9e8094e16ff121d0f84a16a09e0fa225a9b27162)
- feat/water-2793 [`62053af`](https://github.com/DEFRA/water-abstraction-service/commit/62053af3b1e5e5dbf9dddcbb8fabbd2af3bbe43d)
- Removing tests in progress... WIP. [`5c5bee2`](https://github.com/DEFRA/water-abstraction-service/commit/5c5bee236d4086fff090fe99dab20044fd994bd7)
- Map service models to Notify address [`60e6e15`](https://github.com/DEFRA/water-abstraction-service/commit/60e6e1585ee638b29a2a14b055a81a1b81dc52a8)
- Additional tests [`95d796a`](https://github.com/DEFRA/water-abstraction-service/commit/95d796a12eabfaa0a1f5d0e819baae90d92c4e83)
- feat/water-2806 [`f555114`](https://github.com/DEFRA/water-abstraction-service/commit/f555114adb2996c9c3bc596f6215e42e39998fce)
- Handle unmatched documents [`0bf9897`](https://github.com/DEFRA/water-abstraction-service/commit/0bf9897ca02fdd3dd36cd0b3a6209a1438021f2f)
- Updates mappers to new mapper method [`38dbe1c`](https://github.com/DEFRA/water-abstraction-service/commit/38dbe1c445aa694830b11162bce96cd1ca8bd29f)
- Linting! [`4110077`](https://github.com/DEFRA/water-abstraction-service/commit/4110077b34b4273bc098b80c58b3aa631d9e8909)
- Breaks HTTP requests out into another file so that they can be mocked in test [`05a96a2`](https://github.com/DEFRA/water-abstraction-service/commit/05a96a24c38864ae5b20f0b47820d6c878469b74)
- Handles HTTP client errors in CM and continues processing.  Adds hasTransactionErrors flag to invoice/invoiceLicence models. [`51819bd`](https://github.com/DEFRA/water-abstraction-service/commit/51819bdf2189aaec195293210f8d0ad6bb743f46)
- Add migration script to deal with change of label [`3f22220`](https://github.com/DEFRA/water-abstraction-service/commit/3f22220c875e0baf87ac726ca3753f08d582293e)
- Replace CRM helper with call to connector [`5f7a58d`](https://github.com/DEFRA/water-abstraction-service/commit/5f7a58d156e0149aac98d98cd507c8a3b35ba582)
- Swaps out the companies house requestor [`57b070b`](https://github.com/DEFRA/water-abstraction-service/commit/57b070bd9cbfd7a9dcc9d5cc0e579790430439c8)
- Add migrations [`953726d`](https://github.com/DEFRA/water-abstraction-service/commit/953726d4d271c519770ab0f3eeb3b783bce4fe38)
- Removes contact, company and address from the InvoiceLicence model [`5cd90ba`](https://github.com/DEFRA/water-abstraction-service/commit/5cd90ba4c154a9c9531f797f4bffadc95272b8f2)
- Fixes issue where role name for charge_version_workflow_reviewer didn't match IDM role name [`e184696`](https://github.com/DEFRA/water-abstraction-service/commit/e1846960919e9b6be758224f9c868ab053b53f29)
- Bypass unnecessary error [`033f21b`](https://github.com/DEFRA/water-abstraction-service/commit/033f21bbc5cde7052e8ebe90875e45e07c491abf)
- Removes error throwing [`14317a0`](https://github.com/DEFRA/water-abstraction-service/commit/14317a0786307640f00cfdd6bf37bea0e2b0ac6b)
- Migration script change [`bfb35e8`](https://github.com/DEFRA/water-abstraction-service/commit/bfb35e818d83b8a7ed8af0938e7674f701de92c9)
- Fixing tests to match 'review' instead of 'draft' [`50461ff`](https://github.com/DEFRA/water-abstraction-service/commit/50461ff18d4c7fafece594b3b4d98250b77a4266)
- feat/water-2806 [`1c269e3`](https://github.com/DEFRA/water-abstraction-service/commit/1c269e39d83b2fd02ddc896d0657f3e949535f0b)
- Swap out http for request-promise [`c425eb8`](https://github.com/DEFRA/water-abstraction-service/commit/c425eb84d3366d379abf02369149074ea67c6aae)
- Additional tests [`567a28a`](https://github.com/DEFRA/water-abstraction-service/commit/567a28a3a7612f2724b5369a1ef7aebc2078c45e)
- Removes unused 'uniqueId' value from the Invoice Licence model [`f885fcf`](https://github.com/DEFRA/water-abstraction-service/commit/f885fcfca1455c9b49acf1299ca54c1f71f4f620)
- Reverts change to mapper helpers. Fixes tests. [`42894a9`](https://github.com/DEFRA/water-abstraction-service/commit/42894a9472f8bb76f531985200686abad1599ae4)
- Remove comopany, address and contact from mapper [`60ba5cb`](https://github.com/DEFRA/water-abstraction-service/commit/60ba5cbd39e8e7e30828b9a62fe8bd5ca5ef4669)
- feat/water-2806 [`67202e9`](https://github.com/DEFRA/water-abstraction-service/commit/67202e9200845777b3105eb22e9e29978f5a2415)
- Add licence number to Document service model and mapper [`ac611af`](https://github.com/DEFRA/water-abstraction-service/commit/ac611af0e5b210c0640a965377f0ef262915362b)
- feat/water-2793 [`b0969ac`](https://github.com/DEFRA/water-abstraction-service/commit/b0969acdfac93c74b3977c5dca084850fe0be982)
- FIx code quality issues [`e1d6bb1`](https://github.com/DEFRA/water-abstraction-service/commit/e1d6bb1e190e25a2421ef0af2adc544ee43759dc)
- Removes unused variables [`8bbcfb9`](https://github.com/DEFRA/water-abstraction-service/commit/8bbcfb93b8a28a2713849c5bd53b45ceddc25f12)
- Remove company and licenceHolder from createInvoiceLicence method [`5695f2b`](https://github.com/DEFRA/water-abstraction-service/commit/5695f2b9a4fd63d656cc06ed74dccf71e2cdd061)
- Modifies the controller to handle reviewer comments [`c2bcd92`](https://github.com/DEFRA/water-abstraction-service/commit/c2bcd928e171ee76103090018ca2ca88f83d4699)
- Makes the change-reasons endpoint return and object instead of an array [`dc712a8`](https://github.com/DEFRA/water-abstraction-service/commit/dc712a841a44162d978138520a62598634b46cf3)
- Fixing typos! [`7f5c7f6`](https://github.com/DEFRA/water-abstraction-service/commit/7f5c7f6e2a4cb6a3ca33106ee44684f96fed4eed)
- Immutes existing object instead of creating a new one [`f01c7c6`](https://github.com/DEFRA/water-abstraction-service/commit/f01c7c614540dde6d82fa7bdf8869ecc920c3cb0)
- Update charge-version-workflow.js [`82cc9b3`](https://github.com/DEFRA/water-abstraction-service/commit/82cc9b3528559d3f88dd22e2ebe5356b27dd100e)
- Update 20201012124428-scheduled-notification-primary-key-to-uuid-up.sql [`ac90765`](https://github.com/DEFRA/water-abstraction-service/commit/ac90765e3e5d5002223f9f7f3efc8df54e573f6f)
- Corrected SQL query affected by this change [`3c299a1`](https://github.com/DEFRA/water-abstraction-service/commit/3c299a193164aa872ff9f58d743de567f27ca603)
- Update charge-version-workflow.js [`5643456`](https://github.com/DEFRA/water-abstraction-service/commit/5643456f71becc94297eb682740c3cb60016cb8e)
- Change default charge_version_workflow status to 'review' [`f3bbc54`](https://github.com/DEFRA/water-abstraction-service/commit/f3bbc54d41bcff6e26b6fb46fa8f084a30721bd8)
- Modifies the unique identifier to only look at the licence number [`0e4efe5`](https://github.com/DEFRA/water-abstraction-service/commit/0e4efe582b7765f3659d0d19cb8b5bca64dc44db)
- Fixes a bug whereby return was kicking in before the service method gets a chance to respond (await) [`1d47e2b`](https://github.com/DEFRA/water-abstraction-service/commit/1d47e2b24fa15226a54e396dee5703f2ccf9f14a)
- Takes a more cautious approach to finding the startDate [`9248f0b`](https://github.com/DEFRA/water-abstraction-service/commit/9248f0bd984e2d0cd192188879acf7b570ad77c6)
- WIP [`ff930c4`](https://github.com/DEFRA/water-abstraction-service/commit/ff930c44eae5d048a83106b52e2ae1dab382da6a)
- feat/water-2806 [`2501753`](https://github.com/DEFRA/water-abstraction-service/commit/2501753df481921880997d71c3f9f8da511fd4ce)
- feat/water-2806 [`271319b`](https://github.com/DEFRA/water-abstraction-service/commit/271319bbba0023ffd04163f571162ec2c4cc9733)
- Linting [`2cc521e`](https://github.com/DEFRA/water-abstraction-service/commit/2cc521e2053a8310b30dce36ef0cdd09d5b670e4)
- Update charge-version-workflows.js [`87d7ea3`](https://github.com/DEFRA/water-abstraction-service/commit/87d7ea3b3f7295770519d87324b4c5fb13f2fd08)
- Update charge-version-workflow.js [`6b8ae01`](https://github.com/DEFRA/water-abstraction-service/commit/6b8ae01328948697a5f8331ea1adc1b802f8b64e)
- Allow null in charge-elements.annualQuantity [`e4db163`](https://github.com/DEFRA/water-abstraction-service/commit/e4db163bfb2d84af3d19d63469e70c78ce41429f)
- Allow licence_version_purposes.annualQuantity to be nullable positive or zero int [`977b1c5`](https://github.com/DEFRA/water-abstraction-service/commit/977b1c5779aef9403efe0fe647730d5a966ae1f0)
- Update charge-version-workflows.js [`036eca5`](https://github.com/DEFRA/water-abstraction-service/commit/036eca57091bc84e3af29641577da72c9831f790)
- Allows destructuring when dateRange is undefined [`cc959d0`](https://github.com/DEFRA/water-abstraction-service/commit/cc959d0b21040a35fe763e04b8aa21189976ff8c)
- Update companies-house.js [`fef57f8`](https://github.com/DEFRA/water-abstraction-service/commit/fef57f8235a5c92f6920535c61686a536597992a)
- Sonar correction [`319588a`](https://github.com/DEFRA/water-abstraction-service/commit/319588a238eb6f3e028ad4bc58c157d861978ef0)
- Amending start date - being extra cautious in case we forget to change it when we go live [`3606126`](https://github.com/DEFRA/water-abstraction-service/commit/36061269117d8969db74bfdff4c926e40b4f1894)
- Correcting a syntax error [`82a368d`](https://github.com/DEFRA/water-abstraction-service/commit/82a368dce67d05b480e6f6c5af9e4f045d716f55)
- Fixes typo in change reason types [`95864e6`](https://github.com/DEFRA/water-abstraction-service/commit/95864e68fdfb133d3b6881558444e21d9c597966)
- Adds missing required value [`5cd3104`](https://github.com/DEFRA/water-abstraction-service/commit/5cd31048466002348ab0653c86598e55d1c41aa0)
- Lint error [`c9bc6b4`](https://github.com/DEFRA/water-abstraction-service/commit/c9bc6b4b2e2f410e7060fa6433f9ae3a842a81f7)

#### [v1.54.0](https://github.com/DEFRA/water-abstraction-service/compare/v1.53.1...v1.54.0)

> 14 October 2020

- Feat: Paper return forms API [`#1183`](https://github.com/DEFRA/water-abstraction-service/pull/1183)
- Feat/water 2856 paper forms api [`#1174`](https://github.com/DEFRA/water-abstraction-service/pull/1174)
- Chore: Promote PDF generation code to the lib dir [`#1175`](https://github.com/DEFRA/water-abstraction-service/pull/1175)
- Feat/water 2777 end agreements [`#1173`](https://github.com/DEFRA/water-abstraction-service/pull/1173)
- Adds an endpoint to get the CRM v1 document by licence ID [`#1161`](https://github.com/DEFRA/water-abstraction-service/pull/1161)
- Updates mappers to use new object mapper [`#1172`](https://github.com/DEFRA/water-abstraction-service/pull/1172)
- Feat: Integrate Charge Information Flow [`5ea344f`](https://github.com/DEFRA/water-abstraction-service/commit/5ea344fbaa2691767877565fc2e7078b23b7a49b)
- End agreements tests [`c429b84`](https://github.com/DEFRA/water-abstraction-service/commit/c429b84dd6b6369dc6a2482de92f3b9f30c237db)
- Updates mappers to use new object mapper. [`db318d0`](https://github.com/DEFRA/water-abstraction-service/commit/db318d0c4c0225db066a149dbda45db9d815be59)
- Updates unit tests failing on travis [`7685eb8`](https://github.com/DEFRA/water-abstraction-service/commit/7685eb82f5ca8d41426a086457e8cbf7a920d5f9)
- Fix linter issues [`a9eba80`](https://github.com/DEFRA/water-abstraction-service/commit/a9eba80bbaa64900da660e6ced7c72cf3c104ce6)
- Fixes broken test following merge [`d560b49`](https://github.com/DEFRA/water-abstraction-service/commit/d560b499635bea8b49b5956c37dc776a8b1c3a1a)

#### [v1.53.1](https://github.com/DEFRA/water-abstraction-service/compare/v1.52.0...v1.53.1)

> 2 October 2020

- Removed some unnecessary spaces and SQL terminators [`#1169`](https://github.com/DEFRA/water-abstraction-service/pull/1169)
- Feat: Handle non chargeable change reasons [`#1144`](https://github.com/DEFRA/water-abstraction-service/pull/1144)
- Fix bill run issues due to CM statuses [`#1163`](https://github.com/DEFRA/water-abstraction-service/pull/1163)
- Adds UNIQUE constraint on ALTER TABLE water.financial_agreement_types [`#1165`](https://github.com/DEFRA/water-abstraction-service/pull/1165)
- New route to get invoice account by Id [`#1164`](https://github.com/DEFRA/water-abstraction-service/pull/1164)
- Updates transaction processor to set correct flag in transaction [`#1157`](https://github.com/DEFRA/water-abstraction-service/pull/1157)
- Feat/water 2688 agreements api [`#1148`](https://github.com/DEFRA/water-abstraction-service/pull/1148)
- Fix issue with large (e.g. annual) bill run [`#1140`](https://github.com/DEFRA/water-abstraction-service/pull/1140)
- Feat: Stop deleting zero value transactions [`#1155`](https://github.com/DEFRA/water-abstraction-service/pull/1155)
- Creates integration tests for scenario SB2 [`#1141`](https://github.com/DEFRA/water-abstraction-service/pull/1141)
- Water-2803 - move logic to identify abstraction period season to helpers [`#1149`](https://github.com/DEFRA/water-abstraction-service/pull/1149)
- Fix merge conflict in charge version test script [`#1152`](https://github.com/DEFRA/water-abstraction-service/pull/1152)
- Feat: Delete licence agreement [`#1147`](https://github.com/DEFRA/water-abstraction-service/pull/1147)
- Initial work to create charge version from workflow POST endpoint [`#1131`](https://github.com/DEFRA/water-abstraction-service/pull/1131)
- Fix tests [`a27c7fc`](https://github.com/DEFRA/water-abstraction-service/commit/a27c7fc7c5bd5724caf601c7847362f28698233c)
- Initial work to create 'add licence agreement' endpoint [`cc5c4a0`](https://github.com/DEFRA/water-abstraction-service/commit/cc5c4a005255922f197378a946b55116b0103cda)
- Fix tests [`47ce639`](https://github.com/DEFRA/water-abstraction-service/commit/47ce639e2507631afce2e64a725ac9d94f47a3d2)
- Review comments [`11c6381`](https://github.com/DEFRA/water-abstraction-service/commit/11c638180231c86dd159ca08ed8fdae56ffb307a)
- Additional tests [`a8d20be`](https://github.com/DEFRA/water-abstraction-service/commit/a8d20be1d5b9b991e6f3b912b3721add3c903c48)
- Combine delete and create methods for agreements into single service [`e8f39b9`](https://github.com/DEFRA/water-abstraction-service/commit/e8f39b947aaad58abb72aa636721accdbdb02820)
- Additional tests [`8c3fd3d`](https://github.com/DEFRA/water-abstraction-service/commit/8c3fd3d15626b436c0da6cc689b92b115355672d)
- Fix/add tests [`02d918c`](https://github.com/DEFRA/water-abstraction-service/commit/02d918c6f56a63e75f335cefd560133cc86742c1)
- Tests for licence agreements service [`d00d513`](https://github.com/DEFRA/water-abstraction-service/commit/d00d513499e6fbdba6450bfe230b22d707257261)
- Additional tests [`06c2e1c`](https://github.com/DEFRA/water-abstraction-service/commit/06c2e1c3a48406188858cea32bb882696c1759f1)
- feat/water-2689 [`7cc6b8c`](https://github.com/DEFRA/water-abstraction-service/commit/7cc6b8c9eb42bd1aa4bc2d1a7b28772e6cc12ab6)
- Add migration to add guid primary ID to financial_agreement_types table [`87cec49`](https://github.com/DEFRA/water-abstraction-service/commit/87cec496ae8e0fbf6a1928a0ffbcd1227e5924e9)
- Resolves an issue where bill run resolves to error page due to incomplete CM summary [`f2ed21a`](https://github.com/DEFRA/water-abstraction-service/commit/f2ed21a127e47729cc1f462898d3981f7227a95c)
- Revert "Removed some unnecessary spaces and SQL terminators" [`1932fa1`](https://github.com/DEFRA/water-abstraction-service/commit/1932fa16598567f7b56690b2e3ca81cd95f123f1)
- Fix tests for agreements routes to include scope [`dd09dbb`](https://github.com/DEFRA/water-abstraction-service/commit/dd09dbbf1e5f61eee05d765f99f4f61fc1f7cc3e)
- Initial work for end agreements [`d63d47b`](https://github.com/DEFRA/water-abstraction-service/commit/d63d47b5718982b0a5dac556af119e960c0dc9bd)
- feat/water-2803 [`faa4a2e`](https://github.com/DEFRA/water-abstraction-service/commit/faa4a2eed981863edfff182f20ebf26a24a1bf3a)
- Updates mapping/repo code for updated schema for licence_agreements / financial_agreement_types [`da4a6e5`](https://github.com/DEFRA/water-abstraction-service/commit/da4a6e57a9789066f6e72614fa75e7f5f7ad48f4)
- Fix CodeClimate issue with mapErrorResponse function [`faa1e8c`](https://github.com/DEFRA/water-abstraction-service/commit/faa1e8cf9090aae4fc763728d32b37f32bb97ba8)
- Add comments to internalCallingUser plugin [`a0b09d9`](https://github.com/DEFRA/water-abstraction-service/commit/a0b09d9b6df23a2e5e450ca4ff7ef6810d4ea863)
- Additional test [`01f0768`](https://github.com/DEFRA/water-abstraction-service/commit/01f0768f3adae324635b921de74a331bb12ec761)
- Fix issue with non-existent addresses [`93fb816`](https://github.com/DEFRA/water-abstraction-service/commit/93fb816b87fd2d88b4bbf6eaf9a79b049b72718d)
- feat/water-2803 [`28d65f2`](https://github.com/DEFRA/water-abstraction-service/commit/28d65f28029e8bfb8ff6b7c7ffe1fe615bf9908e)
- Move charge module retry options to app config [`3820768`](https://github.com/DEFRA/water-abstraction-service/commit/3820768faa19caec50c4b6c8ca893d14049e72ee)
- Protects agreements routes using new IDM roles [`44a3498`](https://github.com/DEFRA/water-abstraction-service/commit/44a3498eef9fe26a49694bbf2a47edb9048c5e9d)
- feat/water-2689 [`db1f834`](https://github.com/DEFRA/water-abstraction-service/commit/db1f834febfee85e6e8444de7906ed1fc1657c68)
- Ensure unique constraint is added in water.licence_agreements [`c0a1e9f`](https://github.com/DEFRA/water-abstraction-service/commit/c0a1e9f9d0bad1edf8b200a7672da71364c7eb49)

#### [v1.52.0](https://github.com/DEFRA/water-abstraction-service/compare/v1.51.0...v1.52.0)

> 16 September 2020

- Adds Integration test AB2 [`#1132`](https://github.com/DEFRA/water-abstraction-service/pull/1132)
- Refactors invoice and related mappers [`#1135`](https://github.com/DEFRA/water-abstraction-service/pull/1135)
- Feat: Change reason type [`#1134`](https://github.com/DEFRA/water-abstraction-service/pull/1134)
- WATER-2785 - Added GET /water/1.0/licences/licence-accounts [`#1124`](https://github.com/DEFRA/water-abstraction-service/pull/1124)
- WATER 2793 - Create charge test data for Acceptance tests [`#1126`](https://github.com/DEFRA/water-abstraction-service/pull/1126)
- Feat/water 2836 charge information 4 search existing companies [`#1128`](https://github.com/DEFRA/water-abstraction-service/pull/1128)
- Move logic for marking error'ed batches to handlers. [`9075092`](https://github.com/DEFRA/water-abstraction-service/commit/9075092e152af057a8d0443b2dca86fe3b3ecdc5)
- Revert "Sets up AB2 scenario with tests." [`db84005`](https://github.com/DEFRA/water-abstraction-service/commit/db8400530b3ced03e33838f32b36be5464b9124a)
- Sets up AB2 scenario with tests. [`3993d9d`](https://github.com/DEFRA/water-abstraction-service/commit/3993d9d7b4c9ce28a76287144069a6a60dcad5d3)
- Added GET /water/1.0/licences/licence-accounts [`87ede48`](https://github.com/DEFRA/water-abstraction-service/commit/87ede48bcd55507221f2c915759d959abde85207)
- Added missing controller test [`a8e96bd`](https://github.com/DEFRA/water-abstraction-service/commit/a8e96bd8586f799974b226fc3df202b346bba03c)
- feat/water-2793 [`f4afded`](https://github.com/DEFRA/water-abstraction-service/commit/f4afded9c3b076b92c3a4fb33672194de9482e1e)
- Added GET /water/1.0/companies/search [`3199764`](https://github.com/DEFRA/water-abstraction-service/commit/319976460ad223908f88695ab8224f16dc1b8db9)
- Added a missing controller test + changed URL to plural syntax as suggested in PR review [`30822d3`](https://github.com/DEFRA/water-abstraction-service/commit/30822d34099006d91e640e34f586af68286d6c07)
- feat/water-2793 [`09f3adf`](https://github.com/DEFRA/water-abstraction-service/commit/09f3adf377c18203b59d0e0df74f74abaebb551b)
- Fixes issue where prepare-transactions-complete did not publish enough jobs [`b12d882`](https://github.com/DEFRA/water-abstraction-service/commit/b12d882516efdb05aca3be7c5295db9cbcd77c41)
- Added a missing test [`d78d016`](https://github.com/DEFRA/water-abstraction-service/commit/d78d01637cd4d612e9cc42651c2c012bcfdc8fda)
- Added service test [`ebd4ff4`](https://github.com/DEFRA/water-abstraction-service/commit/ebd4ff4230e1d43f6c170ad77d64a0e0f3703c87)
- Linting [`43a599d`](https://github.com/DEFRA/water-abstraction-service/commit/43a599dc3f72a86af56d4af1f6d48b59254083e0)
- Added a URL resolution test [`bf08f65`](https://github.com/DEFRA/water-abstraction-service/commit/bf08f65c98acf3973687f2a162322e759767c33b)
- feat/water-2793 [`6536b83`](https://github.com/DEFRA/water-abstraction-service/commit/6536b83134641af97e5b2a5452affb704555728b)
- Added test for searchCompaniesByName route [`a46da2f`](https://github.com/DEFRA/water-abstraction-service/commit/a46da2fe658602aa11c476f103edadd1a18f5d45)
- Linting + Added mapping [`ffd4642`](https://github.com/DEFRA/water-abstraction-service/commit/ffd4642b998823b22f229721ec1bde235f01df47)
- feat/water-2793 [`992c5d7`](https://github.com/DEFRA/water-abstraction-service/commit/992c5d76d49b6f74310438c06542f8a9eb62ff45)
- Added mapper [`66981d3`](https://github.com/DEFRA/water-abstraction-service/commit/66981d37a4d7a3cf181ee33dd1901c00a62d993a)
- Lint [`23af146`](https://github.com/DEFRA/water-abstraction-service/commit/23af146ebecbb56116057aa14e44dffc16e3f64e)
- Update controller.js [`b1646d2`](https://github.com/DEFRA/water-abstraction-service/commit/b1646d2a952eb8ed1e282b547141330bca94b71d)
- feat/2793 [`5d60275`](https://github.com/DEFRA/water-abstraction-service/commit/5d6027517abdca9d0d8aab2390ba5a1dfa54721d)

#### [v1.51.0](https://github.com/DEFRA/water-abstraction-service/compare/v1.50.0...v1.51.0)

> 28 August 2020

- Feat: minimum charge [`#1093`](https://github.com/DEFRA/water-abstraction-service/pull/1093)
- Use return due dates from helpers for identifying returns in return batch notifications [`#1122`](https://github.com/DEFRA/water-abstraction-service/pull/1122)
- Add endpoints to patch and delete charge version workflows [`#1115`](https://github.com/DEFRA/water-abstraction-service/pull/1115)
- Hotfix/v1.50 hotfix 1 [`#1119`](https://github.com/DEFRA/water-abstraction-service/pull/1119)
- Feature/2743 charge information [`#1101`](https://github.com/DEFRA/water-abstraction-service/pull/1101)
- Fixes issue in charge version dbToModel mapper when licence is empty [`#1118`](https://github.com/DEFRA/water-abstraction-service/pull/1118)
- Fix KPI data issues [`#1066`](https://github.com/DEFRA/water-abstraction-service/pull/1066)
- Delete pending refreshTotals jobs from queue in integration tests [`#1113`](https://github.com/DEFRA/water-abstraction-service/pull/1113)
- Initial work to get and create charge version workflows [`#1106`](https://github.com/DEFRA/water-abstraction-service/pull/1106)
- Build(deps): Bump lodash from 4.17.19 to 4.17.20 [`#1094`](https://github.com/DEFRA/water-abstraction-service/pull/1094)
- [Security] Bump codecov from 3.7.0 to 3.7.2 [`#1055`](https://github.com/DEFRA/water-abstraction-service/pull/1055)
- Bump aws-sdk from 2.728.0 to 2.739.0 [`#1114`](https://github.com/DEFRA/water-abstraction-service/pull/1114)
- Water-2821: Fixes some of the fails in the integration test suite [`#1102`](https://github.com/DEFRA/water-abstraction-service/pull/1102)
- Replica branch rebased against the release branch [`#1112`](https://github.com/DEFRA/water-abstraction-service/pull/1112)
- Migration script to set a default value for 'include_in_supplementary_billing' [`#1110`](https://github.com/DEFRA/water-abstraction-service/pull/1110)
- Feat/water 2799 tpt bill run changes [`#1098`](https://github.com/DEFRA/water-abstraction-service/pull/1098)
- Added table migration scripts [`#1109`](https://github.com/DEFRA/water-abstraction-service/pull/1109)
- Bugfix/2795 - Invoice Account Address Mapper fixed [`#1108`](https://github.com/DEFRA/water-abstraction-service/pull/1108)
- Makes requested changes from review. [`e972a6e`](https://github.com/DEFRA/water-abstraction-service/commit/e972a6e889e2bcda2acffac52339fcc164dc2168)
- Add licence holder role to returned data [`49283d3`](https://github.com/DEFRA/water-abstraction-service/commit/49283d3efb9f184d957da99c8c62da00a3ce1806)
- Add repo tests [`a2b2e6d`](https://github.com/DEFRA/water-abstraction-service/commit/a2b2e6dc6a0e9d92d3d38cadf357d6ab4f3ca112)
- Add additional tests [`008cc92`](https://github.com/DEFRA/water-abstraction-service/commit/008cc92504d0832370ed073aa2d118d5366855be)
- Additional tests [`96e21e9`](https://github.com/DEFRA/water-abstraction-service/commit/96e21e9668e3cbb2d68b44f49c5b1db608886bae)
- Tests for ChargeVersionWorkflow model [`25d5ce6`](https://github.com/DEFRA/water-abstraction-service/commit/25d5ce66cbdc48743d06bc44cf1a63ef120f241a)
- Add test for ChargeVersionWorkflow mapper [`b2ae4cc`](https://github.com/DEFRA/water-abstraction-service/commit/b2ae4ccacbc933fcee7c04b0f71ac114de28d636)
- Tests for new routes [`e61ee0d`](https://github.com/DEFRA/water-abstraction-service/commit/e61ee0d6322d697ff2b9413e71777c97ab4de3c5)
- Add tests for charge element mapper and documents service [`ecb1c7b`](https://github.com/DEFRA/water-abstraction-service/commit/ecb1c7be3c1fc84a251950c02315ecab5c4f7ed7)
- Additional tests [`85efb3b`](https://github.com/DEFRA/water-abstraction-service/commit/85efb3bc2fdbaa79eb9efe8157b05959fcfc63b9)
- Add tests for Document model [`e3721fe`](https://github.com/DEFRA/water-abstraction-service/commit/e3721fe8fc54f7f6e688dbf8afb20854b93c22bb)
- Fixes mapper issue and adds missing test [`48504d8`](https://github.com/DEFRA/water-abstraction-service/commit/48504d828bcc0dcfe1af28c140e0b0237181732e)
- Removes redundant code. Changes mapping when decorating transactions with CM data. [`88f168a`](https://github.com/DEFRA/water-abstraction-service/commit/88f168a296f086469346fae21fa5192a9109210d)
- Additional test, fix code climate issue [`372c057`](https://github.com/DEFRA/water-abstraction-service/commit/372c0574da748f9734686eed45d93d76b621706f)
- Additional tests for mappers [`49a2804`](https://github.com/DEFRA/water-abstraction-service/commit/49a2804edb53acd482e74017109936bee2af9e52)
- Additional tests [`7899ec7`](https://github.com/DEFRA/water-abstraction-service/commit/7899ec7aeb28336faa15d0d11edb02b59ada1343)
- Add test [`664cea6`](https://github.com/DEFRA/water-abstraction-service/commit/664cea61bc9ee2865c3657649dc120d197f25fc7)
- Additional tests [`57eadc7`](https://github.com/DEFRA/water-abstraction-service/commit/57eadc7e8e0163b67219768371824d64954a7031)
- Additional tests [`3ce4cc3`](https://github.com/DEFRA/water-abstraction-service/commit/3ce4cc3a17923dcf94bd1b9574aac14097a4b924)
- Test for API mappers [`9a8bdd0`](https://github.com/DEFRA/water-abstraction-service/commit/9a8bdd07617a136cf1d7b2506e598a46418bdaa8)
- Additional test [`ce1423f`](https://github.com/DEFRA/water-abstraction-service/commit/ce1423f3bac36613ea11cb5cde62464286ce1afd)
- Fix broken tests [`4564664`](https://github.com/DEFRA/water-abstraction-service/commit/456466459fe3e5a5a5f611671521c98327c8bacd)
- bugfix/2795 [`e4f9c7d`](https://github.com/DEFRA/water-abstraction-service/commit/e4f9c7d30f42d3c46dca6b80e51084268144a16e)
- bugfix/2795 [`148fab6`](https://github.com/DEFRA/water-abstraction-service/commit/148fab6f1aef67a1f84f5c9658cda71b80e08a9e)
- bugfix/2795 [`f9035fe`](https://github.com/DEFRA/water-abstraction-service/commit/f9035fef93973fe14c178b9d22587205613f53bb)
- Fix 404 handling, add @hapi/basic for testing [`252086d`](https://github.com/DEFRA/water-abstraction-service/commit/252086d8ebc37e4548956bd2447d8cc859ffcc85)
- Fix broken tests [`4fd51af`](https://github.com/DEFRA/water-abstraction-service/commit/4fd51af342016ff3cdbc6b816243db9e5963f25d)
- Pre-handler refactor [`169240d`](https://github.com/DEFRA/water-abstraction-service/commit/169240db92c545ca1ba1a293864b13d5acc45c08)
- Additional test [`550fd30`](https://github.com/DEFRA/water-abstraction-service/commit/550fd30fd0ccc2e8c0369c1a6da7cb2b24082b9e)
- Ensure pending refreshTotals jobs are removed from the job queue in integration tests [`2c70633`](https://github.com/DEFRA/water-abstraction-service/commit/2c706339be89c354d45edbd0782bc7521f5862e7)
- bugfix/kpi-data [`4bf2beb`](https://github.com/DEFRA/water-abstraction-service/commit/4bf2beb0f05dbc57b8a9385aaddab3799814e45a)
- Fix lint error [`e95be16`](https://github.com/DEFRA/water-abstraction-service/commit/e95be165816163943865ce9a1bf3204bd0db66ae)
- Don't delete non-existent CM batch in integration tests [`0131401`](https://github.com/DEFRA/water-abstraction-service/commit/0131401cb41e92de1af8fe2a82f4acdde7172bc3)

#### [v1.50.0](https://github.com/DEFRA/water-abstraction-service/compare/v1.47.0...v1.50.0)

> 21 August 2020

- Merge fix for WATER-2832 into develop branch [`#1107`](https://github.com/DEFRA/water-abstraction-service/pull/1107)
- bugfix/billing-volumes-tests-fix [`#1105`](https://github.com/DEFRA/water-abstraction-service/pull/1105)
- Feat: Charge Versions APIs [`#1097`](https://github.com/DEFRA/water-abstraction-service/pull/1097)
- Feat/water 2768 de minimis [`#1087`](https://github.com/DEFRA/water-abstraction-service/pull/1087)
- Feat/water 2799 - adds return requirements tables to water service [`#1092`](https://github.com/DEFRA/water-abstraction-service/pull/1092)
- Adds server caching to address search [`#1091`](https://github.com/DEFRA/water-abstraction-service/pull/1091)
- Update dependencies [`#1084`](https://github.com/DEFRA/water-abstraction-service/pull/1084)
- Feat/water 2774 integrate tpt changes [`#1070`](https://github.com/DEFRA/water-abstraction-service/pull/1070)
- Feat: Adds charge element maxAnnualQuantity to JSON [`#1079`](https://github.com/DEFRA/water-abstraction-service/pull/1079)
- Fix issue where invoice could not be deleted from batch [`#1078`](https://github.com/DEFRA/water-abstraction-service/pull/1078)
- Fix issue with migrations when volume column already exists [`#1077`](https://github.com/DEFRA/water-abstraction-service/pull/1077)
- Feat: Add agreement and licence agreement endpoints [`#1074`](https://github.com/DEFRA/water-abstraction-service/pull/1074)
- Fix: Updates a migration that won't run on dev server [`#1075`](https://github.com/DEFRA/water-abstraction-service/pull/1075)
- Fix: Chucks documents query to prevent large query string [`#1072`](https://github.com/DEFRA/water-abstraction-service/pull/1072)
- Feat: Licence include in supplementary billing [`#1069`](https://github.com/DEFRA/water-abstraction-service/pull/1069)
- Fix issue with bill run due to address model changes [`#1065`](https://github.com/DEFRA/water-abstraction-service/pull/1065)
- Fix: Prevents transaction description being null [`#1063`](https://github.com/DEFRA/water-abstraction-service/pull/1063)
- Feat/billing volumes service 2 [`#1057`](https://github.com/DEFRA/water-abstraction-service/pull/1057)
- Feat: Create invoice account with address, agent & contact roles. [`#1027`](https://github.com/DEFRA/water-abstraction-service/pull/1027)
- Bugfix: Don't throw error if no rows are deleted [`#1058`](https://github.com/DEFRA/water-abstraction-service/pull/1058)
- Adds endpoint to search for addresses by query string, e.g. postcode [`#1049`](https://github.com/DEFRA/water-abstraction-service/pull/1049)
- Feat: Adds a supplementary integration test [`#1047`](https://github.com/DEFRA/water-abstraction-service/pull/1047)
- Add API to search companies house [`#1040`](https://github.com/DEFRA/water-abstraction-service/pull/1040)
- KPI - reporting endpoint for UI [`#1020`](https://github.com/DEFRA/water-abstraction-service/pull/1020)
- Simplify charge version year creation with query [`#1039`](https://github.com/DEFRA/water-abstraction-service/pull/1039)
- Feat: set isTest flag to true for test returns data [`#1043`](https://github.com/DEFRA/water-abstraction-service/pull/1043)
- Fix issue where supplementary billing process did not create credits [`#1044`](https://github.com/DEFRA/water-abstraction-service/pull/1044)
- Initial work to create service models for returns, lines and versions [`#1041`](https://github.com/DEFRA/water-abstraction-service/pull/1041)
- Fix: Includes addition tables in previous migration [`#1037`](https://github.com/DEFRA/water-abstraction-service/pull/1037)
- Feat: Adds resource for company contacts [`#1032`](https://github.com/DEFRA/water-abstraction-service/pull/1032)
- Enforce not null constraint on water.licences.start_date column [`#1034`](https://github.com/DEFRA/water-abstraction-service/pull/1034)
- Revert "Feat/bull mq (#1022)" [`#1033`](https://github.com/DEFRA/water-abstraction-service/pull/1033)
- Consider time-limited dates when determining charge versions for TPT bill run [`#1031`](https://github.com/DEFRA/water-abstraction-service/pull/1031)
- Feat/bull mq [`#1022`](https://github.com/DEFRA/water-abstraction-service/pull/1022)
- Removes use of TPT_PURPOSE_USE_CODES [`#1026`](https://github.com/DEFRA/water-abstraction-service/pull/1026)
- Initial work to get and create charge version workflows [`39bd0ca`](https://github.com/DEFRA/water-abstraction-service/commit/39bd0cacc667cd6037193b1d2a025f922dfd8aa0)
- Feat: minimum charge [`d55c975`](https://github.com/DEFRA/water-abstraction-service/commit/d55c975e38833baa8df8cb0a09e9b63b44b39a5e)
- Moves logic for inclusion and creation of charge version years to JS code. [`4460a76`](https://github.com/DEFRA/water-abstraction-service/commit/4460a76e43b39d6690ecb262e1eef81c5c271572)
- Add tests for new models [`0f3131a`](https://github.com/DEFRA/water-abstraction-service/commit/0f3131ab649c0e677c65d795dfc8819c7dcd3f48)
- Feat: Adds the licence model to the document summary [`a74b2ce`](https://github.com/DEFRA/water-abstraction-service/commit/a74b2ce940bd1620aefee99aa6d0b9b647592c34)
- Add bookshelf models, service models, mappers and service to get return requirement versions for licence [`6a1a4fb`](https://github.com/DEFRA/water-abstraction-service/commit/6a1a4fb171d769139a2260ade4efaf9739b809df)
- Tests for new mappers [`af2ce0a`](https://github.com/DEFRA/water-abstraction-service/commit/af2ce0a2866ab97145dd98188611f487150f0c6d)
- Fix tests, add initial tests [`4d7742d`](https://github.com/DEFRA/water-abstraction-service/commit/4d7742d8eb6be3953ddae9dc6eef646cb6f85ea2)
- Remove broken tests [`ee8c75f`](https://github.com/DEFRA/water-abstraction-service/commit/ee8c75f349f184f681bbc025dbc799b5544772ca)
- Additional tests [`d899f16`](https://github.com/DEFRA/water-abstraction-service/commit/d899f16c667d99e5088b52fca88f8e02d3b3f261)
- Tests for companies house API connector and pagination model [`dd0eb56`](https://github.com/DEFRA/water-abstraction-service/commit/dd0eb56507dd1e4ded443ec1307d5a120ad3b466)
- Tests for new bookshelf models [`207968d`](https://github.com/DEFRA/water-abstraction-service/commit/207968dca8e6f16aba6d2f5e1020f7f1804cb4ed)
- Additional tests [`8f2ffbe`](https://github.com/DEFRA/water-abstraction-service/commit/8f2ffbe940352f59588b9151c893fa7937a8d0e2)
- Additional tests [`1641c62`](https://github.com/DEFRA/water-abstraction-service/commit/1641c62202d5210bfd4d787d45b072a6a02e4430)
- Additional tests [`57e8ced`](https://github.com/DEFRA/water-abstraction-service/commit/57e8ced188b90e61f321f70590eb73a3ac2bb286)
- Updates data fetching to try all sources [`40c5334`](https://github.com/DEFRA/water-abstraction-service/commit/40c53344a0020ae38027efdecc9f501ffe157066)
- Additional repo tests [`ed5ca21`](https://github.com/DEFRA/water-abstraction-service/commit/ed5ca21f488c8ed2ea7b782a7491fbdbeec0e331)
- Additional tests [`6c54d14`](https://github.com/DEFRA/water-abstraction-service/commit/6c54d1451bfced70e23bc7cdf7dc59b1e2a7c866)
- Makes .destroy() options to be dynamic for relevant repos [`4eea6b8`](https://github.com/DEFRA/water-abstraction-service/commit/4eea6b8d086af50ce8da035c3d7f8dfdfcce97af)
- bugfix/return empty kpi data [`d9845e3`](https://github.com/DEFRA/water-abstraction-service/commit/d9845e316ec90cf1d67cc710b92214c70be61a92)
- Bugfix: Don't throw error if no batch is deleted [`82a52d3`](https://github.com/DEFRA/water-abstraction-service/commit/82a52d359b06212fbe6a224d682e5305b189fbf3)
- Relocates the formatDate func to lib/dates [`3c55647`](https://github.com/DEFRA/water-abstraction-service/commit/3c55647a90df20cc1a8313cdc935e6e380aa5cb2)
- Additional test [`26887f1`](https://github.com/DEFRA/water-abstraction-service/commit/26887f1ef6369be0181ee877ab566eb5e9551a3d)
- bugfix/allow empty kpi sections [`83d516c`](https://github.com/DEFRA/water-abstraction-service/commit/83d516c8eebecb0cdea8c6a1fc0188c6a6efeebe)
- Build(deps): Bump lodash from 4.17.19 to 4.17.20 [`25dd7a6`](https://github.com/DEFRA/water-abstraction-service/commit/25dd7a67bbc8b6469642abe8d1ec49d1cb03e145)
- [Security] Bump codecov from 3.7.0 to 3.7.2 [`d669d61`](https://github.com/DEFRA/water-abstraction-service/commit/d669d612185fe7aa66fe32f2fd8895cb7ac6ada7)
- Additional test [`9836f5c`](https://github.com/DEFRA/water-abstraction-service/commit/9836f5c40572b36f3111ab1907c4fde4daf95c4f)
- Fixes linter error [`9ea6c36`](https://github.com/DEFRA/water-abstraction-service/commit/9ea6c36ae67faba2d2c50e8bacdc1b16ed5e075c)
- bugfix/kpi-reporting [`2b93a04`](https://github.com/DEFRA/water-abstraction-service/commit/2b93a04a1bfc445cf83d9f76047e1f75a8181441)
- Correct route description [`73c7aff`](https://github.com/DEFRA/water-abstraction-service/commit/73c7aff3db4092c106f3114b3a714e7a05190b91)

#### [v1.47.0](https://github.com/DEFRA/water-abstraction-service/compare/v1.46.0...v1.47.0)

> 3 July 2020

- Fix: Use charge period start and end date for charge element dates in matching algorithm [`#1025`](https://github.com/DEFRA/water-abstraction-service/pull/1025)
- Feat: Handle internal search error [`#1024`](https://github.com/DEFRA/water-abstraction-service/pull/1024)
- Consider winter/all year elements as a single group [`#1023`](https://github.com/DEFRA/water-abstraction-service/pull/1023)
- Fixes issue where wrong season was sent to billing volume service [`#1021`](https://github.com/DEFRA/water-abstraction-service/pull/1021)
- Feat: Transaction comparison in integration tests [`#1016`](https://github.com/DEFRA/water-abstraction-service/pull/1016)
- Permits transaction volume to go to max of charge element auth and billable quantities. [`#1018`](https://github.com/DEFRA/water-abstraction-service/pull/1018)
- Fix: Only use charge elements present in transactions [`#1015`](https://github.com/DEFRA/water-abstraction-service/pull/1015)
- Adds mapping of isTwoPartTariff flag for purposeUse [`#1013`](https://github.com/DEFRA/water-abstraction-service/pull/1013)
- Fix: Deleting billing volumes is not required [`#1012`](https://github.com/DEFRA/water-abstraction-service/pull/1012)
- Fixes issue where unsupported address_line_7 was being sent to Notify [`#1003`](https://github.com/DEFRA/water-abstraction-service/pull/1003)
- Fixes bug with totals in batch summary/invoice view [`#1009`](https://github.com/DEFRA/water-abstraction-service/pull/1009)
- Uses chargeVersion.elements to get billingVolumes. Fixes duplicate chargeElements issue [`#1008`](https://github.com/DEFRA/water-abstraction-service/pull/1008)
- Fix issues with billing volumes query and mapping [`#1007`](https://github.com/DEFRA/water-abstraction-service/pull/1007)
- Make supplementary billing process current and previous financial years [`#1006`](https://github.com/DEFRA/water-abstraction-service/pull/1006)
- Feature: TPT process update add billing volumes [`#1001`](https://github.com/DEFRA/water-abstraction-service/pull/1001)
- Feat: Charge data for licence versions [`#1004`](https://github.com/DEFRA/water-abstraction-service/pull/1004)
- Feat/water 2720 split invoices on fy [`#998`](https://github.com/DEFRA/water-abstraction-service/pull/998)
- Feat: Backend Updates for billingVolumes in UI [`#995`](https://github.com/DEFRA/water-abstraction-service/pull/995)
- Invoice account model changes [`#996`](https://github.com/DEFRA/water-abstraction-service/pull/996)
- Refactor charge-processor-service [`5b36a7d`](https://github.com/DEFRA/water-abstraction-service/commit/5b36a7d9670d7b2925e457c1a146ac78d8b481be)
- Fix linter error [`1fa2872`](https://github.com/DEFRA/water-abstraction-service/commit/1fa28728d36c77cc43d40a6fc2bf8a5a12f88efc)

#### [v1.46.0](https://github.com/DEFRA/water-abstraction-service/compare/v1.45.0...v1.46.0)

> 22 June 2020

- Feat: Delete billing volumes with related batch, account or licence [`#984`](https://github.com/DEFRA/water-abstraction-service/pull/984)
- Feat: Licence Versions endpoint [`#989`](https://github.com/DEFRA/water-abstraction-service/pull/989)
- Fixes bulk returns upload issue with large volume of returns in CSV [`#986`](https://github.com/DEFRA/water-abstraction-service/pull/986)
- Feature/2682 import licence versions [`#977`](https://github.com/DEFRA/water-abstraction-service/pull/977)
- API to rename licence and create event for KPI data [`#971`](https://github.com/DEFRA/water-abstraction-service/pull/971)

#### [v1.45.0](https://github.com/DEFRA/water-abstraction-service/compare/v1.44.0...v1.45.0)

> 10 June 2020

- Feat: Update TPT Process [`#979`](https://github.com/DEFRA/water-abstraction-service/pull/979)
- Feat/water 2711 get licence by ID API [`#965`](https://github.com/DEFRA/water-abstraction-service/pull/965)
- Include updated batch in response from TPT review API endpoint [`#970`](https://github.com/DEFRA/water-abstraction-service/pull/970)
- Feat: Uses an UUID for the purpose table id column [`#963`](https://github.com/DEFRA/water-abstraction-service/pull/963)
- FIx issue where licence could not be deleted in TPT run [`#964`](https://github.com/DEFRA/water-abstraction-service/pull/964)
- FIx issue where licence could not be deleted in TPT run [`#961`](https://github.com/DEFRA/water-abstraction-service/pull/961)
- feat/water-2644 [`2ffffc2`](https://github.com/DEFRA/water-abstraction-service/commit/2ffffc23528c4ffb71cca3e01c68bf85f17b013d)
- feat/water-2644 [`55cfd49`](https://github.com/DEFRA/water-abstraction-service/commit/55cfd4959521a5f5ee9859725f6f009a5f459d9d)
- feat/water-2644 [`6cc96ac`](https://github.com/DEFRA/water-abstraction-service/commit/6cc96ac4e77818e6c9e5d9e77afb34dd05304a59)
- Trigger - travis build [`13a4292`](https://github.com/DEFRA/water-abstraction-service/commit/13a42921b2de6f536b48edaeb8b8db55f5dda714)
- feat/water-2644 [`07e3dba`](https://github.com/DEFRA/water-abstraction-service/commit/07e3dbac0a00352317fe10c3eb7d4ea645899094)
- Trigger [`13f94ad`](https://github.com/DEFRA/water-abstraction-service/commit/13f94ad2cedaebfccfee72fca19e00f42728ef25)
- feat/water-2644 [`d8b08d6`](https://github.com/DEFRA/water-abstraction-service/commit/d8b08d6e8bb32cefabc9dceaaca414db0a14ff56)
- feat/water-2644 [`53d2fc9`](https://github.com/DEFRA/water-abstraction-service/commit/53d2fc915f9dc217f82bedb000f206b72542720c)

#### [v1.44.0](https://github.com/DEFRA/water-abstraction-service/compare/v1.43.0...v1.44.0)

> 1 June 2020

- Add change reasons endpoint when creating new charge version [`#958`](https://github.com/DEFRA/water-abstraction-service/pull/958)
- Allow transaction volume up to charge element auth volume [`#956`](https://github.com/DEFRA/water-abstraction-service/pull/956)
- Chore: Move import to import module [`#948`](https://github.com/DEFRA/water-abstraction-service/pull/948)
- Uses same parse options for validator and mapper stages of CSV returns upload [`#955`](https://github.com/DEFRA/water-abstraction-service/pull/955)
- Renames batch property 'billRunId' to 'billRunNumber' following recent change in charge module [`#954`](https://github.com/DEFRA/water-abstraction-service/pull/954)
- Tear down test licence agreements [`#943`](https://github.com/DEFRA/water-abstraction-service/pull/943)
- Bugfix/returns upload sort [`#945`](https://github.com/DEFRA/water-abstraction-service/pull/945)
- Bugfix/returns upload sort [`#946`](https://github.com/DEFRA/water-abstraction-service/pull/946)
- Revert "Revert "Feat: Decouple calculatedVolumes from Transaction (#932)"" [`0e86d58`](https://github.com/DEFRA/water-abstraction-service/commit/0e86d583aa64012c0b7936ed0b1987444132887e)
- Revert "Feat: Decouple calculatedVolumes from Transaction (#932)" [`7164e0c`](https://github.com/DEFRA/water-abstraction-service/commit/7164e0cbad431a87aeb6c54aeb751e6f924bc6d5)

#### [v1.43.0](https://github.com/DEFRA/water-abstraction-service/compare/v1.40.0...v1.43.0)

> 22 May 2020

- Include batch in response when creating billing batch [`#934`](https://github.com/DEFRA/water-abstraction-service/pull/934)
- Fix: Prevents attempting to deal null batch ids [`#942`](https://github.com/DEFRA/water-abstraction-service/pull/942)
- Feat/water 2641 single licence test [`#937`](https://github.com/DEFRA/water-abstraction-service/pull/937)
- Feat: Decouple calculatedVolumes from Transaction [`#932`](https://github.com/DEFRA/water-abstraction-service/pull/932)
- Feat/water 2659 rebuild charge processor [`#928`](https://github.com/DEFRA/water-abstraction-service/pull/928)
- Add company_id and invoice_account_id fields to charge versions [`#927`](https://github.com/DEFRA/water-abstraction-service/pull/927)
- Fix: Fixes a syntax issue with 7z on linux [`#925`](https://github.com/DEFRA/water-abstraction-service/pull/925)
- task/config-nald-import-non-prod [`#923`](https://github.com/DEFRA/water-abstraction-service/pull/923)
- Feat/water 2648 [`#907`](https://github.com/DEFRA/water-abstraction-service/pull/907)
- Fix: Fix final return line in leap year [`#922`](https://github.com/DEFRA/water-abstraction-service/pull/922)
- Feat: Add connector code from CRM test data endpoints [`#917`](https://github.com/DEFRA/water-abstraction-service/pull/917)
- Fixes issue where CRM v2 invoice accounts connector generated query strings that were too long [`#914`](https://github.com/DEFRA/water-abstraction-service/pull/914)
- tweak water-service connection pool [`#905`](https://github.com/DEFRA/water-abstraction-service/pull/905)
- Fixes snags in TPT flow following review. [`#903`](https://github.com/DEFRA/water-abstraction-service/pull/903)
- Move licence import process to PG boss saga [`#901`](https://github.com/DEFRA/water-abstraction-service/pull/901)
- Feat/water 2603 batch invoices water undertaker flag [`#896`](https://github.com/DEFRA/water-abstraction-service/pull/896)
- Adds endpoint for updating tpt bill run to ready status. [`#898`](https://github.com/DEFRA/water-abstraction-service/pull/898)
- Creates API for updating transaction volume [`#889`](https://github.com/DEFRA/water-abstraction-service/pull/889)
- Include invoiceId in invoiceLicence model [`#895`](https://github.com/DEFRA/water-abstraction-service/pull/895)
- Feat: Handles seasons with two part tariff [`#894`](https://github.com/DEFRA/water-abstraction-service/pull/894)
- Remove twoPartTariffStatuses from Transaction model. [`54a98cc`](https://github.com/DEFRA/water-abstraction-service/commit/54a98cc9b8a4d854a2318a1311ee26fbd852814a)
- Updates two part tariff service interface to match billing volumes service [`aa6cf57`](https://github.com/DEFRA/water-abstraction-service/commit/aa6cf577b000f521cd9e1a8dee918f12470011aa)
- Adds billing volumes mapper tests [`163c2b2`](https://github.com/DEFRA/water-abstraction-service/commit/163c2b2101b802612f7682ddcc438516aaf5b4b6)
- Updates two part tariff algorithm to work with billing volumes service. [`98cba95`](https://github.com/DEFRA/water-abstraction-service/commit/98cba9504b8f10bf818cdbab5cdb9a295aeccf14)
- Refactors billing volumes service [`3df17a9`](https://github.com/DEFRA/water-abstraction-service/commit/3df17a940ab6c59f02f4710cffed76eb297783f0)
- Updates billingVolumes service to use ChargeVersion model [`72cfbd4`](https://github.com/DEFRA/water-abstraction-service/commit/72cfbd46d1d092d50a6e1be334cd7301d273044b)

#### [v1.40.0](https://github.com/DEFRA/water-abstraction-service/compare/v1.39.0...v1.40.0)

> 14 April 2020

- Deletes an invoice licence by ID [`#891`](https://github.com/DEFRA/water-abstraction-service/pull/891)
- Add twoPartTariffError flag to batch licences API [`#886`](https://github.com/DEFRA/water-abstraction-service/pull/886)
- bugfix/transactions-dbToModel-Mapper [`#885`](https://github.com/DEFRA/water-abstraction-service/pull/885)
- API for getting one invoice licence with transactions [`#873`](https://github.com/DEFRA/water-abstraction-service/pull/873)
- Incorporate returns matching [`#877`](https://github.com/DEFRA/water-abstraction-service/pull/877)
- Use updated CM batch API [`#880`](https://github.com/DEFRA/water-abstraction-service/pull/880)
- Add eiucSource to chargeElement.toJSON() [`#879`](https://github.com/DEFRA/water-abstraction-service/pull/879)
- Adds licenceAgreement repo [`#872`](https://github.com/DEFRA/water-abstraction-service/pull/872)
- Remove fix to transaction mapper as already fixed by changing validation in model [`5683214`](https://github.com/DEFRA/water-abstraction-service/commit/56832143334649b8be26cd784b2a46130cd32a62)
- Merge branches 'bugfix/two-part-tariff-error-flag' and 'bugfix/two-part-tariff-error-flag' of https://github.com/DEFRA/water-abstraction-service into bugfix/two-part-tariff-error-flag [`6257f2e`](https://github.com/DEFRA/water-abstraction-service/commit/6257f2e6d481f00d4294db6b66a10b14b3a93434)
- Fix issue where null value in two_part_tariff_error field caused error in transaction mapper [`5d4a0e2`](https://github.com/DEFRA/water-abstraction-service/commit/5d4a0e20e87d0856cf2df0eb88ec487889bc27c1)

#### [v1.39.0](https://github.com/DEFRA/water-abstraction-service/compare/v1.38.0...v1.39.0)

> 27 March 2020

- Initial work on using hapi plugin for PG boss in returns module [`#865`](https://github.com/DEFRA/water-abstraction-service/pull/865)
- Feat: Persist user errors in bulk upload [`#856`](https://github.com/DEFRA/water-abstraction-service/pull/856)
- Empties onComplete queues when processing complete [`#863`](https://github.com/DEFRA/water-abstraction-service/pull/863)
- Feat/water 2579 annual billing query [`#857`](https://github.com/DEFRA/water-abstraction-service/pull/857)
- Feat: Adds batch licences api [`#858`](https://github.com/DEFRA/water-abstraction-service/pull/858)
- Feat: Updates fields in billing_transactions [`#853`](https://github.com/DEFRA/water-abstraction-service/pull/853)
- Feat: Filter two part tariff in charge processor [`#841`](https://github.com/DEFRA/water-abstraction-service/pull/841)
- Feat: Adds verbose transaction descriptions [`#850`](https://github.com/DEFRA/water-abstraction-service/pull/850)

#### [v1.38.0](https://github.com/DEFRA/water-abstraction-service/compare/v1.37.0...v1.38.0)

> 16 March 2020

- Improve Returns import - filter by number of years from config.js [`#837`](https://github.com/DEFRA/water-abstraction-service/pull/837)
- Feat: Include site desc and purpose to company returns [`#848`](https://github.com/DEFRA/water-abstraction-service/pull/848)
- Delete zero transactions [`#839`](https://github.com/DEFRA/water-abstraction-service/pull/839)
- Refresh net total / bill counts when customer is deleted from bill run [`#846`](https://github.com/DEFRA/water-abstraction-service/pull/846)
- Fixes issue where bill totals were for whole batch, not individual customer [`#845`](https://github.com/DEFRA/water-abstraction-service/pull/845)
- Update Return Reminder template names in service [`#828`](https://github.com/DEFRA/water-abstraction-service/pull/828)
- Add more robust date checking for csv upload. [`#824`](https://github.com/DEFRA/water-abstraction-service/pull/824)
- Feat: Adds new empty status for a batch [`#835`](https://github.com/DEFRA/water-abstraction-service/pull/835)
- Bugfix/event id reference [`#834`](https://github.com/DEFRA/water-abstraction-service/pull/834)
- Feat/water 2567 send notifications earlier [`#829`](https://github.com/DEFRA/water-abstraction-service/pull/829)
- Enable send batch operation to be retried [`#832`](https://github.com/DEFRA/water-abstraction-service/pull/832)
- Fix: Allow an account to be deleted from a batch [`#825`](https://github.com/DEFRA/water-abstraction-service/pull/825)
- End point for CSV billing invoices transactions download [`#818`](https://github.com/DEFRA/water-abstraction-service/pull/818)
- Fix: Loosen delete batch status validation [`#822`](https://github.com/DEFRA/water-abstraction-service/pull/822)
- Fixes an issue where sending a billing batch [`#819`](https://github.com/DEFRA/water-abstraction-service/pull/819)
- Feat: Graceful shutdown for  pg boss and pg pool [`#820`](https://github.com/DEFRA/water-abstraction-service/pull/820)
- Invoice detail API [`#803`](https://github.com/DEFRA/water-abstraction-service/pull/803)
- Feat: Billing batch error handling [`#815`](https://github.com/DEFRA/water-abstraction-service/pull/815)

#### [v1.37.0](https://github.com/DEFRA/water-abstraction-service/compare/v1.36.0...v1.37.0)

> 28 February 2020

- Enhance CSV upload error handling [`#812`](https://github.com/DEFRA/water-abstraction-service/pull/812)
- Select returns reminder template by invitation template used [`#796`](https://github.com/DEFRA/water-abstraction-service/pull/796)
- Fix: Bill run confirmation fixes [`#805`](https://github.com/DEFRA/water-abstraction-service/pull/805)
- Feat: Bookshelf implementation for Events [`#773`](https://github.com/DEFRA/water-abstraction-service/pull/773)
- Feat: Add job handler for annual batches [`#806`](https://github.com/DEFRA/water-abstraction-service/pull/806)
- Bug fix/reallocate connections [`#810`](https://github.com/DEFRA/water-abstraction-service/pull/810)
- Bug fix/import job allocations [`#809`](https://github.com/DEFRA/water-abstraction-service/pull/809)
- Fix: Allow missing serial number in returns xml [`#799`](https://github.com/DEFRA/water-abstraction-service/pull/799)
- Fix: Update process for getting pending imports [`7352b01`](https://github.com/DEFRA/water-abstraction-service/commit/7352b01ba951177255c8e25d55727d9d9d423c00)

#### [v1.36.0](https://github.com/DEFRA/water-abstraction-service/compare/v1.35.0...v1.36.0)

> 21 February 2020

- Adds missing default gen_random_uuid() to column water.licence_agreements.licence_agreement_id [`#804`](https://github.com/DEFRA/water-abstraction-service/pull/804)
- Use config.proxy for requests to charge module [`#800`](https://github.com/DEFRA/water-abstraction-service/pull/800)
- Use proxy for cognito requests [`#797`](https://github.com/DEFRA/water-abstraction-service/pull/797)
- Bugfix/water 2530 batch total [`#793`](https://github.com/DEFRA/water-abstraction-service/pull/793)
- Fixes issue with status of water.billing_batch_charge_version_years [`#789`](https://github.com/DEFRA/water-abstraction-service/pull/789)
- Feat/water 2511 bill run summary cm api [`#782`](https://github.com/DEFRA/water-abstraction-service/pull/782)
- Feat: Updates batch creation for better 409 response [`#786`](https://github.com/DEFRA/water-abstraction-service/pull/786)
- Chore: Update batch statuses [`#785`](https://github.com/DEFRA/water-abstraction-service/pull/785)
- Identify correct charge versions for Two Part Tariff [`#783`](https://github.com/DEFRA/water-abstraction-service/pull/783)
- Add start_date, expired_date, lapsed_date, revoked_date, suspend_from_billing [`#779`](https://github.com/DEFRA/water-abstraction-service/pull/779)
- Fix: Correct notification names in config file [`#780`](https://github.com/DEFRA/water-abstraction-service/pull/780)
- Feat: Adds batch approve, send and delete behaviour [`#777`](https://github.com/DEFRA/water-abstraction-service/pull/777)
- Feat/water 2500 handle supplementary hashes [`#765`](https://github.com/DEFRA/water-abstraction-service/pull/765)
- Randomise return invitation and reminder template [`#772`](https://github.com/DEFRA/water-abstraction-service/pull/772)
- Feat: Adds display name to regions [`#770`](https://github.com/DEFRA/water-abstraction-service/pull/770)
- Chore: Delete acceptance test batches [`#768`](https://github.com/DEFRA/water-abstraction-service/pull/768)
- Feat: Create transaction key on save [`#766`](https://github.com/DEFRA/water-abstraction-service/pull/766)
- Feat: Delete a batch [`#753`](https://github.com/DEFRA/water-abstraction-service/pull/753)
- Feat: Add field for transaction key [`#760`](https://github.com/DEFRA/water-abstraction-service/pull/760)
- Chore: Updates node version in .nvmrc [`#756`](https://github.com/DEFRA/water-abstraction-service/pull/756)
- Feat/WATER-2448 [`#754`](https://github.com/DEFRA/water-abstraction-service/pull/754)
- Chore: Use bookshelf repo for regions endpoint [`#758`](https://github.com/DEFRA/water-abstraction-service/pull/758)
- Add tests for billing batches repo [`#759`](https://github.com/DEFRA/water-abstraction-service/pull/759)
- Feat/water 2474 orm [`#750`](https://github.com/DEFRA/water-abstraction-service/pull/750)
- Feat/water 2475 agreements to cm [`#741`](https://github.com/DEFRA/water-abstraction-service/pull/741)
- Feat/water 2486 cm authentication [`#747`](https://github.com/DEFRA/water-abstraction-service/pull/747)
- Chore: Pre work for upgrading to Node v12 [`#746`](https://github.com/DEFRA/water-abstraction-service/pull/746)
- Add mapper to generate CM data from service models [`#727`](https://github.com/DEFRA/water-abstraction-service/pull/727)
- Feat: Adds endpoint to get batches [`#735`](https://github.com/DEFRA/water-abstraction-service/pull/735)
- Move all mapping code to 'mappers' directory [`94ad680`](https://github.com/DEFRA/water-abstraction-service/commit/94ad680c6355fecabc7851fe9616d1641a429718)
- Removes unwanted package and update code climate [`3b6a52c`](https://github.com/DEFRA/water-abstraction-service/commit/3b6a52c208fdfebab56efd1d64b7fb2015bb9564)
- Fix tests in billing mappers/services [`66ef5a9`](https://github.com/DEFRA/water-abstraction-service/commit/66ef5a9fb5d06f087b8a4259e2952ce56ec81661)
- Experiment with Bookshelf.js models [`8873d5c`](https://github.com/DEFRA/water-abstraction-service/commit/8873d5c92032a20f926a8367185a3af4e7a32fd8)
- Use Bookshelf models to load transaction models [`6a66d54`](https://github.com/DEFRA/water-abstraction-service/commit/6a66d54a01db4c475b353d22ccee8cd7cb999573)
- Updates the transaction hash to include is TPT [`b242434`](https://github.com/DEFRA/water-abstraction-service/commit/b2424348847fe3a9c07e5f2b400fbeb11635b8b9)
- Additional bookshelf models [`4e83dbd`](https://github.com/DEFRA/water-abstraction-service/commit/4e83dbd246ad95244d9b506aa02dd77b04c78c85)
- Additional bookshelf models [`3dae78f`](https://github.com/DEFRA/water-abstraction-service/commit/3dae78ff4bcbaf0d23fb93762721d3b2a6732523)
- Add new notify templates to config. [`399e84d`](https://github.com/DEFRA/water-abstraction-service/commit/399e84d2dd6489d44344dccf85d6d8f7a90209ad)
- Fix remaining tests [`4c3d8ae`](https://github.com/DEFRA/water-abstraction-service/commit/4c3d8ae94d2214a2c5de9b2ce0171d9817fc1bf9)
- Add isCompensationCharge to transaction hash [`4ca23ae`](https://github.com/DEFRA/water-abstraction-service/commit/4ca23ae8f0775d8ba9030cdce868437d47435b9e)
- Add randomisation of return letters [`b16648b`](https://github.com/DEFRA/water-abstraction-service/commit/b16648b3f177d3eaf9038d9af0767793aa42ebda)
- Alter codeclimate to allow more methods [`6e8db1f`](https://github.com/DEFRA/water-abstraction-service/commit/6e8db1f506503a58b4b76ae3bdd403006b1aeec5)
- Move npm from "dependencies" to "engines" in package.json [`d2b0a8d`](https://github.com/DEFRA/water-abstraction-service/commit/d2b0a8df7657e9c46bae38ad5073690361293b2f)

#### [v1.35.0](https://github.com/DEFRA/water-abstraction-service/compare/v1.34.0...v1.35.0)

> 21 January 2020

- Chore: Update connection pool distribution [`#742`](https://github.com/DEFRA/water-abstraction-service/pull/742)
- Fix: Correct scheduling of next job [`#739`](https://github.com/DEFRA/water-abstraction-service/pull/739)
- Feat: Remove customer from a bill run [`#731`](https://github.com/DEFRA/water-abstraction-service/pull/731)
- Compensation charges [`#722`](https://github.com/DEFRA/water-abstraction-service/pull/722)
- Fix: Removes old table name from query [`#726`](https://github.com/DEFRA/water-abstraction-service/pull/726)
- Feat: Capture region data for licences [`#724`](https://github.com/DEFRA/water-abstraction-service/pull/724)
- Feat/water 2438 map transactions to db row [`#719`](https://github.com/DEFRA/water-abstraction-service/pull/719)
- Feat/water 2438 map charges to models [`#710`](https://github.com/DEFRA/water-abstraction-service/pull/710)
- Feature/2436 graceful shutdown [`#711`](https://github.com/DEFRA/water-abstraction-service/pull/711)
- Adding models [`#707`](https://github.com/DEFRA/water-abstraction-service/pull/707)
- Use db.pool from water-abstraction-helpers [`#703`](https://github.com/DEFRA/water-abstraction-service/pull/703)
- Create Role model. Add roles to InvoiceLicence model. [`#704`](https://github.com/DEFRA/water-abstraction-service/pull/704)
- Remove db.query connector which swallowed errors [`#700`](https://github.com/DEFRA/water-abstraction-service/pull/700)
- Feat: Adds transactions to the invoice API [`#691`](https://github.com/DEFRA/water-abstraction-service/pull/691)
- Remove water.lookup table, scheduled job and API [`#699`](https://github.com/DEFRA/water-abstraction-service/pull/699)
- Add licence-level agreements to charge processor [`#688`](https://github.com/DEFRA/water-abstraction-service/pull/688)
- Bump aws-sdk from 2.589.0 to 2.590.0 [`#695`](https://github.com/DEFRA/water-abstraction-service/pull/695)
- Pre-digital service returns show incorrect return volumes in gallons [`#690`](https://github.com/DEFRA/water-abstraction-service/pull/690)
- Update dependencies [`#694`](https://github.com/DEFRA/water-abstraction-service/pull/694)
- Move all access to Notify client to single connector, and use whitelist key for email in non-production environments [`#693`](https://github.com/DEFRA/water-abstraction-service/pull/693)
- Feat/water 2324 [`#680`](https://github.com/DEFRA/water-abstraction-service/pull/680)
- Feat/water 2437 write billing invoice licences v2 [`#684`](https://github.com/DEFRA/water-abstraction-service/pull/684)
- Feat/water 2417 write billing invoices [`#675`](https://github.com/DEFRA/water-abstraction-service/pull/675)
- Fix: Returns notifications job completion [`#681`](https://github.com/DEFRA/water-abstraction-service/pull/681)
- Fix: Ensures LIC_NO is used as index in import schema [`#682`](https://github.com/DEFRA/water-abstraction-service/pull/682)
- Feat: Handle process charge version job completion [`#669`](https://github.com/DEFRA/water-abstraction-service/pull/669)
- Fix: Improves performance of some queries [`#678`](https://github.com/DEFRA/water-abstraction-service/pull/678)
- Add sample data. First tests with sample data [`2802aa1`](https://github.com/DEFRA/water-abstraction-service/commit/2802aa10ca0120fbb570dcf1818a73b7bc007953)
- Add final sample data. Further refactoring, remove redundant code. [`b035bcc`](https://github.com/DEFRA/water-abstraction-service/commit/b035bccc86dfb581db356a682d9e5946e49c139f)
- Add functionality to reallocate within charge element groups [`351cf3b`](https://github.com/DEFRA/water-abstraction-service/commit/351cf3b5df020cb88318356c9f568053b2df2ed9)
- PR feedback [`17601b0`](https://github.com/DEFRA/water-abstraction-service/commit/17601b0a65ee71c94bbf70b9c3ca001a821f04c0)
- Create transactions in CM [`dc42b71`](https://github.com/DEFRA/water-abstraction-service/commit/dc42b71c9c30427ece8f7af621a31ac9c1b4dc2e)
- Experiment with Bookshelf.js models [`b8cf2f8`](https://github.com/DEFRA/water-abstraction-service/commit/b8cf2f81acae97a6fc00d75d7c4a4cc1a0536cd2)
- Use invoice account companies not contacts in response [`472e912`](https://github.com/DEFRA/water-abstraction-service/commit/472e91209ec2af32182f4c898c7ed82d6ffda1ab)
- Add unit tests [`20d2e9c`](https://github.com/DEFRA/water-abstraction-service/commit/20d2e9c79cb4f834d1333c82852c5fbb24780afb)
- Further refactoring based on James' review [`e51c3d3`](https://github.com/DEFRA/water-abstraction-service/commit/e51c3d35196cced001da788f8cccb064dbee7fa8)
- Move all remaining model mapping in charge-processor to services directory [`9d9a10c`](https://github.com/DEFRA/water-abstraction-service/commit/9d9a10c154f6600176d559d6ae70ae8a0a2b1ca3)
- Add tests for create charge job [`eb45836`](https://github.com/DEFRA/water-abstraction-service/commit/eb45836a7a6e92d82f66ff4aacdaf50a9e462817)
- Additional tests [`24649f6`](https://github.com/DEFRA/water-abstraction-service/commit/24649f6a263a61a3aaaa5478d5343642026c9a7d)
- Stricter model validation.  Write transactions to DB table [`ff13b75`](https://github.com/DEFRA/water-abstraction-service/commit/ff13b75d370d3d789cffe3975c4584e9ca301329)
- Refactoring functions to reduce complexity [`1c86843`](https://github.com/DEFRA/water-abstraction-service/commit/1c86843bdef246c52816a09c4d206e546b8aa7f6)
- Add test for transaction service [`29076e9`](https://github.com/DEFRA/water-abstraction-service/commit/29076e9d2359b23d0bddd506ae13f531bb6e6b54)
- Add mapper to generate CM data from service models [`a7bad3d`](https://github.com/DEFRA/water-abstraction-service/commit/a7bad3dac3a061f0b369c6f01444cacebc6da581)
- Add test for mapping transaction to DB row [`b21de26`](https://github.com/DEFRA/water-abstraction-service/commit/b21de261961f1c81f8f43f24b0b26e0b6493db73)
- Additional tests [`f45eeef`](https://github.com/DEFRA/water-abstraction-service/commit/f45eeef78e909c46b5c34e86dcdf56a9ee59cced)
- Additional tests for charge elements repo/service [`3a20e88`](https://github.com/DEFRA/water-abstraction-service/commit/3a20e88915d12e54379ec2dac02830a265719062)
- Add tests for licence service [`e484fc7`](https://github.com/DEFRA/water-abstraction-service/commit/e484fc72c9974524a3f1444902079672c4d36a2e)
- Fixes issue where historic (NALD) returns were shown with incorrect units/conversion [`47b03ec`](https://github.com/DEFRA/water-abstraction-service/commit/47b03ec1ec3b239002b609f6b5e20b1beda55237)
- Move CRM address mapping to own service [`cb570d0`](https://github.com/DEFRA/water-abstraction-service/commit/cb570d0bf4dc0e77b916cfdebf53faca65d7449d)
- Change reshuffling approach. Change Decimal precision to 20. [`665573c`](https://github.com/DEFRA/water-abstraction-service/commit/665573cde13d15dd87b6444ca808d0d748dfb72c)
- Maps and persists Transaction instance to DB row [`56044be`](https://github.com/DEFRA/water-abstraction-service/commit/56044bea3291ed35fc57054575799a5ea2c833e4)
- Fix broken tests [`ebaf159`](https://github.com/DEFRA/water-abstraction-service/commit/ebaf159252127ce6573eef0e36c8d94f8bde81d4)
- Refactor reshuffle-quantities [`e367a66`](https://github.com/DEFRA/water-abstraction-service/commit/e367a6691cd004d263ee5eec10049268bfcfab49)
- Moving company/contact mapper from charge-processor [`efea23c`](https://github.com/DEFRA/water-abstraction-service/commit/efea23c673f3e5a9566dd386f2718e93470f04ec)
- Add tests for BillingTransactionRepository [`5e43eb8`](https://github.com/DEFRA/water-abstraction-service/commit/5e43eb812c335a5741e63438ea5e6245c7de9a43)
- Add test for BillingInvoiceLicenceRepository [`a1246e4`](https://github.com/DEFRA/water-abstraction-service/commit/a1246e4407298c7248f68e38c634dbba0259804d)
- Fix weekly return test data issue [`d072c98`](https://github.com/DEFRA/water-abstraction-service/commit/d072c9878fcc49a80d39634ad9ee9bdeeab82c58)
- Feat: More graceful shutdown [`426fe4e`](https://github.com/DEFRA/water-abstraction-service/commit/426fe4e6dd779252ff0b81c36c0dd72f4aef2793)
- Add additional tests in transaction service [`de7321c`](https://github.com/DEFRA/water-abstraction-service/commit/de7321cb3cc83daeabf9c931b079cace7845fdc2)
- Moving mappers to /services folder [`c72e5b6`](https://github.com/DEFRA/water-abstraction-service/commit/c72e5b6bcf5fa350eea3ec5786ebcf03d90b6d13)
- Add tests to invoice service [`e694828`](https://github.com/DEFRA/water-abstraction-service/commit/e69482833c35b574b5d026a2ca02b65e3687ad9f)
- Add tests for charge module connector [`6d7741d`](https://github.com/DEFRA/water-abstraction-service/commit/6d7741d26bad11a16b0dead847f4e93fcb1813d6)
- Move map/persistence of Invoice to invoice-service.js [`33d503d`](https://github.com/DEFRA/water-abstraction-service/commit/33d503d7cffe92ec2697cbf1464ef2e6c8fd2609)
- Reduce function length of mapToChargeModuleTransaction for CodeClimate [`b37e4c1`](https://github.com/DEFRA/water-abstraction-service/commit/b37e4c1e3b6d5f6d1d87c28845d4f399a8510e3a)
- Additional test for billing controller supplementary batch year range [`433f837`](https://github.com/DEFRA/water-abstraction-service/commit/433f8375a6615973b02a346800ca00ca2ecb1c1e)
- Add test for saving transaction row [`bc0002d`](https://github.com/DEFRA/water-abstraction-service/commit/bc0002d9b06b4be0623e89f31be6538a578038fc)
- Updates dependencies [`b13dee0`](https://github.com/DEFRA/water-abstraction-service/commit/b13dee0c9ef4c59bb942164b151b91b87508969e)
- Add test for creation of transactions in invoice licence [`aad4b26`](https://github.com/DEFRA/water-abstraction-service/commit/aad4b2648b9910ba42eaf08c1d1428d179f05238)
- Add additional test for service return with no version [`e86fa3d`](https://github.com/DEFRA/water-abstraction-service/commit/e86fa3d5cb17f05fcf21d3dfa1f41f1f309289a5)
- Move two part tariff files into correct folder [`1a5032a`](https://github.com/DEFRA/water-abstraction-service/commit/1a5032afd9c0666145111ede66c9cea7882b5abf)
- Move two-part-tariff files to billing module folder [`5e5e5f0`](https://github.com/DEFRA/water-abstraction-service/commit/5e5e5f03c1513bcd24fc6015790591d1711942a2)
- Further refactor checkForReturnsErrors function [`3ee7884`](https://github.com/DEFRA/water-abstraction-service/commit/3ee7884f1a799b89eb951aa1507c5ac1fbb30b23)
- Suggested changes from code review [`bbc7861`](https://github.com/DEFRA/water-abstraction-service/commit/bbc7861af307595c054402acb3a68c9aa5d32d3b)
- Revert to not using public schema for uuid_generate_v4 - for travis migrations to run [`128d18c`](https://github.com/DEFRA/water-abstraction-service/commit/128d18c4996fe55d141d481da313000070690920)
- Move licenceHolder role to role model file [`e60d772`](https://github.com/DEFRA/water-abstraction-service/commit/e60d772790fa1f66fc8060049fbe6ae8a4e45a7c)
- Add transactions to InvoiceLicences in batch [`edb09c9`](https://github.com/DEFRA/water-abstraction-service/commit/edb09c96eb9863ae6da6320c8bbb1f3bc73aa39f)
- Fix issue with dummy licence data where licence had expired in 2020 [`0b24679`](https://github.com/DEFRA/water-abstraction-service/commit/0b24679f329037caa7df19133b7c2a49e46a7b5c)
- Remove references to proRataBillableQuantity [`72ab797`](https://github.com/DEFRA/water-abstraction-service/commit/72ab7974e15a7ce08b1c53fe70ccea60bbed4c9e)
- Add test for role.contact is undefined [`e743176`](https://github.com/DEFRA/water-abstraction-service/commit/e743176c04e9158181d453f489068fb06c1c4cdb)
- Remove the region from the water.licences unique index [`02f01d6`](https://github.com/DEFRA/water-abstraction-service/commit/02f01d629b9d25af1d7e35a7e0b9a68d472b37f5)
- Bugfix with transaction mapping [`06b4888`](https://github.com/DEFRA/water-abstraction-service/commit/06b4888eb96c52f1e6001a49eb4556ed8ec93216)
- Fix linter error [`0c36dfe`](https://github.com/DEFRA/water-abstraction-service/commit/0c36dfe77c7dc062fe1e4ccfe338b11b7bd88305)
- Fix linter error [`d6c81dd`](https://github.com/DEFRA/water-abstraction-service/commit/d6c81dd38028861bf1941cb0cbcf172765274a20)

#### [v1.34.0](https://github.com/DEFRA/water-abstraction-service/compare/v1.33.0...v1.34.0)

> 26 November 2019

- Chore: Correct pluralisation of job files [`#667`](https://github.com/DEFRA/water-abstraction-service/pull/667)
- Feat: Populates charge version years [`#659`](https://github.com/DEFRA/water-abstraction-service/pull/659)
- Feat: Find charge versions for supplementary billing [`#648`](https://github.com/DEFRA/water-abstraction-service/pull/648)
- Fixes pg-boss 3.x issues in import [`#654`](https://github.com/DEFRA/water-abstraction-service/pull/654)
- Reverts to using hapi plugin approach to register PG boss subscribers [`#653`](https://github.com/DEFRA/water-abstraction-service/pull/653)
- Feature/2403 batch financial year range [`#650`](https://github.com/DEFRA/water-abstraction-service/pull/650)
- Modify billing code to use new PG boss plugin [`#652`](https://github.com/DEFRA/water-abstraction-service/pull/652)
- Adds PG boss to hapi as a plugin, upgrades PG boss to 3.x [`#651`](https://github.com/DEFRA/water-abstraction-service/pull/651)
- Feat: Create APIs to surface batch data [`#649`](https://github.com/DEFRA/water-abstraction-service/pull/649)
- Only create valid charge version years [`fbf420b`](https://github.com/DEFRA/water-abstraction-service/commit/fbf420bf6a2a8c37703217ca7236a92e883a86f9)
- Makes formal use of end of financial year [`d017596`](https://github.com/DEFRA/water-abstraction-service/commit/d0175968494c04e39f256c3d70ac7e583cbbc870)
- Removes redundant file [`3ae56df`](https://github.com/DEFRA/water-abstraction-service/commit/3ae56df429310f33c02931002493b97145b415dc)
- Security updates [`6a69ed6`](https://github.com/DEFRA/water-abstraction-service/commit/6a69ed635975b70d9bc823dc00f95988e13fcf88)
- Remove handlebars [`1fdde57`](https://github.com/DEFRA/water-abstraction-service/commit/1fdde573a9b660e92ac12d99ffd93d339b8b6132)
- Simplifies the status values [`0a941f4`](https://github.com/DEFRA/water-abstraction-service/commit/0a941f499dd6359316eba3bd30d4b5c060f8b8c3)
- Remove routes from codeclimate tests [`4134e0e`](https://github.com/DEFRA/water-abstraction-service/commit/4134e0e84dff7bd58177137ae49b665973170e88)

#### [v1.33.0](https://github.com/DEFRA/water-abstraction-service/compare/v1.32.0...v1.33.0)

> 13 November 2019

- Bugfix/water 2399 [`#641`](https://github.com/DEFRA/water-abstraction-service/pull/641)
- Feat: Adds resource to create a billing batch [`#638`](https://github.com/DEFRA/water-abstraction-service/pull/638)
- Feat: Adds new tables for billing [`#634`](https://github.com/DEFRA/water-abstraction-service/pull/634)
- Feat: Adds regions data to water service [`#632`](https://github.com/DEFRA/water-abstraction-service/pull/632)
- Sets up database tables to hold licence agreements [`#628`](https://github.com/DEFRA/water-abstraction-service/pull/628)
- bugfix/WATER-2399 [`8ad48d5`](https://github.com/DEFRA/water-abstraction-service/commit/8ad48d5323a6875428a37828008d2fce47455d48)
- Stop Slack/scheduled jobs running on Travis [`47a1fcf`](https://github.com/DEFRA/water-abstraction-service/commit/47a1fcfef310ff680b1fb756c123af751eac9035)

#### [v1.32.0](https://github.com/DEFRA/water-abstraction-service/compare/v1.31.0...v1.32.0)

> 30 October 2019

- Chore: Allow creating of internal users for testing [`#627`](https://github.com/DEFRA/water-abstraction-service/pull/627)
- Chore: Add some tests for test data generation [`dd86fbc`](https://github.com/DEFRA/water-abstraction-service/commit/dd86fbc23bf11011b39401a2329438864d2503e5)
- Chore: Add test agents for acceptance tests [`d1d2e8e`](https://github.com/DEFRA/water-abstraction-service/commit/d1d2e8ee623471524238172ce5c753e2d464a4a2)

#### [v1.31.0](https://github.com/DEFRA/water-abstraction-service/compare/v1.30.0...v1.31.0)

> 15 October 2019

- Feat: Adds acceptance test setup and tear down resources [`#622`](https://github.com/DEFRA/water-abstraction-service/pull/622)

#### [v1.30.0](https://github.com/DEFRA/water-abstraction-service/compare/v1.29.0...v1.30.0)

> 7 October 2019

- Removes old returns reminder notification, adds one with same logic a… [`#600`](https://github.com/DEFRA/water-abstraction-service/pull/600)
- Add isFinal flag to return metadata. [`#601`](https://github.com/DEFRA/water-abstraction-service/pull/601)
- Remove scheduled renewal email notification [`#602`](https://github.com/DEFRA/water-abstraction-service/pull/602)
- When sending returns invitations, only contact returns agent(s) via email if they exist [`#595`](https://github.com/DEFRA/water-abstraction-service/pull/595)
- Add template IDs for return notifications [`#591`](https://github.com/DEFRA/water-abstraction-service/pull/591)
- Add EIUC source to charge version API [`#588`](https://github.com/DEFRA/water-abstraction-service/pull/588)
- Initial work on returns notification updates [`#586`](https://github.com/DEFRA/water-abstraction-service/pull/586)
- Fix: Adds missing derogation clause [`#582`](https://github.com/DEFRA/water-abstraction-service/pull/582)
- Fix: Only create contacts for non null version [`#577`](https://github.com/DEFRA/water-abstraction-service/pull/577)
- Add endpoint to get company details by documentId [`#576`](https://github.com/DEFRA/water-abstraction-service/pull/576)
- Add tests for createNotificationData [`3f55978`](https://github.com/DEFRA/water-abstraction-service/commit/3f5597805d905a8edc5b66443cf5e44e7a1aeb27)
- Additional tests [`b27d5e5`](https://github.com/DEFRA/water-abstraction-service/commit/b27d5e5097e172f69c66159612efbb88b445bc14)
- Add test for CRM contact list to water contact model list factory [`2c39066`](https://github.com/DEFRA/water-abstraction-service/commit/2c3906605d954ff608fabd539b4868c69fddaf54)
- Add tests for building list of contacts for returns notification [`6f57e78`](https://github.com/DEFRA/water-abstraction-service/commit/6f57e780edd3c15748ddf41043089c78069e227c)
- Add tests for getRecipientList [`a4496eb`](https://github.com/DEFRA/water-abstraction-service/commit/a4496eb92fc2b0a2afbcfcea758ce32840daa3a7)
- fix return invitation tests [`fb9e78d`](https://github.com/DEFRA/water-abstraction-service/commit/fb9e78d2f16f0dc47e532c743d070271b8538760)
- Further tests [`ad9ec92`](https://github.com/DEFRA/water-abstraction-service/commit/ad9ec92d60e303c6621bf08f7edb8eddd23cb36b)
- Fix linter error [`62ffdcc`](https://github.com/DEFRA/water-abstraction-service/commit/62ffdccee6222c6e1d96d2bd106897e5f9e22329)

#### [v1.29.0](https://github.com/DEFRA/water-abstraction-service/compare/v1.28.0...v1.29.0)

> 4 September 2019

- Feat: Return charge versions for expired licences [`#572`](https://github.com/DEFRA/water-abstraction-service/pull/572)
- Feat: Unlink Licence [`#569`](https://github.com/DEFRA/water-abstraction-service/pull/569)
- Add financial agreement types tables [`#571`](https://github.com/DEFRA/water-abstraction-service/pull/571)
- Feat: Include purpose description in charge versions [`#564`](https://github.com/DEFRA/water-abstraction-service/pull/564)
- Add disabled account user data when getting user status. [`#562`](https://github.com/DEFRA/water-abstraction-service/pull/562)
- Initial work on charge version API [`#559`](https://github.com/DEFRA/water-abstraction-service/pull/559)
- Add check for rowCount with conditional actions based on value. [`d9e9c2b`](https://github.com/DEFRA/water-abstraction-service/commit/d9e9c2be228a4e78256c18850930bcba916697df)
- Remove unlinkLicence function from documents connector [`80d3488`](https://github.com/DEFRA/water-abstraction-service/commit/80d3488ebe429e8d0aeba1f4b18bd1fedff46451)
- Updates the gitignore file to include vscode [`418f641`](https://github.com/DEFRA/water-abstraction-service/commit/418f641a57df8e7bb7326d38af8ffd2cf8444827)

#### [v1.28.0](https://github.com/DEFRA/water-abstraction-service/compare/v1.27.0...v1.28.0)

> 22 August 2019

- Update internal user check [`#558`](https://github.com/DEFRA/water-abstraction-service/pull/558)
- Add routes for patch/delete internal user.  Amend post user to handle… [`#556`](https://github.com/DEFRA/water-abstraction-service/pull/556)
- Add charge agreements table [`#552`](https://github.com/DEFRA/water-abstraction-service/pull/552)
- Create tables for charge versions/elements [`#551`](https://github.com/DEFRA/water-abstraction-service/pull/551)
- Feat/water 2243 update email address [`#542`](https://github.com/DEFRA/water-abstraction-service/pull/542)
- Feat: Adds add internal endpoint [`#537`](https://github.com/DEFRA/water-abstraction-service/pull/537)
- Feat: Change email functionality [`#521`](https://github.com/DEFRA/water-abstraction-service/pull/521)
- Chore/2169 add test for status endpoint [`#527`](https://github.com/DEFRA/water-abstraction-service/pull/527)
- Update dependencies [`6ef51d8`](https://github.com/DEFRA/water-abstraction-service/commit/6ef51d8a392c9300acbe020035a5214450bf6db7)
- Additional work on update email flow [`e0f1237`](https://github.com/DEFRA/water-abstraction-service/commit/e0f12379ddb18e73e17b6a49748ba5d774a12f4d)
- Refactor. Add tests. [`12f009d`](https://github.com/DEFRA/water-abstraction-service/commit/12f009df815e2e05c87f1d9bc37c6f3ae6037ce5)
- Refactor. Add tests. [`2f177ab`](https://github.com/DEFRA/water-abstraction-service/commit/2f177ab48956f42ada918a27c084f9e60cc1c67a)
- Add routes for patch/delete internal user.  Amend post user to handle disabled user accounts [`768c740`](https://github.com/DEFRA/water-abstraction-service/commit/768c7409d0ee7b660464c58f069940e6d2316d00)
- Remove API calls from controller. Make return objects consistent. [`10c7684`](https://github.com/DEFRA/water-abstraction-service/commit/10c7684b239bf07de3a075278351802c7f2d0cc5)
- Add tests for an existing but disabled user account [`4491947`](https://github.com/DEFRA/water-abstraction-service/commit/4491947efad35b1b5ab7684c13ba4be1a8f05bc6)
- Add tests for patch method [`2846b7d`](https://github.com/DEFRA/water-abstraction-service/commit/2846b7d3dbd357e7fd76266baa98cfb912fd9b94)
- Add tests for delete call [`501ef1d`](https://github.com/DEFRA/water-abstraction-service/commit/501ef1d8d3eb5e25c8d0907bfd0638d0b290ec94)
- Refactor. Add tests. [`e1d2eb0`](https://github.com/DEFRA/water-abstraction-service/commit/e1d2eb0ca3bf18a1e866f1986358594db8a9ac04)
- Add IDM connector tests [`97cdb36`](https://github.com/DEFRA/water-abstraction-service/commit/97cdb36704028ded704a3163b2fdd1d6cca4db23)
- Fix tests. [`2cfb450`](https://github.com/DEFRA/water-abstraction-service/commit/2cfb450a291c3c97d04d69c84f404cf08a5f4046)
- Make code and terminology consistent with IDM code. [`0642ed4`](https://github.com/DEFRA/water-abstraction-service/commit/0642ed4019248c2f9d48400e412218fed3eed365)
- Chore: Adds test for /status endpoint [`7d38ea5`](https://github.com/DEFRA/water-abstraction-service/commit/7d38ea59133d772ee1e0edaa79db9bbeeef0acc9)
- Fix issue with re-enabling disabled users.  Only send new user email on account creation.  Adjust PATCH endpoint to include user ID. [`699c97a`](https://github.com/DEFRA/water-abstraction-service/commit/699c97aef6d59e5eef9125a82af94b09e43a5c02)
- Update reference to service uri in idm connector tests. [`8798bce`](https://github.com/DEFRA/water-abstraction-service/commit/8798bce1147df134f37b21ff2134f448fcee620c)
- Config tweak [`9032af1`](https://github.com/DEFRA/water-abstraction-service/commit/9032af1cf7ecb38fad17541661f9f3dc91dde571)
- Fix tests. [`64b4428`](https://github.com/DEFRA/water-abstraction-service/commit/64b4428a8b207b536db187a9033ecd130edfdd4a)
- Updated internal user checks to use application in config [`461388e`](https://github.com/DEFRA/water-abstraction-service/commit/461388e2962bf8e2c04d8b97fbb98b86afbfa05c)
- Fixed sign in link url. [`a1057df`](https://github.com/DEFRA/water-abstraction-service/commit/a1057df3d7f70c61f9ad177be64040515da49b43)
- Remove redundant code, replace with existing method [`d8f40d3`](https://github.com/DEFRA/water-abstraction-service/commit/d8f40d3363eb95095e93c9adbdfc9529df22a4ce)
- Update internal user check in users controller. [`0e02506`](https://github.com/DEFRA/water-abstraction-service/commit/0e02506164a19ee54b4b94bf2e5f8c8db59f6f8a)
- Remove accidental test.only [`4aa396d`](https://github.com/DEFRA/water-abstraction-service/commit/4aa396d28ec9a7bf49012c9a7e0237a16df6a0cf)
- Fix issue with migrations [`5e3d29c`](https://github.com/DEFRA/water-abstraction-service/commit/5e3d29c32a7f1246dc1c15c0a78369e18de2c15c)
- Merge tag 'charging-sprint-1' into develop [`97ece94`](https://github.com/DEFRA/water-abstraction-service/commit/97ece9497b06dcb085614c0c0057bfbbd9b7e1a4)
- Fix Joi validation in routes [`3bc3b11`](https://github.com/DEFRA/water-abstraction-service/commit/3bc3b114859666727d4797c60143e6e29264485e)
- Fix test [`c0bcc4d`](https://github.com/DEFRA/water-abstraction-service/commit/c0bcc4de10365c9632a795a75f5ecb598662ed88)
- Fixed sign in link url. [`8713047`](https://github.com/DEFRA/water-abstraction-service/commit/87130479d94c1837b53d75366c7b73f988b2a0db)
- Fix test [`18e9717`](https://github.com/DEFRA/water-abstraction-service/commit/18e9717783232ac3b9af9f833f67c65e84a9c63b)
- Fixed sign in link url. [`65f72b7`](https://github.com/DEFRA/water-abstraction-service/commit/65f72b7be50941d9909d84e5e77be983938c3add)
- Fix test [`273b867`](https://github.com/DEFRA/water-abstraction-service/commit/273b8672e79cce419ee8dde548eb36da10a173e6)

#### [v1.27.0](https://github.com/DEFRA/water-abstraction-service/compare/v1.25.4...v1.27.0)

> 24 July 2019

- Feat: Adds service status endpoint [`#495`](https://github.com/DEFRA/water-abstraction-service/pull/495)
- Fix: Loosens csv schema validation [`#516`](https://github.com/DEFRA/water-abstraction-service/pull/516)
- Fix: Prevent email status check time getting to large [`#514`](https://github.com/DEFRA/water-abstraction-service/pull/514)
- Fixes issue where IDM users client returned all users if externalIds … [`#505`](https://github.com/DEFRA/water-abstraction-service/pull/505)
- Refactor. Add tests. [`fedb5d4`](https://github.com/DEFRA/water-abstraction-service/commit/fedb5d4d7719ad91e3bd21f98c9d53e8264fb149)
- Feat: Change email functionality [`701c3c3`](https://github.com/DEFRA/water-abstraction-service/commit/701c3c3017a51c05ddffa1f2e13fe2143f17ff18)
- Fix: Updates means of determining return frequency [`f739e91`](https://github.com/DEFRA/water-abstraction-service/commit/f739e91d0b443223eb3705732bc0d988a10b269d)
- Fixed sign in link url. [`d608810`](https://github.com/DEFRA/water-abstraction-service/commit/d60881039daa75bef40641cecc8ff14b82692509)
- Merge tag 'sprint-42' into develop [`ab179fe`](https://github.com/DEFRA/water-abstraction-service/commit/ab179fe2900e4f2a8cb9b0666a0b3a8f1363f523)
- Upgrade puppeteer to 1.18.1 [`cdc59c4`](https://github.com/DEFRA/water-abstraction-service/commit/cdc59c4e0c272ed6f30401154d7d614e28279fd2)
- Merge tag 'puppeteer-version' into develop [`90d24d5`](https://github.com/DEFRA/water-abstraction-service/commit/90d24d5ae27b51ea2a3ed546c35118fcde46a570)

#### [v1.26.0](https://github.com/DEFRA/water-abstraction-service/compare/v1.25.3...v1.26.0)

> 9 July 2019

- Fix: Updates means of determining return frequency [`#498`](https://github.com/DEFRA/water-abstraction-service/pull/498)
- Merge tag 'internal-expired-licence' into develop [`f833a48`](https://github.com/DEFRA/water-abstraction-service/commit/f833a4861358dcd540c1187073b64b864b4245cf)

#### [v1.25.4](https://github.com/DEFRA/water-abstraction-service/compare/v1.26.0...v1.25.4)

> 11 July 2019

- Upgrade puppeteer to 1.18.1 [`e5472bf`](https://github.com/DEFRA/water-abstraction-service/commit/e5472bff4d3e00d4cfae63387f9d0140f1987757)

#### [v1.25.3](https://github.com/DEFRA/water-abstraction-service/compare/v1.25.2...v1.25.3)

> 4 July 2019

- Fixes issue where IDM users client returned all users if externalIds … [`#505`](https://github.com/DEFRA/water-abstraction-service/pull/505)
- Add includeExpired query param to documents routes to make them compatible with UI [`7309801`](https://github.com/DEFRA/water-abstraction-service/commit/7309801dd78ea84d517c1a165bf22cb493f93120)
- Merge tag 'returns-reminder-csv' into develop [`b265550`](https://github.com/DEFRA/water-abstraction-service/commit/b26555020aaae80c7d2170325c945d49db940a1c)

#### [v1.25.2](https://github.com/DEFRA/water-abstraction-service/compare/v1.25.1...v1.25.2)

> 3 July 2019

- Upgrade hapi-pg-rest-api to v5 [`6a3b236`](https://github.com/DEFRA/water-abstraction-service/commit/6a3b23642bd7b95918fd1b974039b4f9ba377a4a)

#### [v1.25.1](https://github.com/DEFRA/water-abstraction-service/compare/v1.25.0...v1.25.1)

> 2 July 2019

- For getCurrentDueReturns service call, filter client side when licences are excluded [`#500`](https://github.com/DEFRA/water-abstraction-service/pull/500)
- For getCurrentDueReturns service call, filter client side when licences are excluded [`#500`](https://github.com/DEFRA/water-abstraction-service/pull/500)

#### [v1.25.0](https://github.com/DEFRA/water-abstraction-service/compare/v1.24.0...v1.25.0)

> 27 June 2019

- Bugfix/water 2157 scheduled renewal email [`#484`](https://github.com/DEFRA/water-abstraction-service/pull/484)
- Bugfix/water 2157 scheduled renewal email [`#482`](https://github.com/DEFRA/water-abstraction-service/pull/482)
- Bugfix/water 2157 scheduled renewal email [`#484`](https://github.com/DEFRA/water-abstraction-service/pull/484)
- Bugfix/water 2157 scheduled renewal email [`#482`](https://github.com/DEFRA/water-abstraction-service/pull/482)
- Feat/water 1795 [`#475`](https://github.com/DEFRA/water-abstraction-service/pull/475)
- Fix: Fixes issues with chunked void returns [`#480`](https://github.com/DEFRA/water-abstraction-service/pull/480)
- Set end date in permit repo correctly on import to minimum of expired/lapsed/revoked date [`#478`](https://github.com/DEFRA/water-abstraction-service/pull/478)
- Fix: Update next check dates for notify status checks [`#477`](https://github.com/DEFRA/water-abstraction-service/pull/477)
- Consumes the void-returns using a PATCH [`97d6802`](https://github.com/DEFRA/water-abstraction-service/commit/97d68028bcb11aa2067c8d500937d8938f1093c5)

#### [v1.24.0](https://github.com/DEFRA/water-abstraction-service/compare/v1.23.0...v1.24.0)

> 12 June 2019

- Ignore empty returns in CSV [`#474`](https://github.com/DEFRA/water-abstraction-service/pull/474)
- Adjust sessions API for catbox REST API interface [`#462`](https://github.com/DEFRA/water-abstraction-service/pull/462)
- Chore: Moves the port from env to config [`#459`](https://github.com/DEFRA/water-abstraction-service/pull/459)

#### [v1.23.0](https://github.com/DEFRA/water-abstraction-service/compare/v1.22.0...v1.23.0)

> 29 May 2019

- Fix: Tidies up bad logger code [`#456`](https://github.com/DEFRA/water-abstraction-service/pull/456)
- Fix: Makes the CSV validation less strict [`#451`](https://github.com/DEFRA/water-abstraction-service/pull/451)
- Fix: Do not import licences without a version [`#447`](https://github.com/DEFRA/water-abstraction-service/pull/447)
- Chore: Update logger to latest version [`#445`](https://github.com/DEFRA/water-abstraction-service/pull/445)
- Feat: Import data into new schema when in progress [`#437`](https://github.com/DEFRA/water-abstraction-service/pull/437)
- Fix: Prevent large void return requests [`#434`](https://github.com/DEFRA/water-abstraction-service/pull/434)
- Chore: Updates eslint and adds ignore file [`#432`](https://github.com/DEFRA/water-abstraction-service/pull/432)

#### [v1.22.0](https://github.com/DEFRA/water-abstraction-service/compare/v1.20.1...v1.22.0)

> 15 May 2019

- Adds a query param to the company returns filter so that by default, only returns that can be entered via the digital service are returned. [`#440`](https://github.com/DEFRA/water-abstraction-service/pull/440)
- Feat: Adds XML upload tests [`#420`](https://github.com/DEFRA/water-abstraction-service/pull/420)
- Convert CSV and XML returns upload code to adapters [`#430`](https://github.com/DEFRA/water-abstraction-service/pull/430)
- Add CSV to JSON mapper [`#427`](https://github.com/DEFRA/water-abstraction-service/pull/427)
- Feat: Adds returns CSV validator [`#426`](https://github.com/DEFRA/water-abstraction-service/pull/426)
- Add company returns API endpoint [`#422`](https://github.com/DEFRA/water-abstraction-service/pull/422)
- Add return invitation notification to batch notifications [`#416`](https://github.com/DEFRA/water-abstraction-service/pull/416)
- Returns reminder cover letter changes [`#414`](https://github.com/DEFRA/water-abstraction-service/pull/414)
- Remove old code for Notify status checks [`#409`](https://github.com/DEFRA/water-abstraction-service/pull/409)
- Update copy for returns reminder letter [`#408`](https://github.com/DEFRA/water-abstraction-service/pull/408)
- Fixes return due dates for some split log scenarios to be 28 days aft… [`#407`](https://github.com/DEFRA/water-abstraction-service/pull/407)
- Bugfix/water 2067 [`#395`](https://github.com/DEFRA/water-abstraction-service/pull/395)
- Remove old returns invitation code [`c572d3f`](https://github.com/DEFRA/water-abstraction-service/commit/c572d3fa919dd490d10c240971d352f5e0864b8d)
- Tests for stringify-values, Contact.generateId, mapContactAddress [`893a7b1`](https://github.com/DEFRA/water-abstraction-service/commit/893a7b10e23c55dd60739a67c0f784bb7a5e7a46)
- Add tests for returns invite batch notification config [`5e45288`](https://github.com/DEFRA/water-abstraction-service/commit/5e452882b8ded27ab1bc3c2f331251a2e1b039d5)
- Add tests for markAsProcessed [`5f818ca`](https://github.com/DEFRA/water-abstraction-service/commit/5f818cafe86df22f94fcb50a6d959de3ce8bd7a9)
- Remove old XML helpers, reduce complexity of XML return frequency mapper [`861cf03`](https://github.com/DEFRA/water-abstraction-service/commit/861cf03c3c5442c7e88b19f716a110f0c5b76010)
- Resolve issues with generated CSV passing validation [`321bf59`](https://github.com/DEFRA/water-abstraction-service/commit/321bf59cd2562756eb437383f888a5c778a444da)
- Remove commented code [`dc80257`](https://github.com/DEFRA/water-abstraction-service/commit/dc802572b851b9dc4c4e6ddebb27a222242d3968)

#### [v1.20.1](https://github.com/DEFRA/water-abstraction-service/compare/v1.19.0...v1.20.1)

> 23 April 2019

- Only log error level messages in production [`#404`](https://github.com/DEFRA/water-abstraction-service/pull/404)
- Feat: Include expired licences in internal search [`#394`](https://github.com/DEFRA/water-abstraction-service/pull/394)
- Merge tag 'public_beta_1.19_hotfix_1' into develop [`d76d5b4`](https://github.com/DEFRA/water-abstraction-service/commit/d76d5b4deac5d719ed7dde997bb5934e51b56837)
- Fix XML returns issue where monthly return mapping was incorrect if date in XML not start of month [`9894ffa`](https://github.com/DEFRA/water-abstraction-service/commit/9894ffa58106f349e2fb1db2d1d5cee54884b46e)
- Merge tag 'public_beta_1.19_hotfix_1' into develop [`afa0d65`](https://github.com/DEFRA/water-abstraction-service/commit/afa0d659f5dfaa8188468c1295e7bbecf6ba5aab)
- Fix issue with XML to JSON return upload mapping and validation [`f9a629e`](https://github.com/DEFRA/water-abstraction-service/commit/f9a629e7e7b100a41caa63ab92e8e5fdd33887f6)
- Merge tag 'public_beta_1.19_hotfix_1' into develop [`841496e`](https://github.com/DEFRA/water-abstraction-service/commit/841496ed2d8b8985b95fa316d5e95d11c45d88f1)
- Fixes issues with XML return upload mapping to JSON: [`a5868a4`](https://github.com/DEFRA/water-abstraction-service/commit/a5868a42b34e7e3aa3fd0403f1b7027463758ed8)
- Merge tag 'public_beta_1.19' into develop [`682517c`](https://github.com/DEFRA/water-abstraction-service/commit/682517c9454c73757698e3a96af4c6b8ba7ecc77)

#### [v1.19.0](https://github.com/DEFRA/water-abstraction-service/compare/v1.18.0...v1.19.0)

> 9 April 2019

- Increase payload limit for uploading return XML [`#392`](https://github.com/DEFRA/water-abstraction-service/pull/392)
- Include production months 45/46 in logic to display XML upload link [`#387`](https://github.com/DEFRA/water-abstraction-service/pull/387)
- Fixes issue where nil return could not be uploaded via XML because re… [`#384`](https://github.com/DEFRA/water-abstraction-service/pull/384)
- Add new fields to return model to support winter returns UI changes [`#375`](https://github.com/DEFRA/water-abstraction-service/pull/375)
- Fixes issue where nil return could not be uploaded via XML because return frequency omitted from mapped JSON [`ca99cd8`](https://github.com/DEFRA/water-abstraction-service/commit/ca99cd867941a5697843433f3ea78fc04380ddc1)

#### [v1.18.0](https://github.com/DEFRA/water-abstraction-service/compare/v1.17.1...v1.18.0)

> 19 March 2019

- Fix: Fixes to the returns form [`#372`](https://github.com/DEFRA/water-abstraction-service/pull/372)
- Feat: Updates paper forms with latest content [`#364`](https://github.com/DEFRA/water-abstraction-service/pull/364)
- Tweaks to upload validation messaging [`#361`](https://github.com/DEFRA/water-abstraction-service/pull/361)
- Feat: Update paper form issuing [`#360`](https://github.com/DEFRA/water-abstraction-service/pull/360)
- Fixes an issue where the users API only returned the first 100 docume… [`#358`](https://github.com/DEFRA/water-abstraction-service/pull/358)
- Fix issues with upload return submission [`#356`](https://github.com/DEFRA/water-abstraction-service/pull/356)
- Fixes an issue with return upload preview where return ID was expected in query param instead of URL path [`#355`](https://github.com/DEFRA/water-abstraction-service/pull/355)
- Fix issues with XML to JSON mapping [`#354`](https://github.com/DEFRA/water-abstraction-service/pull/354)
- Feat: Updates the returns form with latest content [`#348`](https://github.com/DEFRA/water-abstraction-service/pull/348)
- Feat: Adds a script to create/delete test returns [`#338`](https://github.com/DEFRA/water-abstraction-service/pull/338)
- Upload XML issues [`#349`](https://github.com/DEFRA/water-abstraction-service/pull/349)
- Add isUpload flag to return metadata [`#350`](https://github.com/DEFRA/water-abstraction-service/pull/350)
- Feat: Adds more detailed error info to events [`#336`](https://github.com/DEFRA/water-abstraction-service/pull/336)
- Feat: Use common return functions from helpers library [`#334`](https://github.com/DEFRA/water-abstraction-service/pull/334)
- Feat/water 1929 [`#335`](https://github.com/DEFRA/water-abstraction-service/pull/335)
- Include company entity ID in users detail endpoint [`#333`](https://github.com/DEFRA/water-abstraction-service/pull/333)
- Feature/1935 updated json to xml mapping [`#331`](https://github.com/DEFRA/water-abstraction-service/pull/331)
- Feat: Adds bulk returns upload job [`#325`](https://github.com/DEFRA/water-abstraction-service/pull/325)
- Adds bulk return submit endpoint.  Rewrite lib/event.js to use plain … [`#324`](https://github.com/DEFRA/water-abstraction-service/pull/324)
- Add schema validation and xml to json mapping functionality [`#322`](https://github.com/DEFRA/water-abstraction-service/pull/322)
- Implements the latest version of the logger [`#320`](https://github.com/DEFRA/water-abstraction-service/pull/320)
- Feat/water 1928 [`#319`](https://github.com/DEFRA/water-abstraction-service/pull/319)
- Bug fix/1864 null start date [`#314`](https://github.com/DEFRA/water-abstraction-service/pull/314)
- Adds an API endpoint to review an uploaded returns JSON file [`#313`](https://github.com/DEFRA/water-abstraction-service/pull/313)
- Adds a module to perform tests on bulk uploaded returns data [`#309`](https://github.com/DEFRA/water-abstraction-service/pull/309)
- Feat: Adds returns upload PG Boss jobs [`#307`](https://github.com/DEFRA/water-abstraction-service/pull/307)
- Feat: Upload return upload to S3 [`#299`](https://github.com/DEFRA/water-abstraction-service/pull/299)
- Build(deps): [Security] Bump extend from 3.0.1 to 3.0.2 [`#298`](https://github.com/DEFRA/water-abstraction-service/pull/298)
- Feat: Map XML to JSON using return model shape [`9820f8e`](https://github.com/DEFRA/water-abstraction-service/commit/9820f8e84af19acf0dbeb341b370df7d9e4da6af)
- Use logger from water-abstraction-helpers module [`d8837fd`](https://github.com/DEFRA/water-abstraction-service/commit/d8837fd5fcf6d121960da3abcf9415705f79d4f6)
- Code climate feedback [`5ffe184`](https://github.com/DEFRA/water-abstraction-service/commit/5ffe18446002abaa367335b171897b14f69ae5d1)
- Code climate recommendations [`5c7fe31`](https://github.com/DEFRA/water-abstraction-service/commit/5c7fe3150d2275f40da93e572f5197e7b306de15)
- Incorporates new event factory [`645ead9`](https://github.com/DEFRA/water-abstraction-service/commit/645ead9a8ab9525af268c28a073add1072de0e70)
- - Fix issues with JSON to XML mapping when data not found. [`d154869`](https://github.com/DEFRA/water-abstraction-service/commit/d154869a078a79f8bcd1d39d9911115cd098a57b)
- Code climate fixes [`9a81f17`](https://github.com/DEFRA/water-abstraction-service/commit/9a81f17bab068ca962683e82356c1b5864177683)
- Reduce complexity of validator [`eb93925`](https://github.com/DEFRA/water-abstraction-service/commit/eb93925f9df82a4551aa05ff04dda24aed77cbe4)
- Fix: Handles empty abstraction reform licences [`8ff1d9b`](https://github.com/DEFRA/water-abstraction-service/commit/8ff1d9baa04cb88acc37cc00a7f1124e13d689df)
- getUserByUserName returns undefined when not found [`fd23957`](https://github.com/DEFRA/water-abstraction-service/commit/fd23957e66745026ec7c797a56e1fdc98a065688)
- More code climate feedback [`42ce4bf`](https://github.com/DEFRA/water-abstraction-service/commit/42ce4bfe488b8af918e8fbc9a1448565635563af)
- Code climate feedback [`1705b95`](https://github.com/DEFRA/water-abstraction-service/commit/1705b9539d56898033228497517a168a4217a56d)
- Updates idm connector to target specific application [`454afdf`](https://github.com/DEFRA/water-abstraction-service/commit/454afdfd5744cc413b0f2f13b8309fdaeff035b3)
- Fix comment [`98d70da`](https://github.com/DEFRA/water-abstraction-service/commit/98d70da24f1f334da697c0075ce1b34c9c293c63)

#### [v1.17.1](https://github.com/DEFRA/water-abstraction-service/compare/v1.17.0...v1.17.1)

> 7 February 2019

- Find all pages of document matches [`#297`](https://github.com/DEFRA/water-abstraction-service/pull/297)

#### [v1.17.0](https://github.com/DEFRA/water-abstraction-service/compare/v1.16.0...v1.17.0)

> 7 February 2019

- Adds licence holder full name to document summary API endpoint [`#296`](https://github.com/DEFRA/water-abstraction-service/pull/296)
- Only display quantities if there are a single set across all purposes [`#295`](https://github.com/DEFRA/water-abstraction-service/pull/295)
- Fix: Filter communications by successful send [`#294`](https://github.com/DEFRA/water-abstraction-service/pull/294)
- Remove null aggregate quantities from document summary API call [`#293`](https://github.com/DEFRA/water-abstraction-service/pull/293)
- Feat: Adds additional data to communication responses [`#292`](https://github.com/DEFRA/water-abstraction-service/pull/292)
- Feat: Adds a communication resource [`#289`](https://github.com/DEFRA/water-abstraction-service/pull/289)
- fix: package.json & package-lock.json to reduce vulnerabilities [`#288`](https://github.com/DEFRA/water-abstraction-service/pull/288)
- Feat/water 1893 changes [`#287`](https://github.com/DEFRA/water-abstraction-service/pull/287)
- Add gauging station data to licence summary endpoint [`#286`](https://github.com/DEFRA/water-abstraction-service/pull/286)
- Feat: Handles internal users in user status endpoint [`#280`](https://github.com/DEFRA/water-abstraction-service/pull/280)
- Add new endpoint for licence summary [`#285`](https://github.com/DEFRA/water-abstraction-service/pull/285)
- Feat: Adds resource to get document users [`#284`](https://github.com/DEFRA/water-abstraction-service/pull/284)
- Adds isSummer boolean flag to returns imported to return service [`#283`](https://github.com/DEFRA/water-abstraction-service/pull/283)
- Implement internal search API in water service [`#279`](https://github.com/DEFRA/water-abstraction-service/pull/279)
- Feat: Adds user status resource [`#278`](https://github.com/DEFRA/water-abstraction-service/pull/278)
- Fix licence holder name field for documents in internal search API [`27886c8`](https://github.com/DEFRA/water-abstraction-service/commit/27886c85bddcbb4f93e3e07cf99e9f1f06dad7ce)
- Spelling correct and expose more verification data [`a670f08`](https://github.com/DEFRA/water-abstraction-service/commit/a670f0860aca7a9ee87fbe480e8ffe15ba796d49)

#### [v1.16.0](https://github.com/DEFRA/water-abstraction-service/compare/v1.15.0...v1.16.0)

> 23 January 2019

- Formats recipient name correctly for returns invitation / final remin… [`#276`](https://github.com/DEFRA/water-abstraction-service/pull/276)
- Add ability to send return final reminder [`#274`](https://github.com/DEFRA/water-abstraction-service/pull/274)
- Fix: Updates format cycle end date calculation [`#272`](https://github.com/DEFRA/water-abstraction-service/pull/272)
- Modifies import process to set status of invalid return cycles to void rather than deleting them [`#271`](https://github.com/DEFRA/water-abstraction-service/pull/271)
- Resolves an issue where gauging stations retrieved from flood API were always considered inactive if they had no status, which is an optional field. [`#263`](https://github.com/DEFRA/water-abstraction-service/pull/263)
- Resolve 'null value in column "status" violates not-null constraint' log error [`#261`](https://github.com/DEFRA/water-abstraction-service/pull/261)
- Uses a unique id for points and conditions data [`#248`](https://github.com/DEFRA/water-abstraction-service/pull/248)
- Feat: A document licence resource [`#245`](https://github.com/DEFRA/water-abstraction-service/pull/245)
- Chore: Adds repository field to package.json [`#244`](https://github.com/DEFRA/water-abstraction-service/pull/244)
- Adds /documents/{documentId}/licences/conditions [`c5522b7`](https://github.com/DEFRA/water-abstraction-service/commit/c5522b72223ea98766704145c261926a2649cbf9)
- Adds /documents/{documentId}/licences/conditions [`e2651ab`](https://github.com/DEFRA/water-abstraction-service/commit/e2651ab84f4aeb07a856971a62e69c693b8a5683)
- Codeclimate feedback [`fa4d014`](https://github.com/DEFRA/water-abstraction-service/commit/fa4d014c39a09644275b2dee6a5faefc35555852)
- Returns facade was using wrong date for comparison [`a3130eb`](https://github.com/DEFRA/water-abstraction-service/commit/a3130ebf5781e65eded4e294e4ded5b7f0dd636a)

#### v1.15.0

> 12 December 2018

- Fix: Investigation of isNil validation error [`#241`](https://github.com/DEFRA/water-abstraction-service/pull/241)
- Retry sending message on failure [`#240`](https://github.com/DEFRA/water-abstraction-service/pull/240)
- Feat: Improves logging [`#239`](https://github.com/DEFRA/water-abstraction-service/pull/239)
- Bugfix/water 1675 [`#236`](https://github.com/DEFRA/water-abstraction-service/pull/236)
- Use NPM module for hapi-pg-rest-api [`#234`](https://github.com/DEFRA/water-abstraction-service/pull/234)
- Feat/water 1734 [`#231`](https://github.com/DEFRA/water-abstraction-service/pull/231)
- Bug fix/water 1724 task runner logging [`#226`](https://github.com/DEFRA/water-abstraction-service/pull/226)
- Feat: Remove old NALD password from zip extract [`#225`](https://github.com/DEFRA/water-abstraction-service/pull/225)
- Fixes an issue where errors thrown during PG boss subscribers were not being logged [`#221`](https://github.com/DEFRA/water-abstraction-service/pull/221)
- Logs additional data if returns request fails validation check.  Also… [`#220`](https://github.com/DEFRA/water-abstraction-service/pull/220)
- Add return reminder template.  Add QR code containing return ID to bo… [`#214`](https://github.com/DEFRA/water-abstraction-service/pull/214)
- Bump hapi from 17.5.2 to 17.8.1 [`#218`](https://github.com/DEFRA/water-abstraction-service/pull/218)
- Bump code from 5.2.0 to 5.2.4 [`#216`](https://github.com/DEFRA/water-abstraction-service/pull/216)
- Feat: Consolidate env variables [`#204`](https://github.com/DEFRA/water-abstraction-service/pull/204)
- Feat: Align with developer standards [`#213`](https://github.com/DEFRA/water-abstraction-service/pull/213)
- Fix: Use Sun - Sat weeks for NALD [`#210`](https://github.com/DEFRA/water-abstraction-service/pull/210)
- Feat: Adds under query flag to return model [`#189`](https://github.com/DEFRA/water-abstraction-service/pull/189)
- Feat: Api connector logging improvement [`#188`](https://github.com/DEFRA/water-abstraction-service/pull/188)
- Remove width from cover-content container which allowed content to overflow its flexbox container [`#187`](https://github.com/DEFRA/water-abstraction-service/pull/187)
- Ensure logger is configured before use in import process [`#186`](https://github.com/DEFRA/water-abstraction-service/pull/186)
- Feat: Adds proxy support for logging to Errbit [`#185`](https://github.com/DEFRA/water-abstraction-service/pull/185)
- Fix: Move password from code to environment [`#184`](https://github.com/DEFRA/water-abstraction-service/pull/184)
- Add return API endpoint to patch return - status / received date [`#182`](https://github.com/DEFRA/water-abstraction-service/pull/182)
- Feature: Logging improvements [`#183`](https://github.com/DEFRA/water-abstraction-service/pull/183)
- Add verbose mode to return messages from API call [`#181`](https://github.com/DEFRA/water-abstraction-service/pull/181)
- Fix duplicate word in guidance on return form [`#180`](https://github.com/DEFRA/water-abstraction-service/pull/180)
- Fix page count and address font size [`#179`](https://github.com/DEFRA/water-abstraction-service/pull/179)
- Bugfix/water 1625 [`#178`](https://github.com/DEFRA/water-abstraction-service/pull/178)
- Feature: Adds dynamic returns form [`#177`](https://github.com/DEFRA/water-abstraction-service/pull/177)
- Adjust Joi schema to allow meter details in abstractionVolumes flow [`#176`](https://github.com/DEFRA/water-abstraction-service/pull/176)
- Update fields depend on return cycle [`#174`](https://github.com/DEFRA/water-abstraction-service/pull/174)
- Enqueue messages sequentially rather than in parallel.  Longer expiry time for queued messages.  Prioritise email/SMS over letters for sending. [`#173`](https://github.com/DEFRA/water-abstraction-service/pull/173)
- Fix: Update airbrake js [`#172`](https://github.com/DEFRA/water-abstraction-service/pull/172)
- Hand off queuing of Notify messages to PG Boss [`#171`](https://github.com/DEFRA/water-abstraction-service/pull/171)
- Fix: Handle null purposes aliases [`#170`](https://github.com/DEFRA/water-abstraction-service/pull/170)
- Fetch licence contacts in batches [`#169`](https://github.com/DEFRA/water-abstraction-service/pull/169)
- Fix: Adds the dueDate to the expected payload [`#168`](https://github.com/DEFRA/water-abstraction-service/pull/168)
- Fix: Change due date to 28 days after end date [`#167`](https://github.com/DEFRA/water-abstraction-service/pull/167)
- Tweaks to picklist data / API [`#166`](https://github.com/DEFRA/water-abstraction-service/pull/166)
- Feat: Improved due returns messaging [`#165`](https://github.com/DEFRA/water-abstraction-service/pull/165)
- Add picklist API in water service [`#164`](https://github.com/DEFRA/water-abstraction-service/pull/164)
- Bugfix/spring clean [`#161`](https://github.com/DEFRA/water-abstraction-service/pull/161)
- Feature: Add purpose alias to return metadata [`#163`](https://github.com/DEFRA/water-abstraction-service/pull/163)
- Take format time-limited start/end date into account when calculating… [`#160`](https://github.com/DEFRA/water-abstraction-service/pull/160)
- Feat/water 1407 [`#157`](https://github.com/DEFRA/water-abstraction-service/pull/157)
- Remove full URL from QR code [`#159`](https://github.com/DEFRA/water-abstraction-service/pull/159)
- Show JSON in paper form for test purposes.  Add additional data to pa… [`#158`](https://github.com/DEFRA/water-abstraction-service/pull/158)
- Render PDF HTML content directly with Nunjucks rather than via URL request [`#156`](https://github.com/DEFRA/water-abstraction-service/pull/156)
- Use internal URL for PDF generation [`#155`](https://github.com/DEFRA/water-abstraction-service/pull/155)
- Feat: Handle meter readings in return model [`#154`](https://github.com/DEFRA/water-abstraction-service/pull/154)
- Hopefully resolve proxy issues with PDF generation [`#153`](https://github.com/DEFRA/water-abstraction-service/pull/153)
- Feat/water 1475 [`#152`](https://github.com/DEFRA/water-abstraction-service/pull/152)
- Fix allowed return statuses [`#151`](https://github.com/DEFRA/water-abstraction-service/pull/151)
- Unit converters should pass through null value [`#150`](https://github.com/DEFRA/water-abstraction-service/pull/150)
- Feat/water 1438 [`#149`](https://github.com/DEFRA/water-abstraction-service/pull/149)
- Feat/water 1438 [`#148`](https://github.com/DEFRA/water-abstraction-service/pull/148)
- Improve split log handling [`#147`](https://github.com/DEFRA/water-abstraction-service/pull/147)
- Feat/water 1352 [`#145`](https://github.com/DEFRA/water-abstraction-service/pull/145)
- Calculate current version in permit repo.  CRM IsCurrent flag determi… [`#146`](https://github.com/DEFRA/water-abstraction-service/pull/146)
- Feat: Future licences are not deemed to be current [`#144`](https://github.com/DEFRA/water-abstraction-service/pull/144)
- Add return format data to licence data imported to permit repo [`#143`](https://github.com/DEFRA/water-abstraction-service/pull/143)
- Split returns into current / not current [`#142`](https://github.com/DEFRA/water-abstraction-service/pull/142)
- Feat/calculate cycles 2 [`#141`](https://github.com/DEFRA/water-abstraction-service/pull/141)
- Feat/calculate cycles 2 [`#140`](https://github.com/DEFRA/water-abstraction-service/pull/140)
- Feat/return lines units [`#139`](https://github.com/DEFRA/water-abstraction-service/pull/139)
- Include received date in upsert [`#137`](https://github.com/DEFRA/water-abstraction-service/pull/137)
- Remove await from Slack posts [`#136`](https://github.com/DEFRA/water-abstraction-service/pull/136)
- Feat/import returns date [`#135`](https://github.com/DEFRA/water-abstraction-service/pull/135)
- Fix units [`#134`](https://github.com/DEFRA/water-abstraction-service/pull/134)
- Import efficiency [`#133`](https://github.com/DEFRA/water-abstraction-service/pull/133)
- Feat/water 1255 [`#132`](https://github.com/DEFRA/water-abstraction-service/pull/132)
- Add indexes to fields used in import [`#131`](https://github.com/DEFRA/water-abstraction-service/pull/131)
- Fix issue with notification log.  Also change poss interval timing [`#130`](https://github.com/DEFRA/water-abstraction-service/pull/130)
- Post data to permit repo / CRM / import log in batches [`#129`](https://github.com/DEFRA/water-abstraction-service/pull/129)
- Adds connection pool logging [`#128`](https://github.com/DEFRA/water-abstraction-service/pull/128)
- Tweaks to expiry content [`#126`](https://github.com/DEFRA/water-abstraction-service/pull/126)
- Add variables to notification configs [`#125`](https://github.com/DEFRA/water-abstraction-service/pull/125)
- Changes the upsert to also update the subtype [`#124`](https://github.com/DEFRA/water-abstraction-service/pull/124)
- Fix issue with loading licences in notifications by removing paginated results call [`#123`](https://github.com/DEFRA/water-abstraction-service/pull/123)
- Import licences in batches [`#122`](https://github.com/DEFRA/water-abstraction-service/pull/122)
- Use single connection pool [`#121`](https://github.com/DEFRA/water-abstraction-service/pull/121)
- Feat/import tweaks [`#120`](https://github.com/DEFRA/water-abstraction-service/pull/120)
- Only watch the file system in local dev [`#119`](https://github.com/DEFRA/water-abstraction-service/pull/119)
- Use single job for download/extract CSV until we can do this in S3 bucket [`#118`](https://github.com/DEFRA/water-abstraction-service/pull/118)
- Feat/water 1261 mk2 [`#117`](https://github.com/DEFRA/water-abstraction-service/pull/117)
- Disable errbit [`#116`](https://github.com/DEFRA/water-abstraction-service/pull/116)
- Add VmL version back to permit repo packet [`#115`](https://github.com/DEFRA/water-abstraction-service/pull/115)
- Migration to delete deprecated scheduled tasks for NALD import [`#114`](https://github.com/DEFRA/water-abstraction-service/pull/114)
- Bugfix/import file path slash [`#113`](https://github.com/DEFRA/water-abstraction-service/pull/113)
- Remove duplicate forward slash from file path [`#112`](https://github.com/DEFRA/water-abstraction-service/pull/112)
- Fix status page [`#111`](https://github.com/DEFRA/water-abstraction-service/pull/111)
- Feat/boss import poc [`#109`](https://github.com/DEFRA/water-abstraction-service/pull/109)
- Feat/water 1179 [`#108`](https://github.com/DEFRA/water-abstraction-service/pull/108)
- Bugfix/convert flow units [`#107`](https://github.com/DEFRA/water-abstraction-service/pull/107)
- Feat/notify failsafe [`#105`](https://github.com/DEFRA/water-abstraction-service/pull/105)
- Convert ml/d to m3/s in river flow data [`#106`](https://github.com/DEFRA/water-abstraction-service/pull/106)
- WATER-1151: Email titles. [`#104`](https://github.com/DEFRA/water-abstraction-service/pull/104)
- WATER-1151 and WATER-1153 [`#103`](https://github.com/DEFRA/water-abstraction-service/pull/103)
- chore: Config and linting [`#102`](https://github.com/DEFRA/water-abstraction-service/pull/102)
- Ensure 'error' in status column in counted as error in notification event log [`#101`](https://github.com/DEFRA/water-abstraction-service/pull/101)
- Feat/pg boss [`#99`](https://github.com/DEFRA/water-abstraction-service/pull/99)
- bugfix/WATER-1086: Plurals in notifications [`#98`](https://github.com/DEFRA/water-abstraction-service/pull/98)
- Tolerate missing fields in API data [`#94`](https://github.com/DEFRA/water-abstraction-service/pull/94)
- Include active status in data returned from river levels API [`#93`](https://github.com/DEFRA/water-abstraction-service/pull/93)
- Create local cache of gauging stations, update list daily [`#92`](https://github.com/DEFRA/water-abstraction-service/pull/92)
- Remove proxy:null when communicating with river levels API [`#91`](https://github.com/DEFRA/water-abstraction-service/pull/91)
- Feat/water 1090 [`#90`](https://github.com/DEFRA/water-abstraction-service/pull/90)
- Fix migrations [`#89`](https://github.com/DEFRA/water-abstraction-service/pull/89)
- Remove notify search criteria in update notify status task [`#87`](https://github.com/DEFRA/water-abstraction-service/pull/87)
- Poll notify for message status for 3 days following message send [`#86`](https://github.com/DEFRA/water-abstraction-service/pull/86)
- Switch back to original scheduler implementation [`#85`](https://github.com/DEFRA/water-abstraction-service/pull/85)
- Add migrations for notify templates and scheduled task [`#83`](https://github.com/DEFRA/water-abstraction-service/pull/83)
- Notification tasks DB migration [`#82`](https://github.com/DEFRA/water-abstraction-service/pull/82)
- Stop slack error breaking S3 import [`#81`](https://github.com/DEFRA/water-abstraction-service/pull/81)
- Run scheduled tasks in separate process [`#80`](https://github.com/DEFRA/water-abstraction-service/pull/80)
- Set date and unique reference in rendered template [`#79`](https://github.com/DEFRA/water-abstraction-service/pull/79)
- Fetch all pages of results from permit repo.  Allow custom template t… [`#78`](https://github.com/DEFRA/water-abstraction-service/pull/78)
- Contact dedupe case insensitive and remove null fields [`#77`](https://github.com/DEFRA/water-abstraction-service/pull/77)
- Remove slack [`#76`](https://github.com/DEFRA/water-abstraction-service/pull/76)
- Feat/notification event metadata [`#75`](https://github.com/DEFRA/water-abstraction-service/pull/75)
- Remove output escaping from Nunjucks rendered markdown template output [`#74`](https://github.com/DEFRA/water-abstraction-service/pull/74)
- Include subject personalisation for email notifications [`#73`](https://github.com/DEFRA/water-abstraction-service/pull/73)
- Fix email recipient for notifications [`#72`](https://github.com/DEFRA/water-abstraction-service/pull/72)
- Feat/water 938 [`#71`](https://github.com/DEFRA/water-abstraction-service/pull/71)
- Feat/water 937 [`#70`](https://github.com/DEFRA/water-abstraction-service/pull/70)
- Prioritise contacts for notifications in revised order [`#69`](https://github.com/DEFRA/water-abstraction-service/pull/69)
- Add task config table/API endpoint for notifications [`#68`](https://github.com/DEFRA/water-abstraction-service/pull/68)
- Feat/lookup data [`#67`](https://github.com/DEFRA/water-abstraction-service/pull/67)
- Add error handling to NALD import [`#66`](https://github.com/DEFRA/water-abstraction-service/pull/66)
- Allow scheduled tasks to be updated via API [`#65`](https://github.com/DEFRA/water-abstraction-service/pull/65)
- Allow scheduled tasks to be updated via API [`#64`](https://github.com/DEFRA/water-abstraction-service/pull/64)
- Add support for import concurrency env var, default to 1 [`#62`](https://github.com/DEFRA/water-abstraction-service/pull/62)
- Use area import email if available for notifications [`#63`](https://github.com/DEFRA/water-abstraction-service/pull/63)
- Remove git+ [`#60`](https://github.com/DEFRA/water-abstraction-service/pull/60)
- Fix issue with document name endpoint removed from CRM in renewal ema… [`#59`](https://github.com/DEFRA/water-abstraction-service/pull/59)
- Contact de-duplication for notification sending [`#58`](https://github.com/DEFRA/water-abstraction-service/pull/58)
- fix inconsistency in primary key handling [`#57`](https://github.com/DEFRA/water-abstraction-service/pull/57)
- endpoint for event log and changes to support additional notification… [`#56`](https://github.com/DEFRA/water-abstraction-service/pull/56)
- Create new config option '$' for import task which imports registered… [`#55`](https://github.com/DEFRA/water-abstraction-service/pull/55)
- Record last run start time [`#54`](https://github.com/DEFRA/water-abstraction-service/pull/54)
- Feat/import multiple licence nos [`#53`](https://github.com/DEFRA/water-abstraction-service/pull/53)
- Include expiry date in current licence query.  Get latest version by … [`#52`](https://github.com/DEFRA/water-abstraction-service/pull/52)
- Include IsCurrent flag in CRM metadata.  current_version property nul… [`#51`](https://github.com/DEFRA/water-abstraction-service/pull/51)
- Fix linter errors [`#50`](https://github.com/DEFRA/water-abstraction-service/pull/50)
- daily s3 update [`#48`](https://github.com/DEFRA/water-abstraction-service/pull/48)
- Only include gulp in dev deps [`#46`](https://github.com/DEFRA/water-abstraction-service/pull/46)
- Bugfix/water 797 [`#47`](https://github.com/DEFRA/water-abstraction-service/pull/47)
- Feat/water 741 [`#45`](https://github.com/DEFRA/water-abstraction-service/pull/45)
- Feat/coverage path [`#44`](https://github.com/DEFRA/water-abstraction-service/pull/44)
- Added ability to schedule update to existing records (currently only … [`#42`](https://github.com/DEFRA/water-abstraction-service/pull/42)
- Feature/fix issue with contact methods causing multiple contacts [`#41`](https://github.com/DEFRA/water-abstraction-service/pull/41)
- improve scheduler resiliency [`#40`](https://github.com/DEFRA/water-abstraction-service/pull/40)
- Update .snyk file, update dependencies [`#39`](https://github.com/DEFRA/water-abstraction-service/pull/39)
- always_used_scheduler_for_notify [`#38`](https://github.com/DEFRA/water-abstraction-service/pull/38)
- update-hapi-pgi-rest-api [`#36`](https://github.com/DEFRA/water-abstraction-service/pull/36)
- update unit tests [`#35`](https://github.com/DEFRA/water-abstraction-service/pull/35)
- new endpoints for admin use [`#33`](https://github.com/DEFRA/water-abstraction-service/pull/33)
- integrate cutom licence name with expiry notification [`#32`](https://github.com/DEFRA/water-abstraction-service/pull/32)
- notify templates endpoint [`#31`](https://github.com/DEFRA/water-abstraction-service/pull/31)
- Add endpoint for scheduled notifications [`#30`](https://github.com/DEFRA/water-abstraction-service/pull/30)
- update import process so that the licence_start_dt and licence_end_dt… [`#24`](https://github.com/DEFRA/water-abstraction-service/pull/24)
- add the notify templates [`#29`](https://github.com/DEFRA/water-abstraction-service/pull/29)
- water-742 [`#28`](https://github.com/DEFRA/water-abstraction-service/pull/28)
- implement scheduled notifications [`#26`](https://github.com/DEFRA/water-abstraction-service/pull/26)
- remove crm migrations [`#23`](https://github.com/DEFRA/water-abstraction-service/pull/23)
- added current_version object to licence [`#22`](https://github.com/DEFRA/water-abstraction-service/pull/22)
- Feat/water 600 [`#21`](https://github.com/DEFRA/water-abstraction-service/pull/21)
- Modify import to exclude missing licences and import in batches [`#20`](https://github.com/DEFRA/water-abstraction-service/pull/20)
- Feat/import selected licences [`#19`](https://github.com/DEFRA/water-abstraction-service/pull/19)
- fix issue with nald data import [`#18`](https://github.com/DEFRA/water-abstraction-service/pull/18)
- quieter import [`#17`](https://github.com/DEFRA/water-abstraction-service/pull/17)
- Ignore data files loaded from NALD [`#12`](https://github.com/DEFRA/water-abstraction-service/pull/12)
- and point_source object to purpose points [`#16`](https://github.com/DEFRA/water-abstraction-service/pull/16)
- Lookup point using point id not purpose id... [`#15`](https://github.com/DEFRA/water-abstraction-service/pull/15)
- Feature/adjustments to nald import [`#14`](https://github.com/DEFRA/water-abstraction-service/pull/14)
- Rework to not use the ABSTAT_WFD table (which turns out to be a view) [`#13`](https://github.com/DEFRA/water-abstraction-service/pull/13)
- Adjust version.parties [`#11`](https://github.com/DEFRA/water-abstraction-service/pull/11)
- Renamed purposes [`#10`](https://github.com/DEFRA/water-abstraction-service/pull/10)
- Get previous licence versions [`#9`](https://github.com/DEFRA/water-abstraction-service/pull/9)
- Tweaking scheduler API config [`#8`](https://github.com/DEFRA/water-abstraction-service/pull/8)
- nald import scheduler [`#7`](https://github.com/DEFRA/water-abstraction-service/pull/7)
- Notify service [`#6`](https://github.com/DEFRA/water-abstraction-service/pull/6)
- Proxy-agent for s3 downloads [`#5`](https://github.com/DEFRA/water-abstraction-service/pull/5)
- Update to latest hapi-pg-rest-api [`#4`](https://github.com/DEFRA/water-abstraction-service/pull/4)
- Add proxy to knox [`#3`](https://github.com/DEFRA/water-abstraction-service/pull/3)
- import nald data from s3 to import schema and extract individual lice… [`#2`](https://github.com/DEFRA/water-abstraction-service/pull/2)
- Feat/water 648 [`#1`](https://github.com/DEFRA/water-abstraction-service/pull/1)
- Removes gulp [`7eae680`](https://github.com/DEFRA/water-abstraction-service/commit/7eae6800499c2d0f84cb9022353c402cacd925be)
- Render Nunjucks templates [`1bf27f4`](https://github.com/DEFRA/water-abstraction-service/commit/1bf27f45f111747a986f68fc1feccc5622581a30)
- bugfix/WATER-1086: Notifications updates [`6e18ed7`](https://github.com/DEFRA/water-abstraction-service/commit/6e18ed7f8e8579efe509565737a0a794f6116b21)
- Send scheduled notifications with logging to events table and entities/licences/event data logged to scheduled notifications table [`93d4c9f`](https://github.com/DEFRA/water-abstraction-service/commit/93d4c9f10935b8a9bae2c3319cbae4f602e6cdef)
- Adds changelog and versioning [`9a912a2`](https://github.com/DEFRA/water-abstraction-service/commit/9a912a26a4950b3631b4f0aa87c7a99db3a16917)
- Updating vulnerable packages [`a9ad557`](https://github.com/DEFRA/water-abstraction-service/commit/a9ad557d1f8577c291870536adc4c98ec0dddfb0)
- Update notification task configs for HOF resume, stop, and warning to include separate fields for contact name and email/tel [`d59255f`](https://github.com/DEFRA/water-abstraction-service/commit/d59255fab5b8395c6163569ab604abc846a60d13)
- Feature: Further returns form content changes [`2f4a7ff`](https://github.com/DEFRA/water-abstraction-service/commit/2f4a7ff67552e5fdd942f808b72e3ea5abe8ca63)
- Fix unit test [`667f609`](https://github.com/DEFRA/water-abstraction-service/commit/667f60940048d503d3c9d864baf8f8d4225c6bea)
- Include IsCurrent flag in CRM metadata.  current_version property null if expired/revoked etc. [`36b8abf`](https://github.com/DEFRA/water-abstraction-service/commit/36b8abf9eaddae5b6a316ec1e9a48b573c1fd4cb)
- Fix: Task runner logging [`fe80e43`](https://github.com/DEFRA/water-abstraction-service/commit/fe80e43e2c9c183d9dc6da10f0b706c4ca517ee7)
- Completed notification preview step [`23e2100`](https://github.com/DEFRA/water-abstraction-service/commit/23e2100b8b7055987949b8b45c61a97114f2c292)
- Organise notifications into module [`b3a25d7`](https://github.com/DEFRA/water-abstraction-service/commit/b3a25d766de8ec40d4d4a6b8397a29988fa25385)
- Testing [`89d2b39`](https://github.com/DEFRA/water-abstraction-service/commit/89d2b399906dd4ffe7f163f179798afed2d5413b)
- Remove notify keys from DB [`850888a`](https://github.com/DEFRA/water-abstraction-service/commit/850888a5bebabbe536d2e983a3c6724b06da89b6)
- Log event [`6a4f397`](https://github.com/DEFRA/water-abstraction-service/commit/6a4f397c63dc15559d409958fc348938ae1dec30)
- Fix date issue in NALD unit test [`5103931`](https://github.com/DEFRA/water-abstraction-service/commit/51039311744d7efe853552a532b3a54a0cfb9393)
- Create initial river levels API in water service [`1402665`](https://github.com/DEFRA/water-abstraction-service/commit/1402665003e562da80c3171eb5068420acf12738)
- Tidying notification creation into factory [`32b511d`](https://github.com/DEFRA/water-abstraction-service/commit/32b511d56050ff8b6420723562a14bb1c7ab80d2)
- endpoint for event log and changes to support additional notification fields [`8973da6`](https://github.com/DEFRA/water-abstraction-service/commit/8973da60bba3c16e572e946c57b5450699c7a8b1)
- Add ability to import multiple licences with CSV in licence_ref field [`316ffd8`](https://github.com/DEFRA/water-abstraction-service/commit/316ffd86e32712bd18a7d29d545b94939fb7e9d5)
- Add API for lookup data.  Adds scheduled task to import NALD_REP_UNITS to lookup data table. [`332a43d`](https://github.com/DEFRA/water-abstraction-service/commit/332a43ddc018345058f847abdce416b3c205225a)
- Added new task to update events log with number of sent/pending/errored messages in a notification batch [`fe60dd9`](https://github.com/DEFRA/water-abstraction-service/commit/fe60dd9cd4be90d9aad072008fbd5dc0463da69e)
- Fix issue with document name endpoint removed from CRM in renewal email scheduled task [`99fadcd`](https://github.com/DEFRA/water-abstraction-service/commit/99fadcdcd8922f7bf42b45c85359705f15e56312)
- Add lookup data API [`8569540`](https://github.com/DEFRA/water-abstraction-service/commit/8569540863f052b24833486f1d90cb75452f3de2)
- Fix: Removes extra privacy page [`4c1d146`](https://github.com/DEFRA/water-abstraction-service/commit/4c1d14610464fba194115553d5d8fd5208fe80a5)
- Paper forms content updates [`ef45666`](https://github.com/DEFRA/water-abstraction-service/commit/ef45666f636a2a2b4166cd2543e536e5d6ee4c04)
- Calculate return cycle split date based on mod log only if reason is SUCC [`bf8d171`](https://github.com/DEFRA/water-abstraction-service/commit/bf8d17118bee64222afd9372c1826009b02e6ab9)
- Fetch all pages of results from permit repo.  Allow custom template types with fallback to default [`7a3c22a`](https://github.com/DEFRA/water-abstraction-service/commit/7a3c22a4fbccf56ab8fd1017866f078ae6c1926f)
- Further updates to returns paper forms [`ed8d37e`](https://github.com/DEFRA/water-abstraction-service/commit/ed8d37eccc184c7f46374c263c861f22bdf345c9)
- Move CRM call to connector code [`fc26b55`](https://github.com/DEFRA/water-abstraction-service/commit/fc26b55ebecc3cbe3120796b8466e51768d1d31a)
- Reduce function length [`b1c9671`](https://github.com/DEFRA/water-abstraction-service/commit/b1c9671a55c89f4adb57b9fd2c047ca8ef94779b)
- Create new config option '$' for import task which imports registered licences only [`0ab09c3`](https://github.com/DEFRA/water-abstraction-service/commit/0ab09c3a76e7a0a49abdb3ff1157455f29de7ba6)
- Rough implementation of sending notifications [`ace2c61`](https://github.com/DEFRA/water-abstraction-service/commit/ace2c6171750eb9fd683d0bedcaa220bbb7e9642)
- Provide a message with logger.error statements [`8221a9e`](https://github.com/DEFRA/water-abstraction-service/commit/8221a9ef824f31f942be9376fc5399a5c659337c)
- Reduce code complexity [`863bcef`](https://github.com/DEFRA/water-abstraction-service/commit/863bcef9424b45156759dff2e7d92633c6ef8641)
- Fix taskrunner linter errors [`723965f`](https://github.com/DEFRA/water-abstraction-service/commit/723965f66c3156a2353301362dab7cdd1144301e)
- Remove console.log [`ee9cf7c`](https://github.com/DEFRA/water-abstraction-service/commit/ee9cf7cdb1bcbffc9297e999aa17af72ba552f87)
- Reduce function length [`ca3ec9c`](https://github.com/DEFRA/water-abstraction-service/commit/ca3ec9c443071e2c8bdf4e8c3de3a417e10d57f3)
- Fix: Fixes an area with the due_date [`1b70998`](https://github.com/DEFRA/water-abstraction-service/commit/1b70998403bbc25ca1f81d155303c6eba9f28b2b)
- Fix issue with async load of licence data [`28d0bf0`](https://github.com/DEFRA/water-abstraction-service/commit/28d0bf04b804777cefa9410d79724b3810527ab0)
- Fix linter error [`c012523`](https://github.com/DEFRA/water-abstraction-service/commit/c0125238c293bc5682483a8b577e887ed16c3a0a)
- Fix linter error [`2965543`](https://github.com/DEFRA/water-abstraction-service/commit/2965543c6e0e9d8758c3842b4b1a8727e8511ad7)
- Use the latest code climate test reporter [`d755029`](https://github.com/DEFRA/water-abstraction-service/commit/d755029e8fd4eccc150a3240c84f74cf53682efd)
- Reduce function length [`3ab762d`](https://github.com/DEFRA/water-abstraction-service/commit/3ab762df0fccb7e2acdd108850e3d22b219c790c)
- Tidy folder structure [`c430983`](https://github.com/DEFRA/water-abstraction-service/commit/c430983318c8a08c63bfedf0bb8b0f18fc19a592)
- Tweak to river level API [`c8ab5c9`](https://github.com/DEFRA/water-abstraction-service/commit/c8ab5c98f752867af71048b22f95a4893c02af28)
- Alter send notification API to use single JSON payload [`c44f75c`](https://github.com/DEFRA/water-abstraction-service/commit/c44f75c3d6f33d1d388f493e220c7fcf70594150)
- Add CSV parse npm module [`acb69e1`](https://github.com/DEFRA/water-abstraction-service/commit/acb69e17d753540d636dfa39d0695527772f4b9b)
- Add event metadata [`3fa6be0`](https://github.com/DEFRA/water-abstraction-service/commit/3fa6be015d491ca7b06c57331e8890f7d154174e)
- Ensure pending import correctly updated [`13b4bef`](https://github.com/DEFRA/water-abstraction-service/commit/13b4bef562d0a7624034b95e5ffa9feab2e781cd)
- Updates HAPI PG Api to v4.0.1 [`c58c077`](https://github.com/DEFRA/water-abstraction-service/commit/c58c07736359f4f9c9fbfaa4ce0878ab6ed846c2)
- Include expiry date in current licence query.  Get latest version by issue/incr number. [`6f78f31`](https://github.com/DEFRA/water-abstraction-service/commit/6f78f31d482c81d36b4d468c78a02603680171ec)
- Include time in updated timestamp [`1c924ad`](https://github.com/DEFRA/water-abstraction-service/commit/1c924ad2015ea2cf56b64e57983155ca02d38d26)
- reinstate full licence load [`7ce43c1`](https://github.com/DEFRA/water-abstraction-service/commit/7ce43c16f3a174beadfb3be41a979b02f0622a9c)
- MAke NALD temp dir if none exists [`52fdafc`](https://github.com/DEFRA/water-abstraction-service/commit/52fdafca9152d1ce81bbb7accf2fc501eb90d928)
- Make AR analysis cron job hourly for QA [`c0978db`](https://github.com/DEFRA/water-abstraction-service/commit/c0978db5467e9aa00c09c6b9a5e2d661334d5c4b)
- Merge tag 'public_beta_1.13' into develop [`0f73ebb`](https://github.com/DEFRA/water-abstraction-service/commit/0f73ebb7ad9440ad30e785dfc4fc249570cb0b00)
- Updates har-validator version [`7142bac`](https://github.com/DEFRA/water-abstraction-service/commit/7142bac1a75b724d919ea16f2b35c24bccb5f5b4)
- Log notification JSON [`9f9096b`](https://github.com/DEFRA/water-abstraction-service/commit/9f9096b7871aa6e11a6b6bd2b77fd12496ec04a4)
- Decrease PG boss job check interval to default [`2b1f062`](https://github.com/DEFRA/water-abstraction-service/commit/2b1f062ba7bc4b71067937fe432b0969e9c1f889)
- Linter tweaks [`2ea10ba`](https://github.com/DEFRA/water-abstraction-service/commit/2ea10baf276046f7c65b56384b8ca6dad8fe7459)
- Remove test notify key from travis.yml [`f08678b`](https://github.com/DEFRA/water-abstraction-service/commit/f08678b96de2d78c7fc44cd94ed190e19331fc28)
- Move codeclimate reporter id to travis environment [`db05f3e`](https://github.com/DEFRA/water-abstraction-service/commit/db05f3e97d74f57d8d18354a31810ebb76ad1911)
- Merge tag 'public_beta_1.11' into develop [`cde21a5`](https://github.com/DEFRA/water-abstraction-service/commit/cde21a5ee7d5526a3f09e61a70a7b368e99cac0f)
- Remove console.log [`b43f92a`](https://github.com/DEFRA/water-abstraction-service/commit/b43f92a34764978262fff7c0101e63f4f4f14df5)
- Fix: Uses the due date for returns due date [`b985b0e`](https://github.com/DEFRA/water-abstraction-service/commit/b985b0e751e5a97f759c6ea5c7424182735985d3)
- Merge tag 'public_beta_1.9' into develop [`9655f2d`](https://github.com/DEFRA/water-abstraction-service/commit/9655f2d897693d736fcb1e03736f960848982585)
- Merge tag 'public_beta_1.8' into develop [`80c2c41`](https://github.com/DEFRA/water-abstraction-service/commit/80c2c41b1d039ac421d79438294f41fb054cae32)
- Merge tag 'public_beta_1.6' into develop [`336c149`](https://github.com/DEFRA/water-abstraction-service/commit/336c149c4bd3e071ae0d6f0181bc085d5505fee5)
- breaking changes JWT + node 8 [`7890305`](https://github.com/DEFRA/water-abstraction-service/commit/789030585473a10e6bc08a0c6cc2a861bd2df586)
- More licences... [`5b5a51f`](https://github.com/DEFRA/water-abstraction-service/commit/5b5a51f6b23311eb207a67980216e71acdb92b35)
- Work on dummy licence creator for testing [`3e09697`](https://github.com/DEFRA/water-abstraction-service/commit/3e09697f9917287b28bfcfa67b26af408897259d)
- Tweak to lab config [`dd16cff`](https://github.com/DEFRA/water-abstraction-service/commit/dd16cff8a26e5bc3369195d5a69f98d5949c5883)
- Initial travis integration [`d740f9e`](https://github.com/DEFRA/water-abstraction-service/commit/d740f9e337b8893dc130eadcf750a55db347faaa)
- Add unit test [`07f73c8`](https://github.com/DEFRA/water-abstraction-service/commit/07f73c89209a61b5badaa569b63ad79abf11363e)
- NALD structure [`3c985fd`](https://github.com/DEFRA/water-abstraction-service/commit/3c985fd92e934362af83e02fcf962fde4a63b81a)
- Add migration to import all licences individually [`306726a`](https://github.com/DEFRA/water-abstraction-service/commit/306726a216bd02a0899f158568741ddbd2706c92)
- Fix lint errors [`307a295`](https://github.com/DEFRA/water-abstraction-service/commit/307a295539e3d4bf337deb0e9975d42a409acf56)
- Initial work on creating anonymised licence data [`fb979f0`](https://github.com/DEFRA/water-abstraction-service/commit/fb979f0121703a6dfca39dac79aa1d2cbd6b4aaa)
- Lint errors, add lint to travis CI [`e63fa26`](https://github.com/DEFRA/water-abstraction-service/commit/e63fa267a734572b6f4c57c244adca1b7a3cf29f)
- Reduced test coverage due to not calling notify API immediately - TODO: call notify via testkey to verify payload.. [`d579f81`](https://github.com/DEFRA/water-abstraction-service/commit/d579f8177bfc0bcdd728af18c1fafbcfd36b395a)
- Working dummy licence creator [`3d96a2e`](https://github.com/DEFRA/water-abstraction-service/commit/3d96a2e04d3b6ccbd6fe5ebb28cbbe496aed101d)
- Refactor data load so same code is used in test [`1250a8b`](https://github.com/DEFRA/water-abstraction-service/commit/1250a8bc945e6cd821ab9875de3ef8669ea681d0)
- Create dummy CSV directory before write [`2d5692c`](https://github.com/DEFRA/water-abstraction-service/commit/2d5692c45b6dd859af4494e0d5b93089b25b03af)
- Fix merge conflicts [`5346096`](https://github.com/DEFRA/water-abstraction-service/commit/5346096c5c1c0b6536604fb540e2bc642aa9c4f8)
- Adding licence creator classes [`1c6e8cb`](https://github.com/DEFRA/water-abstraction-service/commit/1c6e8cb9f1bc05eb05ac896dd087953d8b4aaba0)
- db migration [`e7bf5d9`](https://github.com/DEFRA/water-abstraction-service/commit/e7bf5d961b5c4ff278baa99bf8af2beba59ace4b)
- initial [`3c93f6d`](https://github.com/DEFRA/water-abstraction-service/commit/3c93f6d18c5ec5e8d028a4e64e9a26f76e468d61)
- import nald data from s3 to import schema and extract individual licence by licence id [`4ce5fb8`](https://github.com/DEFRA/water-abstraction-service/commit/4ce5fb86df295544384f6f8e5514d82d7c793b91)
- Created sessions API [`83d340f`](https://github.com/DEFRA/water-abstraction-service/commit/83d340f5b7ea5260eb65802edbbd28f15cc4c454)
- import scheduler [`45dcc13`](https://github.com/DEFRA/water-abstraction-service/commit/45dcc138ce0aa448fb8ee9ab39ec97e59f03189a)
- use node cron to post login summary to slack [`0f6cb77`](https://github.com/DEFRA/water-abstraction-service/commit/0f6cb778c38d9f86ebf0e9f510685e216cd30a4c)
- actually run the migration... [`3ff1297`](https://github.com/DEFRA/water-abstraction-service/commit/3ff1297775032ab1d0e907649e59c366351dd8d2)
- Missed the additional notify template insert [`84e85b3`](https://github.com/DEFRA/water-abstraction-service/commit/84e85b31c43082dac1cd4f5699b9260bd9b0d731)
- update import process so that the licence_start_dt and licence_end_dt fields are correctly populated [`f9c3fb8`](https://github.com/DEFRA/water-abstraction-service/commit/f9c3fb89808c91945685d9ec874a1e4347cc996b)
- Include FGAC_REGION_CODE [`35899c1`](https://github.com/DEFRA/water-abstraction-service/commit/35899c10dae016681d6e0f275e84e2797660c309)
- Added ability to schedule update to existing records (currently only reimports from import table. TODO, trigger S3 data reload too) [`a6e3245`](https://github.com/DEFRA/water-abstraction-service/commit/a6e32450c3bc86a14c412cb62cb8aec48c95e7dd)
- Modifications to anonymous data export [`819c450`](https://github.com/DEFRA/water-abstraction-service/commit/819c450fab91be3a4b47cb7d1f592b23fb9fca44)
- similar issue around purposes and points ignoring issue number and verison number [`5df794b`](https://github.com/DEFRA/water-abstraction-service/commit/5df794b6d89945014686f51912cbdd7fac95258d)
- missing packages and additional console output for debug [`28c2647`](https://github.com/DEFRA/water-abstraction-service/commit/28c26475ff635b4a27590d347a0af538c5d2d135)
- Return contact methods (i.e. phone no, email) as an array in the main query rather than causing multiple rows duplicate contacts (see water-801) [`69075e0`](https://github.com/DEFRA/water-abstraction-service/commit/69075e0650504d5cbc24e8e5c2ada5385bc5d101)
- Purge before load [`af4174d`](https://github.com/DEFRA/water-abstraction-service/commit/af4174db17c8bbc326335dd587a4ecce86b826ee)
- additional templates & less debug info [`a52cffd`](https://github.com/DEFRA/water-abstraction-service/commit/a52cffdb0caebfdc1df809db2714ed86e54f2b8f)
- Adjust river level API to return both level/flow measures (still ignoring downstream stage) [`2b232b3`](https://github.com/DEFRA/water-abstraction-service/commit/2b232b39978ce3f849b5af6d1c91f3e08460993b)
- hotfix dbmigrate [`43a4c05`](https://github.com/DEFRA/water-abstraction-service/commit/43a4c053c652dbbef299e145c90b5c7597ed618e)
- fix notification multiple send bug [`250f237`](https://github.com/DEFRA/water-abstraction-service/commit/250f237efe35b4394f1a64961c94991512a1ade0)
- hotfix bug with send query [`fc79fd2`](https://github.com/DEFRA/water-abstraction-service/commit/fc79fd29dd9f6bc9f3b4f4b80c56d730212b32a3)
- blipp and errbit [`d1b1196`](https://github.com/DEFRA/water-abstraction-service/commit/d1b11967fd6f7f91676fe61cafca7f4a023de323)
- status endpoint [`66a017e`](https://github.com/DEFRA/water-abstraction-service/commit/66a017e30f57b2f5496e64773da9d5b616c16fa8)
- blipp and errbit [`cfc66e3`](https://github.com/DEFRA/water-abstraction-service/commit/cfc66e3fc7bd233554f51ff308eabfca88e6808d)
- Handle case where exportLicence returns no data [`77b8e3e`](https://github.com/DEFRA/water-abstraction-service/commit/77b8e3eb84bfa2c1139a447e3c26c20c401e6720)
- add point detail back in... [`29f32cd`](https://github.com/DEFRA/water-abstraction-service/commit/29f32cd69d3a06a937b546b196e3f1e97a2c10ee)
- remote safeties around sending test letters... careful... [`b47e34a`](https://github.com/DEFRA/water-abstraction-service/commit/b47e34aa6ad59c0f009812f5433a88c74c606985)
- Log all view contexts to file when generating notification [`146754d`](https://github.com/DEFRA/water-abstraction-service/commit/146754d6aa84ab9389820803569ef1aa2d3f56ad)
- Tweak migrations [`2d5fe97`](https://github.com/DEFRA/water-abstraction-service/commit/2d5fe9703d9ef9543eded958eef9cd61d4ce3b94)
- Fix global variable leaks [`c4dfb1f`](https://github.com/DEFRA/water-abstraction-service/commit/c4dfb1f96a6efb7f733a6662bd32a31e56b434f7)
- fix migration issue [`a5094c2`](https://github.com/DEFRA/water-abstraction-service/commit/a5094c2a157a551eab63c4dce71b2fb2f33a534e)
- Update 20180124085613-nald-import-scheduler-up.sql [`1cd172a`](https://github.com/DEFRA/water-abstraction-service/commit/1cd172a3f9c55f05d3941651bb7ad954d67d6897)
- Add coverage path for lab tests in Travis [`45615e4`](https://github.com/DEFRA/water-abstraction-service/commit/45615e4a238e443e10894f5062510b2dbe7c67e5)
- s3 config from env [`4eab9d3`](https://github.com/DEFRA/water-abstraction-service/commit/4eab9d314ea23c78e767afa1af1ae0fcb5fe9356)
- Update nald.js [`455be03`](https://github.com/DEFRA/water-abstraction-service/commit/455be03f3c9bcd11b8c9d9b7d0f99e588a3c0325)
- Enables clustering in ecosystem file. [`34d579e`](https://github.com/DEFRA/water-abstraction-service/commit/34d579ee7735433ba79af244fd068bd19436ac9b)
- Reduce PGBoss load on DB [`9e0d1e8`](https://github.com/DEFRA/water-abstraction-service/commit/9e0d1e8497cd42749770854ec1e089a73d23f51a)
- Ignore 'payload' variable from global leak test until source found [`0fe9b2e`](https://github.com/DEFRA/water-abstraction-service/commit/0fe9b2e26ec69df73d7bc5eb0f750b7d013e3c32)
- Add comment [`10e5a90`](https://github.com/DEFRA/water-abstraction-service/commit/10e5a905f29ea0c082e637d9065fbba6ff01c111)
- Change to using subject key from task config as message title in notifications [`b7e5f62`](https://github.com/DEFRA/water-abstraction-service/commit/b7e5f62a6dbe72456392932216f61bfd8a39c582)
- Simplify travis setup [`95cf99e`](https://github.com/DEFRA/water-abstraction-service/commit/95cf99e96524f706bc4f92c0892f61eb7229bf6e)
- Adjust package files to remove git+ reference [`d351f78`](https://github.com/DEFRA/water-abstraction-service/commit/d351f78cf8cefac49cc0a1f3515f06e235a16c7d)
- Add codecov/istanbul to dev deps [`75224dd`](https://github.com/DEFRA/water-abstraction-service/commit/75224dd92c84f9ed9abd2b469687a1d3c9109658)
- Update README.MD [`027cb82`](https://github.com/DEFRA/water-abstraction-service/commit/027cb82837e585da07f338d9cf6328b44fa85ede)
- Log notification data [`94aef7b`](https://github.com/DEFRA/water-abstraction-service/commit/94aef7b211f817cf3f034a4a6fd65f3f854ee23b)
- Tweak test script for travis [`16ef8ca`](https://github.com/DEFRA/water-abstraction-service/commit/16ef8ca929b1dd9d26427c1c4b07c740b1206416)
- Try removing istanbul [`5908d7d`](https://github.com/DEFRA/water-abstraction-service/commit/5908d7d1117743a3e35eef8e43dcecc377e12805)
- Remove schema owner from migration script [`d813d12`](https://github.com/DEFRA/water-abstraction-service/commit/d813d127e39e65b302d5515d5d560096ade4720b)
- add migrate npm script [`2354120`](https://github.com/DEFRA/water-abstraction-service/commit/23541209e975cfec462e60e0a86d0f531ef8753c)
- Increase pool size [`6b7eb94`](https://github.com/DEFRA/water-abstraction-service/commit/6b7eb942fe91570c5bc39f65343cc25a3186ab32)
- Reduce pool size [`ebdf2d9`](https://github.com/DEFRA/water-abstraction-service/commit/ebdf2d9caadc0686dda03324263ea614cf261a01)
- add test notify key to travis.yml [`97b77ee`](https://github.com/DEFRA/water-abstraction-service/commit/97b77ee837b6a25210964243b9f74f7ddc41891b)
- Add build status badge [`b52e95a`](https://github.com/DEFRA/water-abstraction-service/commit/b52e95a00a26146edb03f8237204ad04665b1479)
- Comment licence numbers import [`a5f8d9f`](https://github.com/DEFRA/water-abstraction-service/commit/a5f8d9f20b5ce655e8b389d9c5bf8b44bac44071)
- Delete all tasks before import [`938933a`](https://github.com/DEFRA/water-abstraction-service/commit/938933adf276830a997675eaf57b68c4ebffbef7)
- adjust proxy settings [`78a3c1e`](https://github.com/DEFRA/water-abstraction-service/commit/78a3c1e2cb980122337b4b7c0037defcfbae5c0c)
- ID is numeric, fix validation [`c8b6a99`](https://github.com/DEFRA/water-abstraction-service/commit/c8b6a9922158fcf4d5943f40ff013e551aa5fa4a)
- Only run cron on the hour, not every minute... [`724d827`](https://github.com/DEFRA/water-abstraction-service/commit/724d82717872892e32e19d90b060874c383465d7)
- Update README.MD [`11a04b5`](https://github.com/DEFRA/water-abstraction-service/commit/11a04b5fa799ea226197f345e6e7d95cb0c606c4)
- Update README.MD [`780e77a`](https://github.com/DEFRA/water-abstraction-service/commit/780e77a46b81547c5e7b6c0065b25a7d37f5de9d)
- Update README.MD [`1380011`](https://github.com/DEFRA/water-abstraction-service/commit/1380011e69dc6c7fdbd6da0caf57f3d5c4c55172)
- Update README.MD [`2f0fe41`](https://github.com/DEFRA/water-abstraction-service/commit/2f0fe4155ffd40af53da761ac6244f0dddaf4177)
- Update README.MD [`b814477`](https://github.com/DEFRA/water-abstraction-service/commit/b8144772914ad5cd4a0fee225117a4a5bcf1350a)
- Update README.MD [`dfa1e58`](https://github.com/DEFRA/water-abstraction-service/commit/dfa1e58e6250352d7e591087e3981387042077cf)
- Update README.MD [`e41f087`](https://github.com/DEFRA/water-abstraction-service/commit/e41f0872d493f58b7cb777623483b2ab18294e2d)
- Update README.MD [`4755d3e`](https://github.com/DEFRA/water-abstraction-service/commit/4755d3e19f25612efb32a8cd237ddf111eeed0c4)
- Force change to test jenkins polling [`e87a3f9`](https://github.com/DEFRA/water-abstraction-service/commit/e87a3f904455148331daa82af19e4377e7ef26f2)
- remove role postgres from script [`b9a5ac0`](https://github.com/DEFRA/water-abstraction-service/commit/b9a5ac05f2680b19831a644f0fcb90a9f6c42b60)
- Update package.json [`ffcd926`](https://github.com/DEFRA/water-abstraction-service/commit/ffcd926d7e45b06bfebe2c195decaa5c3249f738)
- Remove console.log [`3b4a203`](https://github.com/DEFRA/water-abstraction-service/commit/3b4a203a6bfe28dc2a8615ffb544f9fc8046f2f0)
- seeing if travis error is an env issue [`4796e49`](https://github.com/DEFRA/water-abstraction-service/commit/4796e49c43f856d732e8cbd1e5cd9adf1ba701d4)
- Add notify key [`3f35f34`](https://github.com/DEFRA/water-abstraction-service/commit/3f35f34a9e4f664df699d6afbbf3801f0b2c3768)
- less logging [`d6338a7`](https://github.com/DEFRA/water-abstraction-service/commit/d6338a7ba4cc75126728fdfc623e7e61ae8faa88)
- Update 20180119122037-more-notify-templates-up.sql [`70581ca`](https://github.com/DEFRA/water-abstraction-service/commit/70581cab7c9b8a375ec49e7e4c2664fc1782dc3e)
- Update 20180119122037-more-notify-templates-up.sql [`70ee313`](https://github.com/DEFRA/water-abstraction-service/commit/70ee31340bed41580576baf13c6595e8d2767e74)
