### Changelog

All notable changes to this project will be documented in this file. Dates are displayed in UTC.

Generated by [`auto-changelog`](https://github.com/CookPete/auto-changelog).

#### 1.13.0

> 20 November 2018

- Fix: Use Sun - Sat weeks for NALD [`#210`](https://github.com/DEFRA/water-abstraction-service/pull/210)
- Feat: Adds under query flag to return model [`#189`](https://github.com/DEFRA/water-abstraction-service/pull/189)
- Feat: Api connector logging improvement [`#188`](https://github.com/DEFRA/water-abstraction-service/pull/188)
- Remove width from cover-content container which allowed content to overflow its flexbox container [`#187`](https://github.com/DEFRA/water-abstraction-service/pull/187)
- Ensure logger is configured before use in import process [`#186`](https://github.com/DEFRA/water-abstraction-service/pull/186)
- Feat: Adds proxy support for logging to Errbit [`#185`](https://github.com/DEFRA/water-abstraction-service/pull/185)
- Fix: Move password from code to environment [`#184`](https://github.com/DEFRA/water-abstraction-service/pull/184)
- Add return API endpoint to patch return - status / received date [`#182`](https://github.com/DEFRA/water-abstraction-service/pull/182)
- Feature: Logging improvements [`#183`](https://github.com/DEFRA/water-abstraction-service/pull/183)
- Add verbose mode to return messages from API call [`#181`](https://github.com/DEFRA/water-abstraction-service/pull/181)
- Fix duplicate word in guidance on return form [`#180`](https://github.com/DEFRA/water-abstraction-service/pull/180)
- Fix page count and address font size [`#179`](https://github.com/DEFRA/water-abstraction-service/pull/179)
- Bugfix/water 1625 [`#178`](https://github.com/DEFRA/water-abstraction-service/pull/178)
- Feature: Adds dynamic returns form [`#177`](https://github.com/DEFRA/water-abstraction-service/pull/177)
- Adjust Joi schema to allow meter details in abstractionVolumes flow [`#176`](https://github.com/DEFRA/water-abstraction-service/pull/176)
- Update fields depend on return cycle [`#174`](https://github.com/DEFRA/water-abstraction-service/pull/174)
- Enqueue messages sequentially rather than in parallel.  Longer expiry time for queued messages.  Prioritise email/SMS over letters for sending. [`#173`](https://github.com/DEFRA/water-abstraction-service/pull/173)
- Fix: Update airbrake js [`#172`](https://github.com/DEFRA/water-abstraction-service/pull/172)
- Hand off queuing of Notify messages to PG Boss [`#171`](https://github.com/DEFRA/water-abstraction-service/pull/171)
- Fix: Handle null purposes aliases [`#170`](https://github.com/DEFRA/water-abstraction-service/pull/170)
- Fetch licence contacts in batches [`#169`](https://github.com/DEFRA/water-abstraction-service/pull/169)
- Fix: Adds the dueDate to the expected payload [`#168`](https://github.com/DEFRA/water-abstraction-service/pull/168)
- Fix: Change due date to 28 days after end date [`#167`](https://github.com/DEFRA/water-abstraction-service/pull/167)
- Tweaks to picklist data / API [`#166`](https://github.com/DEFRA/water-abstraction-service/pull/166)
- Feat: Improved due returns messaging [`#165`](https://github.com/DEFRA/water-abstraction-service/pull/165)
- Add picklist API in water service [`#164`](https://github.com/DEFRA/water-abstraction-service/pull/164)
- Bugfix/spring clean [`#161`](https://github.com/DEFRA/water-abstraction-service/pull/161)
- Feature: Add purpose alias to return metadata [`#163`](https://github.com/DEFRA/water-abstraction-service/pull/163)
- Take format time-limited start/end date into account when calculating… [`#160`](https://github.com/DEFRA/water-abstraction-service/pull/160)
- Feat/water 1407 [`#157`](https://github.com/DEFRA/water-abstraction-service/pull/157)
- Remove full URL from QR code [`#159`](https://github.com/DEFRA/water-abstraction-service/pull/159)
- Show JSON in paper form for test purposes.  Add additional data to pa… [`#158`](https://github.com/DEFRA/water-abstraction-service/pull/158)
- Render PDF HTML content directly with Nunjucks rather than via URL request [`#156`](https://github.com/DEFRA/water-abstraction-service/pull/156)
- Use internal URL for PDF generation [`#155`](https://github.com/DEFRA/water-abstraction-service/pull/155)
- Feat: Handle meter readings in return model [`#154`](https://github.com/DEFRA/water-abstraction-service/pull/154)
- Hopefully resolve proxy issues with PDF generation [`#153`](https://github.com/DEFRA/water-abstraction-service/pull/153)
- Feat/water 1475 [`#152`](https://github.com/DEFRA/water-abstraction-service/pull/152)
- Fix allowed return statuses [`#151`](https://github.com/DEFRA/water-abstraction-service/pull/151)
- Unit converters should pass through null value [`#150`](https://github.com/DEFRA/water-abstraction-service/pull/150)
- Feat/water 1438 [`#149`](https://github.com/DEFRA/water-abstraction-service/pull/149)
- Feat/water 1438 [`#148`](https://github.com/DEFRA/water-abstraction-service/pull/148)
- Improve split log handling [`#147`](https://github.com/DEFRA/water-abstraction-service/pull/147)
- Feat/water 1352 [`#145`](https://github.com/DEFRA/water-abstraction-service/pull/145)
- Calculate current version in permit repo.  CRM IsCurrent flag determi… [`#146`](https://github.com/DEFRA/water-abstraction-service/pull/146)
- Feat: Future licences are not deemed to be current [`#144`](https://github.com/DEFRA/water-abstraction-service/pull/144)
- Add return format data to licence data imported to permit repo [`#143`](https://github.com/DEFRA/water-abstraction-service/pull/143)
- Split returns into current / not current [`#142`](https://github.com/DEFRA/water-abstraction-service/pull/142)
- Feat/calculate cycles 2 [`#141`](https://github.com/DEFRA/water-abstraction-service/pull/141)
- Feat/calculate cycles 2 [`#140`](https://github.com/DEFRA/water-abstraction-service/pull/140)
- Feat/return lines units [`#139`](https://github.com/DEFRA/water-abstraction-service/pull/139)
- Include received date in upsert [`#137`](https://github.com/DEFRA/water-abstraction-service/pull/137)
- Remove await from Slack posts [`#136`](https://github.com/DEFRA/water-abstraction-service/pull/136)
- Feat/import returns date [`#135`](https://github.com/DEFRA/water-abstraction-service/pull/135)
- Fix units [`#134`](https://github.com/DEFRA/water-abstraction-service/pull/134)
- Import efficiency [`#133`](https://github.com/DEFRA/water-abstraction-service/pull/133)
- Feat/water 1255 [`#132`](https://github.com/DEFRA/water-abstraction-service/pull/132)
- Add indexes to fields used in import [`#131`](https://github.com/DEFRA/water-abstraction-service/pull/131)
- Fix issue with notification log.  Also change poss interval timing [`#130`](https://github.com/DEFRA/water-abstraction-service/pull/130)
- Post data to permit repo / CRM / import log in batches [`#129`](https://github.com/DEFRA/water-abstraction-service/pull/129)
- Adds connection pool logging [`#128`](https://github.com/DEFRA/water-abstraction-service/pull/128)
- Tweaks to expiry content [`#126`](https://github.com/DEFRA/water-abstraction-service/pull/126)
- Add variables to notification configs [`#125`](https://github.com/DEFRA/water-abstraction-service/pull/125)
- Changes the upsert to also update the subtype [`#124`](https://github.com/DEFRA/water-abstraction-service/pull/124)
- Fix issue with loading licences in notifications by removing paginated results call [`#123`](https://github.com/DEFRA/water-abstraction-service/pull/123)
- Import licences in batches [`#122`](https://github.com/DEFRA/water-abstraction-service/pull/122)
- Use single connection pool [`#121`](https://github.com/DEFRA/water-abstraction-service/pull/121)
- Feat/import tweaks [`#120`](https://github.com/DEFRA/water-abstraction-service/pull/120)
- Only watch the file system in local dev [`#119`](https://github.com/DEFRA/water-abstraction-service/pull/119)
- Use single job for download/extract CSV until we can do this in S3 bucket [`#118`](https://github.com/DEFRA/water-abstraction-service/pull/118)
- Feat/water 1261 mk2 [`#117`](https://github.com/DEFRA/water-abstraction-service/pull/117)
- Disable errbit [`#116`](https://github.com/DEFRA/water-abstraction-service/pull/116)
- Add VmL version back to permit repo packet [`#115`](https://github.com/DEFRA/water-abstraction-service/pull/115)
- Migration to delete deprecated scheduled tasks for NALD import [`#114`](https://github.com/DEFRA/water-abstraction-service/pull/114)
- Bugfix/import file path slash [`#113`](https://github.com/DEFRA/water-abstraction-service/pull/113)
- Remove duplicate forward slash from file path [`#112`](https://github.com/DEFRA/water-abstraction-service/pull/112)
- Fix status page [`#111`](https://github.com/DEFRA/water-abstraction-service/pull/111)
- Feat/boss import poc [`#109`](https://github.com/DEFRA/water-abstraction-service/pull/109)
- Feat/water 1179 [`#108`](https://github.com/DEFRA/water-abstraction-service/pull/108)
- Bugfix/convert flow units [`#107`](https://github.com/DEFRA/water-abstraction-service/pull/107)
- Feat/notify failsafe [`#105`](https://github.com/DEFRA/water-abstraction-service/pull/105)
- Convert ml/d to m3/s in river flow data [`#106`](https://github.com/DEFRA/water-abstraction-service/pull/106)
- WATER-1151: Email titles. [`#104`](https://github.com/DEFRA/water-abstraction-service/pull/104)
- WATER-1151 and WATER-1153 [`#103`](https://github.com/DEFRA/water-abstraction-service/pull/103)
- chore: Config and linting [`#102`](https://github.com/DEFRA/water-abstraction-service/pull/102)
- Ensure 'error' in status column in counted as error in notification event log [`#101`](https://github.com/DEFRA/water-abstraction-service/pull/101)
- Feat/pg boss [`#99`](https://github.com/DEFRA/water-abstraction-service/pull/99)
- bugfix/WATER-1086: Plurals in notifications [`#98`](https://github.com/DEFRA/water-abstraction-service/pull/98)
- Tolerate missing fields in API data [`#94`](https://github.com/DEFRA/water-abstraction-service/pull/94)
- Include active status in data returned from river levels API [`#93`](https://github.com/DEFRA/water-abstraction-service/pull/93)
- Create local cache of gauging stations, update list daily [`#92`](https://github.com/DEFRA/water-abstraction-service/pull/92)
- Remove proxy:null when communicating with river levels API [`#91`](https://github.com/DEFRA/water-abstraction-service/pull/91)
- Feat/water 1090 [`#90`](https://github.com/DEFRA/water-abstraction-service/pull/90)
- Fix migrations [`#89`](https://github.com/DEFRA/water-abstraction-service/pull/89)
- Remove notify search criteria in update notify status task [`#87`](https://github.com/DEFRA/water-abstraction-service/pull/87)
- Poll notify for message status for 3 days following message send [`#86`](https://github.com/DEFRA/water-abstraction-service/pull/86)
- Switch back to original scheduler implementation [`#85`](https://github.com/DEFRA/water-abstraction-service/pull/85)
- Add migrations for notify templates and scheduled task [`#83`](https://github.com/DEFRA/water-abstraction-service/pull/83)
- Notification tasks DB migration [`#82`](https://github.com/DEFRA/water-abstraction-service/pull/82)
- Stop slack error breaking S3 import [`#81`](https://github.com/DEFRA/water-abstraction-service/pull/81)
- Run scheduled tasks in separate process [`#80`](https://github.com/DEFRA/water-abstraction-service/pull/80)
- Set date and unique reference in rendered template [`#79`](https://github.com/DEFRA/water-abstraction-service/pull/79)
- Fetch all pages of results from permit repo.  Allow custom template t… [`#78`](https://github.com/DEFRA/water-abstraction-service/pull/78)
- Contact dedupe case insensitive and remove null fields [`#77`](https://github.com/DEFRA/water-abstraction-service/pull/77)
- Remove slack [`#76`](https://github.com/DEFRA/water-abstraction-service/pull/76)
- Feat/notification event metadata [`#75`](https://github.com/DEFRA/water-abstraction-service/pull/75)
- Remove output escaping from Nunjucks rendered markdown template output [`#74`](https://github.com/DEFRA/water-abstraction-service/pull/74)
- Include subject personalisation for email notifications [`#73`](https://github.com/DEFRA/water-abstraction-service/pull/73)
- Fix email recipient for notifications [`#72`](https://github.com/DEFRA/water-abstraction-service/pull/72)
- Feat/water 938 [`#71`](https://github.com/DEFRA/water-abstraction-service/pull/71)
- Feat/water 937 [`#70`](https://github.com/DEFRA/water-abstraction-service/pull/70)
- Prioritise contacts for notifications in revised order [`#69`](https://github.com/DEFRA/water-abstraction-service/pull/69)
- Add task config table/API endpoint for notifications [`#68`](https://github.com/DEFRA/water-abstraction-service/pull/68)
- Feat/lookup data [`#67`](https://github.com/DEFRA/water-abstraction-service/pull/67)
- Add error handling to NALD import [`#66`](https://github.com/DEFRA/water-abstraction-service/pull/66)
- Allow scheduled tasks to be updated via API [`#65`](https://github.com/DEFRA/water-abstraction-service/pull/65)
- Allow scheduled tasks to be updated via API [`#64`](https://github.com/DEFRA/water-abstraction-service/pull/64)
- Add support for import concurrency env var, default to 1 [`#62`](https://github.com/DEFRA/water-abstraction-service/pull/62)
- Use area import email if available for notifications [`#63`](https://github.com/DEFRA/water-abstraction-service/pull/63)
- Remove git+ [`#60`](https://github.com/DEFRA/water-abstraction-service/pull/60)
- Fix issue with document name endpoint removed from CRM in renewal ema… [`#59`](https://github.com/DEFRA/water-abstraction-service/pull/59)
- Contact de-duplication for notification sending [`#58`](https://github.com/DEFRA/water-abstraction-service/pull/58)
- fix inconsistency in primary key handling [`#57`](https://github.com/DEFRA/water-abstraction-service/pull/57)
- endpoint for event log and changes to support additional notification… [`#56`](https://github.com/DEFRA/water-abstraction-service/pull/56)
- Create new config option '$' for import task which imports registered… [`#55`](https://github.com/DEFRA/water-abstraction-service/pull/55)
- Record last run start time [`#54`](https://github.com/DEFRA/water-abstraction-service/pull/54)
- Feat/import multiple licence nos [`#53`](https://github.com/DEFRA/water-abstraction-service/pull/53)
- Include expiry date in current licence query.  Get latest version by … [`#52`](https://github.com/DEFRA/water-abstraction-service/pull/52)
- Include IsCurrent flag in CRM metadata.  current_version property nul… [`#51`](https://github.com/DEFRA/water-abstraction-service/pull/51)
- Fix linter errors [`#50`](https://github.com/DEFRA/water-abstraction-service/pull/50)
- daily s3 update [`#48`](https://github.com/DEFRA/water-abstraction-service/pull/48)
- Only include gulp in dev deps [`#46`](https://github.com/DEFRA/water-abstraction-service/pull/46)
- Bugfix/water 797 [`#47`](https://github.com/DEFRA/water-abstraction-service/pull/47)
- Feat/water 741 [`#45`](https://github.com/DEFRA/water-abstraction-service/pull/45)
- Feat/coverage path [`#44`](https://github.com/DEFRA/water-abstraction-service/pull/44)
- Added ability to schedule update to existing records (currently only … [`#42`](https://github.com/DEFRA/water-abstraction-service/pull/42)
- Feature/fix issue with contact methods causing multiple contacts [`#41`](https://github.com/DEFRA/water-abstraction-service/pull/41)
- improve scheduler resiliency [`#40`](https://github.com/DEFRA/water-abstraction-service/pull/40)
- Update .snyk file, update dependencies [`#39`](https://github.com/DEFRA/water-abstraction-service/pull/39)
- always_used_scheduler_for_notify [`#38`](https://github.com/DEFRA/water-abstraction-service/pull/38)
- update-hapi-pgi-rest-api [`#36`](https://github.com/DEFRA/water-abstraction-service/pull/36)
- update unit tests [`#35`](https://github.com/DEFRA/water-abstraction-service/pull/35)
- new endpoints for admin use [`#33`](https://github.com/DEFRA/water-abstraction-service/pull/33)
- integrate cutom licence name with expiry notification [`#32`](https://github.com/DEFRA/water-abstraction-service/pull/32)
- notify templates endpoint [`#31`](https://github.com/DEFRA/water-abstraction-service/pull/31)
- Add endpoint for scheduled notifications [`#30`](https://github.com/DEFRA/water-abstraction-service/pull/30)
- update import process so that the licence_start_dt and licence_end_dt… [`#24`](https://github.com/DEFRA/water-abstraction-service/pull/24)
- add the notify templates [`#29`](https://github.com/DEFRA/water-abstraction-service/pull/29)
- water-742 [`#28`](https://github.com/DEFRA/water-abstraction-service/pull/28)
- implement scheduled notifications [`#26`](https://github.com/DEFRA/water-abstraction-service/pull/26)
- remove crm migrations [`#23`](https://github.com/DEFRA/water-abstraction-service/pull/23)
- added current_version object to licence [`#22`](https://github.com/DEFRA/water-abstraction-service/pull/22)
- Feat/water 600 [`#21`](https://github.com/DEFRA/water-abstraction-service/pull/21)
- Modify import to exclude missing licences and import in batches [`#20`](https://github.com/DEFRA/water-abstraction-service/pull/20)
- Feat/import selected licences [`#19`](https://github.com/DEFRA/water-abstraction-service/pull/19)
- fix issue with nald data import [`#18`](https://github.com/DEFRA/water-abstraction-service/pull/18)
- quieter import [`#17`](https://github.com/DEFRA/water-abstraction-service/pull/17)
- Ignore data files loaded from NALD [`#12`](https://github.com/DEFRA/water-abstraction-service/pull/12)
- and point_source object to purpose points [`#16`](https://github.com/DEFRA/water-abstraction-service/pull/16)
- Lookup point using point id not purpose id... [`#15`](https://github.com/DEFRA/water-abstraction-service/pull/15)
- Feature/adjustments to nald import [`#14`](https://github.com/DEFRA/water-abstraction-service/pull/14)
- Rework to not use the ABSTAT_WFD table (which turns out to be a view) [`#13`](https://github.com/DEFRA/water-abstraction-service/pull/13)
- Adjust version.parties [`#11`](https://github.com/DEFRA/water-abstraction-service/pull/11)
- Renamed purposes [`#10`](https://github.com/DEFRA/water-abstraction-service/pull/10)
- Get previous licence versions [`#9`](https://github.com/DEFRA/water-abstraction-service/pull/9)
- Tweaking scheduler API config [`#8`](https://github.com/DEFRA/water-abstraction-service/pull/8)
- nald import scheduler [`#7`](https://github.com/DEFRA/water-abstraction-service/pull/7)
- Notify service [`#6`](https://github.com/DEFRA/water-abstraction-service/pull/6)
- Proxy-agent for s3 downloads [`#5`](https://github.com/DEFRA/water-abstraction-service/pull/5)
- Update to latest hapi-pg-rest-api [`#4`](https://github.com/DEFRA/water-abstraction-service/pull/4)
- Add proxy to knox [`#3`](https://github.com/DEFRA/water-abstraction-service/pull/3)
- import nald data from s3 to import schema and extract individual lice… [`#2`](https://github.com/DEFRA/water-abstraction-service/pull/2)
- Feat/water 648 [`#1`](https://github.com/DEFRA/water-abstraction-service/pull/1)
- Feat: Align with developer standards [`3f01549`](https://github.com/DEFRA/water-abstraction-service/commit/3f0154949a118eda1d21dae99e940695dccb5fc6)
- Fix: Use Sun - Sat weeks for NALD [`6348b41`](https://github.com/DEFRA/water-abstraction-service/commit/6348b4186638511a8d4d905fbdc42c8c9bc721dc)
- Updates har-validator version [`7142bac`](https://github.com/DEFRA/water-abstraction-service/commit/7142bac1a75b724d919ea16f2b35c24bccb5f5b4)
- Removes gulp [`7eae680`](https://github.com/DEFRA/water-abstraction-service/commit/7eae6800499c2d0f84cb9022353c402cacd925be)
- Reduce function length [`3ab762d`](https://github.com/DEFRA/water-abstraction-service/commit/3ab762df0fccb7e2acdd108850e3d22b219c790c)
- Merge tag 'public_beta_1.11' into develop [`cde21a5`](https://github.com/DEFRA/water-abstraction-service/commit/cde21a5ee7d5526a3f09e61a70a7b368e99cac0f)
- Remove console.log [`b43f92a`](https://github.com/DEFRA/water-abstraction-service/commit/b43f92a34764978262fff7c0101e63f4f4f14df5)
- Calculate return cycle split date based on mod log only if reason is SUCC [`bf8d171`](https://github.com/DEFRA/water-abstraction-service/commit/bf8d17118bee64222afd9372c1826009b02e6ab9)
- Fix: Fixes an area with the due_date [`1b70998`](https://github.com/DEFRA/water-abstraction-service/commit/1b70998403bbc25ca1f81d155303c6eba9f28b2b)
- Fix: Uses the due date for returns due date [`b985b0e`](https://github.com/DEFRA/water-abstraction-service/commit/b985b0e751e5a97f759c6ea5c7424182735985d3)
- Fix: Removes extra privacy page [`4c1d146`](https://github.com/DEFRA/water-abstraction-service/commit/4c1d14610464fba194115553d5d8fd5208fe80a5)
- Feature: Further returns form content changes [`2f4a7ff`](https://github.com/DEFRA/water-abstraction-service/commit/2f4a7ff67552e5fdd942f808b72e3ea5abe8ca63)
- Further updates to returns paper forms [`ed8d37e`](https://github.com/DEFRA/water-abstraction-service/commit/ed8d37eccc184c7f46374c263c861f22bdf345c9)
- Paper forms content updates [`ef45666`](https://github.com/DEFRA/water-abstraction-service/commit/ef45666f636a2a2b4166cd2543e536e5d6ee4c04)
- Merge tag 'public_beta_1.9' into develop [`9655f2d`](https://github.com/DEFRA/water-abstraction-service/commit/9655f2d897693d736fcb1e03736f960848982585)
- Merge tag 'public_beta_1.8' into develop [`80c2c41`](https://github.com/DEFRA/water-abstraction-service/commit/80c2c41b1d039ac421d79438294f41fb054cae32)
- Fix unit test [`667f609`](https://github.com/DEFRA/water-abstraction-service/commit/667f60940048d503d3c9d864baf8f8d4225c6bea)
- Merge tag 'public_beta_1.6' into develop [`336c149`](https://github.com/DEFRA/water-abstraction-service/commit/336c149c4bd3e071ae0d6f0181bc085d5505fee5)
- Log all view contexts to file when generating notification [`146754d`](https://github.com/DEFRA/water-abstraction-service/commit/146754d6aa84ab9389820803569ef1aa2d3f56ad)
- Increase pool size [`6b7eb94`](https://github.com/DEFRA/water-abstraction-service/commit/6b7eb942fe91570c5bc39f65343cc25a3186ab32)
- Decrease PG boss job check interval to default [`2b1f062`](https://github.com/DEFRA/water-abstraction-service/commit/2b1f062ba7bc4b71067937fe432b0969e9c1f889)
- Log notification JSON [`9f9096b`](https://github.com/DEFRA/water-abstraction-service/commit/9f9096b7871aa6e11a6b6bd2b77fd12496ec04a4)
- Log notification data [`94aef7b`](https://github.com/DEFRA/water-abstraction-service/commit/94aef7b211f817cf3f034a4a6fd65f3f854ee23b)
- Reduce pool size [`ebdf2d9`](https://github.com/DEFRA/water-abstraction-service/commit/ebdf2d9caadc0686dda03324263ea614cf261a01)
- Enables clustering in ecosystem file. [`34d579e`](https://github.com/DEFRA/water-abstraction-service/commit/34d579ee7735433ba79af244fd068bd19436ac9b)
- Reduce PGBoss load on DB [`9e0d1e8`](https://github.com/DEFRA/water-abstraction-service/commit/9e0d1e8497cd42749770854ec1e089a73d23f51a)
- Ignore 'payload' variable from global leak test until source found [`0fe9b2e`](https://github.com/DEFRA/water-abstraction-service/commit/0fe9b2e26ec69df73d7bc5eb0f750b7d013e3c32)
- bugfix/WATER-1086: Notifications updates [`6e18ed7`](https://github.com/DEFRA/water-abstraction-service/commit/6e18ed7f8e8579efe509565737a0a794f6116b21)
- Update notification task configs for HOF resume, stop, and warning to include separate fields for contact name and email/tel [`d59255f`](https://github.com/DEFRA/water-abstraction-service/commit/d59255fab5b8395c6163569ab604abc846a60d13)
- Adjust river level API to return both level/flow measures (still ignoring downstream stage) [`2b232b3`](https://github.com/DEFRA/water-abstraction-service/commit/2b232b39978ce3f849b5af6d1c91f3e08460993b)
- Tweak to river level API [`c8ab5c9`](https://github.com/DEFRA/water-abstraction-service/commit/c8ab5c98f752867af71048b22f95a4893c02af28)
- Add comment [`10e5a90`](https://github.com/DEFRA/water-abstraction-service/commit/10e5a905f29ea0c082e637d9065fbba6ff01c111)
- Create initial river levels API in water service [`1402665`](https://github.com/DEFRA/water-abstraction-service/commit/1402665003e562da80c3171eb5068420acf12738)
- Tweak migrations [`2d5fe97`](https://github.com/DEFRA/water-abstraction-service/commit/2d5fe9703d9ef9543eded958eef9cd61d4ce3b94)
- Change to using subject key from task config as message title in notifications [`b7e5f62`](https://github.com/DEFRA/water-abstraction-service/commit/b7e5f62a6dbe72456392932216f61bfd8a39c582)
- Fetch all pages of results from permit repo.  Allow custom template types with fallback to default [`7a3c22a`](https://github.com/DEFRA/water-abstraction-service/commit/7a3c22a4fbccf56ab8fd1017866f078ae6c1926f)
- Reduce code complexity [`863bcef`](https://github.com/DEFRA/water-abstraction-service/commit/863bcef9424b45156759dff2e7d92633c6ef8641)
- Reduce function length [`b1c9671`](https://github.com/DEFRA/water-abstraction-service/commit/b1c9671a55c89f4adb57b9fd2c047ca8ef94779b)
- Added new task to update events log with number of sent/pending/errored messages in a notification batch [`fe60dd9`](https://github.com/DEFRA/water-abstraction-service/commit/fe60dd9cd4be90d9aad072008fbd5dc0463da69e)
- Add event metadata [`3fa6be0`](https://github.com/DEFRA/water-abstraction-service/commit/3fa6be015d491ca7b06c57331e8890f7d154174e)
- Updating vulnerable packages [`a9ad557`](https://github.com/DEFRA/water-abstraction-service/commit/a9ad557d1f8577c291870536adc4c98ec0dddfb0)
- Tidying notification creation into factory [`32b511d`](https://github.com/DEFRA/water-abstraction-service/commit/32b511d56050ff8b6420723562a14bb1c7ab80d2)
- Send scheduled notifications with logging to events table and entities/licences/event data logged to scheduled notifications table [`93d4c9f`](https://github.com/DEFRA/water-abstraction-service/commit/93d4c9f10935b8a9bae2c3319cbae4f602e6cdef)
- Rough implementation of sending notifications [`ace2c61`](https://github.com/DEFRA/water-abstraction-service/commit/ace2c6171750eb9fd683d0bedcaa220bbb7e9642)
- Log event [`6a4f397`](https://github.com/DEFRA/water-abstraction-service/commit/6a4f397c63dc15559d409958fc348938ae1dec30)
- Add CSV parse npm module [`acb69e1`](https://github.com/DEFRA/water-abstraction-service/commit/acb69e17d753540d636dfa39d0695527772f4b9b)
- Fix issue with async load of licence data [`28d0bf0`](https://github.com/DEFRA/water-abstraction-service/commit/28d0bf04b804777cefa9410d79724b3810527ab0)
- Remove console.log [`3b4a203`](https://github.com/DEFRA/water-abstraction-service/commit/3b4a203a6bfe28dc2a8615ffb544f9fc8046f2f0)
- Remove console.log [`ee9cf7c`](https://github.com/DEFRA/water-abstraction-service/commit/ee9cf7cdb1bcbffc9297e999aa17af72ba552f87)
- Alter send notification API to use single JSON payload [`c44f75c`](https://github.com/DEFRA/water-abstraction-service/commit/c44f75c3d6f33d1d388f493e220c7fcf70594150)
- Tidy folder structure [`c430983`](https://github.com/DEFRA/water-abstraction-service/commit/c430983318c8a08c63bfedf0bb8b0f18fc19a592)
- Completed notification preview step [`23e2100`](https://github.com/DEFRA/water-abstraction-service/commit/23e2100b8b7055987949b8b45c61a97114f2c292)
- Render Nunjucks templates [`1bf27f4`](https://github.com/DEFRA/water-abstraction-service/commit/1bf27f45f111747a986f68fc1feccc5622581a30)
- Organise notifications into module [`b3a25d7`](https://github.com/DEFRA/water-abstraction-service/commit/b3a25d766de8ec40d4d4a6b8397a29988fa25385)
- Reduce function length [`ca3ec9c`](https://github.com/DEFRA/water-abstraction-service/commit/ca3ec9c443071e2c8bdf4e8c3de3a417e10d57f3)
- Add API for lookup data.  Adds scheduled task to import NALD_REP_UNITS to lookup data table. [`332a43d`](https://github.com/DEFRA/water-abstraction-service/commit/332a43ddc018345058f847abdce416b3c205225a)
- Add lookup data API [`8569540`](https://github.com/DEFRA/water-abstraction-service/commit/8569540863f052b24833486f1d90cb75452f3de2)
- Fix taskrunner linter errors [`723965f`](https://github.com/DEFRA/water-abstraction-service/commit/723965f66c3156a2353301362dab7cdd1144301e)
- Fix linter error [`c012523`](https://github.com/DEFRA/water-abstraction-service/commit/c0125238c293bc5682483a8b577e887ed16c3a0a)
- Fix linter error [`2965543`](https://github.com/DEFRA/water-abstraction-service/commit/2965543c6e0e9d8758c3842b4b1a8727e8511ad7)
- Fix issue with document name endpoint removed from CRM in renewal email scheduled task [`99fadcd`](https://github.com/DEFRA/water-abstraction-service/commit/99fadcdcd8922f7bf42b45c85359705f15e56312)
- Move CRM call to connector code [`fc26b55`](https://github.com/DEFRA/water-abstraction-service/commit/fc26b55ebecc3cbe3120796b8466e51768d1d31a)
- Testing [`89d2b39`](https://github.com/DEFRA/water-abstraction-service/commit/89d2b399906dd4ffe7f163f179798afed2d5413b)
- endpoint for event log and changes to support additional notification fields [`8973da6`](https://github.com/DEFRA/water-abstraction-service/commit/8973da60bba3c16e572e946c57b5450699c7a8b1)
- Create new config option '$' for import task which imports registered licences only [`0ab09c3`](https://github.com/DEFRA/water-abstraction-service/commit/0ab09c3a76e7a0a49abdb3ff1157455f29de7ba6)
- Include time in updated timestamp [`1c924ad`](https://github.com/DEFRA/water-abstraction-service/commit/1c924ad2015ea2cf56b64e57983155ca02d38d26)
- Linter tweaks [`2ea10ba`](https://github.com/DEFRA/water-abstraction-service/commit/2ea10baf276046f7c65b56384b8ca6dad8fe7459)
- Ensure pending import correctly updated [`13b4bef`](https://github.com/DEFRA/water-abstraction-service/commit/13b4bef562d0a7624034b95e5ffa9feab2e781cd)
- Add ability to import multiple licences with CSV in licence_ref field [`316ffd8`](https://github.com/DEFRA/water-abstraction-service/commit/316ffd86e32712bd18a7d29d545b94939fb7e9d5)
- Include expiry date in current licence query.  Get latest version by issue/incr number. [`6f78f31`](https://github.com/DEFRA/water-abstraction-service/commit/6f78f31d482c81d36b4d468c78a02603680171ec)
- Include IsCurrent flag in CRM metadata.  current_version property null if expired/revoked etc. [`36b8abf`](https://github.com/DEFRA/water-abstraction-service/commit/36b8abf9eaddae5b6a316ec1e9a48b573c1fd4cb)
- reinstate full licence load [`7ce43c1`](https://github.com/DEFRA/water-abstraction-service/commit/7ce43c16f3a174beadfb3be41a979b02f0622a9c)
- Remove test notify key from travis.yml [`f08678b`](https://github.com/DEFRA/water-abstraction-service/commit/f08678b96de2d78c7fc44cd94ed190e19331fc28)
- Remove notify keys from DB [`850888a`](https://github.com/DEFRA/water-abstraction-service/commit/850888a5bebabbe536d2e983a3c6724b06da89b6)
- Fix date issue in NALD unit test [`5103931`](https://github.com/DEFRA/water-abstraction-service/commit/51039311744d7efe853552a532b3a54a0cfb9393)
- MAke NALD temp dir if none exists [`52fdafc`](https://github.com/DEFRA/water-abstraction-service/commit/52fdafca9152d1ce81bbb7accf2fc501eb90d928)
- Refactor data load so same code is used in test [`1250a8b`](https://github.com/DEFRA/water-abstraction-service/commit/1250a8bc945e6cd821ab9875de3ef8669ea681d0)
- Create dummy CSV directory before write [`2d5692c`](https://github.com/DEFRA/water-abstraction-service/commit/2d5692c45b6dd859af4494e0d5b93089b25b03af)
- Lint errors, add lint to travis CI [`e63fa26`](https://github.com/DEFRA/water-abstraction-service/commit/e63fa267a734572b6f4c57c244adca1b7a3cf29f)
- Fix lint errors [`307a295`](https://github.com/DEFRA/water-abstraction-service/commit/307a295539e3d4bf337deb0e9975d42a409acf56)
- Fix merge conflicts [`5346096`](https://github.com/DEFRA/water-abstraction-service/commit/5346096c5c1c0b6536604fb540e2bc642aa9c4f8)
- Add unit test [`07f73c8`](https://github.com/DEFRA/water-abstraction-service/commit/07f73c89209a61b5badaa569b63ad79abf11363e)
- Working dummy licence creator [`3d96a2e`](https://github.com/DEFRA/water-abstraction-service/commit/3d96a2e04d3b6ccbd6fe5ebb28cbbe496aed101d)
- Simplify travis setup [`95cf99e`](https://github.com/DEFRA/water-abstraction-service/commit/95cf99e96524f706bc4f92c0892f61eb7229bf6e)
- Tweak test script for travis [`16ef8ca`](https://github.com/DEFRA/water-abstraction-service/commit/16ef8ca929b1dd9d26427c1c4b07c740b1206416)
- Fix global variable leaks [`c4dfb1f`](https://github.com/DEFRA/water-abstraction-service/commit/c4dfb1f96a6efb7f733a6662bd32a31e56b434f7)
- Try removing istanbul [`5908d7d`](https://github.com/DEFRA/water-abstraction-service/commit/5908d7d1117743a3e35eef8e43dcecc377e12805)
- Add coverage path for lab tests in Travis [`45615e4`](https://github.com/DEFRA/water-abstraction-service/commit/45615e4a238e443e10894f5062510b2dbe7c67e5)
- Adding licence creator classes [`1c6e8cb`](https://github.com/DEFRA/water-abstraction-service/commit/1c6e8cb9f1bc05eb05ac896dd087953d8b4aaba0)
- Added ability to schedule update to existing records (currently only reimports from import table. TODO, trigger S3 data reload too) [`a6e3245`](https://github.com/DEFRA/water-abstraction-service/commit/a6e32450c3bc86a14c412cb62cb8aec48c95e7dd)
- similar issue around purposes and points ignoring issue number and verison number [`5df794b`](https://github.com/DEFRA/water-abstraction-service/commit/5df794b6d89945014686f51912cbdd7fac95258d)
- Return contact methods (i.e. phone no, email) as an array in the main query rather than causing multiple rows duplicate contacts (see water-801) [`69075e0`](https://github.com/DEFRA/water-abstraction-service/commit/69075e0650504d5cbc24e8e5c2ada5385bc5d101)
- Work on dummy licence creator for testing [`3e09697`](https://github.com/DEFRA/water-abstraction-service/commit/3e09697f9917287b28bfcfa67b26af408897259d)
- hotfix bug with send query [`fc79fd2`](https://github.com/DEFRA/water-abstraction-service/commit/fc79fd29dd9f6bc9f3b4f4b80c56d730212b32a3)
- fix notification multiple send bug [`250f237`](https://github.com/DEFRA/water-abstraction-service/commit/250f237efe35b4394f1a64961c94991512a1ade0)
- Reduced test coverage due to not calling notify API immediately - TODO: call notify via testkey to verify payload.. [`d579f81`](https://github.com/DEFRA/water-abstraction-service/commit/d579f8177bfc0bcdd728af18c1fafbcfd36b395a)
- fix migration issue [`a5094c2`](https://github.com/DEFRA/water-abstraction-service/commit/a5094c2a157a551eab63c4dce71b2fb2f33a534e)
- More licences... [`5b5a51f`](https://github.com/DEFRA/water-abstraction-service/commit/5b5a51f6b23311eb207a67980216e71acdb92b35)
- Adjust package files to remove git+ reference [`d351f78`](https://github.com/DEFRA/water-abstraction-service/commit/d351f78cf8cefac49cc0a1f3515f06e235a16c7d)
- Modifications to anonymous data export [`819c450`](https://github.com/DEFRA/water-abstraction-service/commit/819c450fab91be3a4b47cb7d1f592b23fb9fca44)
- NALD structure [`3c985fd`](https://github.com/DEFRA/water-abstraction-service/commit/3c985fd92e934362af83e02fcf962fde4a63b81a)
- Initial work on creating anonymised licence data [`fb979f0`](https://github.com/DEFRA/water-abstraction-service/commit/fb979f0121703a6dfca39dac79aa1d2cbd6b4aaa)
- remote safeties around sending test letters... careful... [`b47e34a`](https://github.com/DEFRA/water-abstraction-service/commit/b47e34aa6ad59c0f009812f5433a88c74c606985)
- add test notify key to travis.yml [`97b77ee`](https://github.com/DEFRA/water-abstraction-service/commit/97b77ee837b6a25210964243b9f74f7ddc41891b)
- seeing if travis error is an env issue [`4796e49`](https://github.com/DEFRA/water-abstraction-service/commit/4796e49c43f856d732e8cbd1e5cd9adf1ba701d4)
- update import process so that the licence_start_dt and licence_end_dt fields are correctly populated [`f9c3fb8`](https://github.com/DEFRA/water-abstraction-service/commit/f9c3fb89808c91945685d9ec874a1e4347cc996b)
- actually run the migration... [`3ff1297`](https://github.com/DEFRA/water-abstraction-service/commit/3ff1297775032ab1d0e907649e59c366351dd8d2)
- Add build status badge [`b52e95a`](https://github.com/DEFRA/water-abstraction-service/commit/b52e95a00a26146edb03f8237204ad04665b1479)
- Add notify key [`3f35f34`](https://github.com/DEFRA/water-abstraction-service/commit/3f35f34a9e4f664df699d6afbbf3801f0b2c3768)
- Tweak to lab config [`dd16cff`](https://github.com/DEFRA/water-abstraction-service/commit/dd16cff8a26e5bc3369195d5a69f98d5949c5883)
- Add codecov/istanbul to dev deps [`75224dd`](https://github.com/DEFRA/water-abstraction-service/commit/75224dd92c84f9ed9abd2b469687a1d3c9109658)
- Initial travis integration [`d740f9e`](https://github.com/DEFRA/water-abstraction-service/commit/d740f9e337b8893dc130eadcf750a55db347faaa)
- Update nald.js [`455be03`](https://github.com/DEFRA/water-abstraction-service/commit/455be03f3c9bcd11b8c9d9b7d0f99e588a3c0325)
- Comment licence numbers import [`a5f8d9f`](https://github.com/DEFRA/water-abstraction-service/commit/a5f8d9f20b5ce655e8b389d9c5bf8b44bac44071)
- Handle case where exportLicence returns no data [`77b8e3e`](https://github.com/DEFRA/water-abstraction-service/commit/77b8e3eb84bfa2c1139a447e3c26c20c401e6720)
- Delete all tasks before import [`938933a`](https://github.com/DEFRA/water-abstraction-service/commit/938933adf276830a997675eaf57b68c4ebffbef7)
- Add migration to import all licences individually [`306726a`](https://github.com/DEFRA/water-abstraction-service/commit/306726a216bd02a0899f158568741ddbd2706c92)
- adjust proxy settings [`78a3c1e`](https://github.com/DEFRA/water-abstraction-service/commit/78a3c1e2cb980122337b4b7c0037defcfbae5c0c)
- import scheduler [`45dcc13`](https://github.com/DEFRA/water-abstraction-service/commit/45dcc138ce0aa448fb8ee9ab39ec97e59f03189a)
- Include FGAC_REGION_CODE [`35899c1`](https://github.com/DEFRA/water-abstraction-service/commit/35899c10dae016681d6e0f275e84e2797660c309)
- add point detail back in... [`29f32cd`](https://github.com/DEFRA/water-abstraction-service/commit/29f32cd69d3a06a937b546b196e3f1e97a2c10ee)
- less logging [`d6338a7`](https://github.com/DEFRA/water-abstraction-service/commit/d6338a7ba4cc75126728fdfc623e7e61ae8faa88)
- Update 20180124085613-nald-import-scheduler-up.sql [`1cd172a`](https://github.com/DEFRA/water-abstraction-service/commit/1cd172a3f9c55f05d3941651bb7ad954d67d6897)
- Update 20180119122037-more-notify-templates-up.sql [`70581ca`](https://github.com/DEFRA/water-abstraction-service/commit/70581cab7c9b8a375ec49e7e4c2664fc1782dc3e)
- hotfix dbmigrate [`43a4c05`](https://github.com/DEFRA/water-abstraction-service/commit/43a4c053c652dbbef299e145c90b5c7597ed618e)
- ID is numeric, fix validation [`c8b6a99`](https://github.com/DEFRA/water-abstraction-service/commit/c8b6a9922158fcf4d5943f40ff013e551aa5fa4a)
- Update 20180119122037-more-notify-templates-up.sql [`70ee313`](https://github.com/DEFRA/water-abstraction-service/commit/70ee31340bed41580576baf13c6595e8d2767e74)
- Missed the additional notify template insert [`84e85b3`](https://github.com/DEFRA/water-abstraction-service/commit/84e85b31c43082dac1cd4f5699b9260bd9b0d731)
- additional templates & less debug info [`a52cffd`](https://github.com/DEFRA/water-abstraction-service/commit/a52cffdb0caebfdc1df809db2714ed86e54f2b8f)
- Remove schema owner from migration script [`d813d12`](https://github.com/DEFRA/water-abstraction-service/commit/d813d127e39e65b302d5515d5d560096ade4720b)
- Purge before load [`af4174d`](https://github.com/DEFRA/water-abstraction-service/commit/af4174db17c8bbc326335dd587a4ecce86b826ee)
- s3 config from env [`4eab9d3`](https://github.com/DEFRA/water-abstraction-service/commit/4eab9d314ea23c78e767afa1af1ae0fcb5fe9356)
- missing packages and additional console output for debug [`28c2647`](https://github.com/DEFRA/water-abstraction-service/commit/28c26475ff635b4a27590d347a0af538c5d2d135)
- import nald data from s3 to import schema and extract individual licence by licence id [`4ce5fb8`](https://github.com/DEFRA/water-abstraction-service/commit/4ce5fb86df295544384f6f8e5514d82d7c793b91)
- Created sessions API [`83d340f`](https://github.com/DEFRA/water-abstraction-service/commit/83d340f5b7ea5260eb65802edbbd28f15cc4c454)
- Only run cron on the hour, not every minute... [`724d827`](https://github.com/DEFRA/water-abstraction-service/commit/724d82717872892e32e19d90b060874c383465d7)
- use node cron to post login summary to slack [`0f6cb77`](https://github.com/DEFRA/water-abstraction-service/commit/0f6cb778c38d9f86ebf0e9f510685e216cd30a4c)
- Update README.MD [`11a04b5`](https://github.com/DEFRA/water-abstraction-service/commit/11a04b5fa799ea226197f345e6e7d95cb0c606c4)
- Update README.MD [`780e77a`](https://github.com/DEFRA/water-abstraction-service/commit/780e77a46b81547c5e7b6c0065b25a7d37f5de9d)
- Update README.MD [`027cb82`](https://github.com/DEFRA/water-abstraction-service/commit/027cb82837e585da07f338d9cf6328b44fa85ede)
- Update README.MD [`1380011`](https://github.com/DEFRA/water-abstraction-service/commit/1380011e69dc6c7fdbd6da0caf57f3d5c4c55172)
- Update README.MD [`2f0fe41`](https://github.com/DEFRA/water-abstraction-service/commit/2f0fe4155ffd40af53da761ac6244f0dddaf4177)
- Update README.MD [`b814477`](https://github.com/DEFRA/water-abstraction-service/commit/b8144772914ad5cd4a0fee225117a4a5bcf1350a)
- Update README.MD [`dfa1e58`](https://github.com/DEFRA/water-abstraction-service/commit/dfa1e58e6250352d7e591087e3981387042077cf)
- Update README.MD [`e41f087`](https://github.com/DEFRA/water-abstraction-service/commit/e41f0872d493f58b7cb777623483b2ab18294e2d)
- Update README.MD [`4755d3e`](https://github.com/DEFRA/water-abstraction-service/commit/4755d3e19f25612efb32a8cd237ddf111eeed0c4)
- Force change to test jenkins polling [`e87a3f9`](https://github.com/DEFRA/water-abstraction-service/commit/e87a3f904455148331daa82af19e4377e7ef26f2)
- remove role postgres from script [`b9a5ac0`](https://github.com/DEFRA/water-abstraction-service/commit/b9a5ac05f2680b19831a644f0fcb90a9f6c42b60)
- Update package.json [`ffcd926`](https://github.com/DEFRA/water-abstraction-service/commit/ffcd926d7e45b06bfebe2c195decaa5c3249f738)
- add migrate npm script [`2354120`](https://github.com/DEFRA/water-abstraction-service/commit/23541209e975cfec462e60e0a86d0f531ef8753c)
- db migration [`e7bf5d9`](https://github.com/DEFRA/water-abstraction-service/commit/e7bf5d961b5c4ff278baa99bf8af2beba59ace4b)
- breaking changes JWT + node 8 [`7890305`](https://github.com/DEFRA/water-abstraction-service/commit/789030585473a10e6bc08a0c6cc2a861bd2df586)
- blipp and errbit [`d1b1196`](https://github.com/DEFRA/water-abstraction-service/commit/d1b11967fd6f7f91676fe61cafca7f4a023de323)
- blipp and errbit [`cfc66e3`](https://github.com/DEFRA/water-abstraction-service/commit/cfc66e3fc7bd233554f51ff308eabfca88e6808d)
- status endpoint [`66a017e`](https://github.com/DEFRA/water-abstraction-service/commit/66a017e30f57b2f5496e64773da9d5b616c16fa8)
- initial [`3c93f6d`](https://github.com/DEFRA/water-abstraction-service/commit/3c93f6d18c5ec5e8d028a4e64e9a26f76e468d61)
